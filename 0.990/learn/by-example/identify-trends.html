

<!DOCTYPE html>
<html class="no-js">
<head>
    

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<meta name="description" content="Ballerina by Example is a hands-on introduction to Ballerina using annotated example programs. Check out the first example or browse the full list below." />

<meta name="author" content="WSO2, Inc.">

<meta name="keywords" content="ballerinalang, integration, microservices, programming language, cloud native, ballerina language" />

<link rel="shortcut icon" href="/img/favicon.ico">
<title>Identify Trends</title>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-92163714-2"></script>
<!--FB-->
<meta property="og:type"               content="article" />
<meta property="og:title"              content="Ballerina - Identify Trends" />
<meta property="og:description"        content="Ballerina by Example is a hands-on introduction to Ballerina using annotated example programs. Check out the first example or browse the full list below." />
<meta property="og:image"              content="https://ballerina.io/img/ballerina-swan-lake-sm-banner.png
" />
<!--TWITTER-->
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@ballerinalang">
<meta name="twitter:creator" content="@ballerinalang">
<meta name="twitter:title" content="Ballerina">
<meta name="twitter:description" content="Ballerina by Example is a hands-on introduction to Ballerina using annotated example programs. Check out the first example or browse the full list below.">
<meta name="twitter:image" content="https://ballerina.io/img/ballerina-swan-lake-sm-banner.png">

<meta name="twitter:text:description" content="Ballerina by Example is a hands-on introduction to Ballerina using annotated example programs. Check out the first example or browse the full list below.">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image:width" content="610">
<!--LINKED IN  -->
<meta property='og:title' content="Ballerina"/>
<meta property='og:image' content="https://ballerina.io/img/ballerina-swan-lake-sm-banner.png
"/>
<meta property='og:description' content="Ballerina by Example is a hands-on introduction to Ballerina using annotated example programs. Check out the first example or browse the full list below."/>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-92163714-2');
</script>
<!-- Google Tag Manager -->
<script>
    (function(w, d, s, l, i) {
        w[l] = w[l] || [];
        w[l].push({
            'gtm.start': new Date().getTime(),
            event: 'gtm.js'
        });
        var f = d.getElementsByTagName(s)[0],
            j = d.createElement(s),
            dl = l != 'dataLayer' ? '&l=' + l : '';
        j.async = true;
        j.src =
            'https://www.googletagmanager.com/gtm.js?id=' + i + dl;
        f.parentNode.insertBefore(j, f);
    })(window, document, 'script', 'dataLayer', 'GTM-PSL2TX4');
</script>
<!-- End Google Tag Manager -->

<!--copy to clipboard lib-->
<script src="/js/clipboard.js-2.0.0/clipboard.min.js"></script>

<script src="/js/latest-jquery.js"></script>
<script>
    var base_url = "";
</script>
<link rel="stylesheet" href="/css/latest-bootstrap.css">
<!-- Optional theme -->
<link rel="stylesheet" href="/css/latest-bootstrap-theme.css">
<!-- Latest compiled and minified JavaScript -->
<script src="/js/latest-bootstrap.js"></script>
<link rel="stylesheet" href="https://use.typekit.net/son4ymv.css">

<script type="text/javascript" src="/js/highlight.pack.js"></script>

<script src="/js/ballerina-common.js"></script>
<link rel=stylesheet href="/css/ballerina-io.css">
<link rel=stylesheet href="/css/ballerina-io-bbe.css">
<link rel="stylesheet" href="/css/bbe-page.css">
<script>
    // Current page data
    var mkdocs_page_name = '"Home"'.replace(/^"|"$/g, '');
    var mkdocs_page_input_path = '"index.md"'.replace(/^"|"$/g, '');
    var mkdocs_page_url = '"/"'.replace(/^"|"$/g, '');
    
    var releaseNoteFilename = 'RELEASE_NOTE.html';

    var nightly_download_url = 'https://product-dist.ballerina.io/nightly';
    var dev_download_url = 'https://product-dist.ballerina.io/dev';
    var base_download_url = 'https://dist.ballerina.io/downloads';
</script>

</head>
<body class="cBallerina-io">
<div class="row cBallerina-io-Nav" id="iMainNavigation">
    <div class="container">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
            <nav class="navbar">
                <div>
                    <div class="navbar-header">
                        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse"
                                data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                            <span class="sr-only">&#9776</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                        <a class="cMobileLogo" href="/"><img src="/img/ballerina-logo.svg" alt="Ballerina"/></a>
                    </div>
                    <div id="navbar" class="collapse navbar-collapse">
                        <ul class="nav navbar-nav cTopNav">
                            <li class="active toctree-l1" id="learnli"><a class="cBioTopLink" href="/learn">Learn</a>
                            </li>
                            <li class="active toctree-l1" id="Eventsli"><a class="cBioTopLink" href="/learn/events">Events</a>
                            </li>
                            <li class="toctree-l1"><a class="cBioTopLink" href="https://central.ballerina.io/"
                                                      target="_blank">Central</a></li>
                            <li class="toctree-l1" id="openli"><a class="cBioTopLink" href="/community">Community</a>
                            </li>
                            <li class="toctree-l1" id="helpli"><a class="cBioTopLink" href="https://blog.ballerina.io">Blog</a>
                            </li>
                            <li class="cVersionItem">
                                <div class="cVersionContainer">
                                    <!-- <lable class="cVlable">Version</lable> -->
                                    <select name="versions" id="versions" class="select-css">
                                        <option value="1.2" data-value="latest">v1.2</option>
                                        <option value="1.1">v1.1</option>
                                        <option value="1.0">v1.0</option>
                                        <option value="0.991">v0.991</option>
                                    </select>
                                </div>
                            </li>
                            <li class="cSearchMenu"><form class="cSearch-form-inline"><input id="searchTxt" class="form-control-field" type="search" placeholder="Search" aria-label="Search"><a id="searchBtn" href="#" class="cSearchButton"><img src="/img/search.svg"/></a></form></li>
                        </ul>
                    </div>
                </div>
            </nav>
        </div>
    </div>
</div>

<div class="row cBallerina-io-Gray-row">
    <div class="container">
        <div class="row">
            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 cBallerina-io-Home-Middle-col">
                <div class="col-xs-12 col-sm-12" style="padding: 0;">
                    <div class="col-md-12 col-lg-10 cBallerina-io-breadcrumbs">
                        <nav class="breadcrumbs bootstrap hidden-sm-down"
  >
  <ul id="breadcrumb-list" class=" cBalleinaBreadcrumbs list-unstyled  wy-breadcrumbs" vocab="http://schema.org/"
    typeof="BreadcrumbList">


    
    <li><a href="/">Home</a></li>
    
    
    <li>/</li>
    <li><a
        href="/0.990/">0.990</a>
    </li>
    
    
    
    <li>/</li>
    <li><a
        href="/0.990/learn/">Learn</a>
    </li>
    
    
    
    <li>/</li>
    <li><a
        href="/0.990/learn/by-example/">By example</a>
    </li>
    
    
    
    <li>/</li> Identify Trends
    
    

  </ul>
</nav>
<style type="text/css">
  .cBalleinaBreadcrumbs li {
    margin-right: 10px;
  }
</style>
                        <div class="cVersionContainer"></div>
                    </div>
                    <div class="col-md-12 col-lg-2 cBallerina-io-breadcrumbs">
                        <ul class="wy-breadcrumbs">
                            <!-- <li class="wy-breadcrumbs-aside">
                                <a class="icon icon-github" target="_blank" href="https://www.github.com/ballerina-platform/ballerina-platform.github.io/blob/master/0.990/learn/by-example/identify-trends.html">Edit on GitHub</a>
                            </li> -->
                        </ul>
                    </div>
                </div>
                <div class="cBlallerina-io-docs-content-container">
                    <div class="wy-nav-content">
                        <div class="rst-content">
                            <div role="main">
                                <div class="section">
                                    <div class="row cBallerina-io-Gray-row">
        <div class="container cBallerinaBySampleContainer">
            <div class="FullCode">
                <div class="highlight"><pre><span class="kn">import</span> <span class="nx">ballerina</span><span class="o">/</span><span class="nx">io</span><span class="p">;</span>
<span class="kn">import</span> <span class="nx">ballerina</span><span class="o">/</span><span class="nx">runtime</span><span class="p">;</span>
<span class="nx">type</span> <span class="nx">DeviceTempInfo</span> <span class="nx">record</span> <span class="p">{</span>
    <span class="kt">int</span> <span class="nx">deviceID</span><span class="p">;</span>
    <span class="kt">int</span> <span class="nx">roomNo</span><span class="p">;</span>
    <span class="kt">float</span> <span class="nx">temp</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">type</span> <span class="nx">TempDiffInfo</span> <span class="nx">record</span> <span class="p">{</span>
    <span class="kt">float</span> <span class="nx">initialTemp</span><span class="p">;</span>
    <span class="kt">float</span> <span class="nx">peakTemp</span><span class="p">;</span>
<span class="p">};</span>
<span class="nx">stream</span><span class="p">&lt;</span><span class="nx">DeviceTempInfo</span><span class="p">&gt;</span> <span class="nx">tempStream</span> <span class="p">=</span> <span class="nx">new</span><span class="p">;</span>
<span class="nx">stream</span><span class="p">&lt;</span><span class="nx">TempDiffInfo</span><span class="p">&gt;</span> <span class="nx">tempDiffInfoStream</span> <span class="p">=</span> <span class="nx">new</span><span class="p">;</span><span class="nx">TempDiffInfo</span><span class="p">[]</span> <span class="nx">tempDiffInfoArray</span> <span class="p">=</span> <span class="p">[];</span>
<span class="kt">int</span> <span class="nx">index</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
<span class="kd">function</span> <span class="nx">deployPeakTempDetectionRules</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">forever</span> <span class="p">{</span>
        <span class="nx">from</span> <span class="nx">every</span> <span class="nx">tempStream</span> <span class="k">as</span> <span class="nx">e1</span><span class="p">,</span> <span class="nx">tempStream</span>
            <span class="nx">where</span> <span class="nx">e1</span><span class="p">.</span><span class="nx">temp</span> <span class="o">&lt;=</span> <span class="nx">temp</span> <span class="p">[</span><span class="mf">1.</span><span class="p">.]</span> <span class="k">as</span> <span class="nx">e2</span><span class="p">,</span>
        <span class="nx">tempStream</span> <span class="nx">where</span> <span class="nx">e2</span><span class="p">[</span><span class="nx">e2</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">temp</span> <span class="p">&gt;</span> <span class="nx">temp</span> <span class="k">as</span> <span class="nx">e3</span>
        <span class="nx">select</span> <span class="nx">e1</span><span class="p">.</span><span class="nx">temp</span> <span class="k">as</span> <span class="nx">initialTemp</span><span class="p">,</span>
            <span class="nx">e2</span><span class="p">[</span><span class="nx">e2</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">temp</span> <span class="k">as</span> <span class="nx">peakTemp</span>
        <span class="p">=&gt;</span> <span class="p">(</span><span class="nx">TempDiffInfo</span><span class="p">[]</span> <span class="nx">tempDiffInfos</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">foreach</span> <span class="k">var</span> <span class="nx">t</span> <span class="nx">in</span> <span class="nx">tempDiffInfos</span> <span class="p">{</span>
                <span class="nx">tempDiffInfoStream</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="nx">t</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span><span class="nx">public</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>    <span class="nx">index</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="nx">deployPeakTempDetectionRules</span><span class="p">();</span>
    <span class="nx">tempDiffInfoStream</span><span class="p">.</span><span class="nx">subscribe</span><span class="p">(</span><span class="nx">printInitalAndPeakTemp</span><span class="p">);</span>
    <span class="nx">DeviceTempInfo</span> <span class="nx">t1</span> <span class="p">=</span> <span class="p">{</span> <span class="nx">deviceID</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">roomNo</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="nx">temp</span><span class="p">:</span> <span class="mf">20.0</span> <span class="p">};</span>
    <span class="nx">DeviceTempInfo</span> <span class="nx">t2</span> <span class="p">=</span> <span class="p">{</span> <span class="nx">deviceID</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">roomNo</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="nx">temp</span><span class="p">:</span> <span class="mf">22.5</span> <span class="p">};</span>
    <span class="nx">DeviceTempInfo</span> <span class="nx">t3</span> <span class="p">=</span> <span class="p">{</span> <span class="nx">deviceID</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">roomNo</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="nx">temp</span><span class="p">:</span> <span class="mf">23.0</span> <span class="p">};</span>
    <span class="nx">DeviceTempInfo</span> <span class="nx">t4</span> <span class="p">=</span> <span class="p">{</span> <span class="nx">deviceID</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">roomNo</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="nx">temp</span><span class="p">:</span> <span class="mf">21.0</span> <span class="p">};</span>
    <span class="nx">DeviceTempInfo</span> <span class="nx">t5</span> <span class="p">=</span> <span class="p">{</span> <span class="nx">deviceID</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">roomNo</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="nx">temp</span><span class="p">:</span> <span class="mf">24.0</span> <span class="p">};</span>
    <span class="nx">DeviceTempInfo</span> <span class="nx">t6</span> <span class="p">=</span> <span class="p">{</span> <span class="nx">deviceID</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">roomNo</span><span class="p">:</span> <span class="mi">23</span><span class="p">,</span> <span class="nx">temp</span><span class="p">:</span> <span class="mf">23.9</span> <span class="p">};</span>
    <span class="nx">tempStream</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="nx">t1</span><span class="p">);</span>
    <span class="nx">runtime</span><span class="p">:</span><span class="nx">sleep</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>    <span class="nx">tempStream</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="nx">t2</span><span class="p">);</span>
    <span class="nx">runtime</span><span class="p">:</span><span class="nx">sleep</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>    <span class="nx">tempStream</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="nx">t3</span><span class="p">);</span>
    <span class="nx">runtime</span><span class="p">:</span><span class="nx">sleep</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>    <span class="nx">tempStream</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="nx">t4</span><span class="p">);</span>
    <span class="nx">runtime</span><span class="p">:</span><span class="nx">sleep</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>    <span class="nx">tempStream</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="nx">t5</span><span class="p">);</span>
    <span class="nx">runtime</span><span class="p">:</span><span class="nx">sleep</span><span class="p">(</span><span class="mi">200</span><span class="p">);</span>    <span class="nx">tempStream</span><span class="p">.</span><span class="nx">publish</span><span class="p">(</span><span class="nx">t6</span><span class="p">);</span>
    <span class="kt">int</span> <span class="nx">count</span> <span class="p">=</span> <span class="mi">0</span><span class="p">;</span>
    <span class="k">while</span> <span class="p">(</span><span class="kc">true</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">runtime</span><span class="p">:</span><span class="nx">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">);</span>
        <span class="nx">count</span> <span class="o">+=</span> <span class="mi">1</span><span class="p">;</span>
        <span class="k">if</span> <span class="p">((</span><span class="nx">tempDiffInfoArray</span><span class="p">.</span><span class="nx">length</span><span class="p">())</span> <span class="p">&gt;</span> <span class="mi">1</span> <span class="o">||</span> <span class="nx">count</span> <span class="o">==</span> <span class="mi">10</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">break</span><span class="p">;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">printInitalAndPeakTemp</span><span class="p">(</span><span class="nx">TempDiffInfo</span> <span class="nx">tempDiff</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;printInitalAndPeakTemp function is invoked. &quot;</span> <span class="o">+</span>
                    <span class="s">&quot;InitialTemp : &quot;</span> <span class="o">+</span> <span class="nx">tempDiff</span><span class="p">.</span><span class="nx">initialTemp</span> <span class="o">+</span>
                        <span class="s">&quot; and Peak temp : &quot;</span> <span class="o">+</span> <span class="nx">tempDiff</span><span class="p">.</span><span class="nx">peakTemp</span><span class="p">);</span>
    <span class="nx">addToGlobalTempDiffArray</span><span class="p">(</span><span class="nx">tempDiff</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">function</span> <span class="nx">addToGlobalTempDiffArray</span><span class="p">(</span><span class="nx">TempDiffInfo</span> <span class="nx">s</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">tempDiffInfoArray</span><span class="p">[</span><span class="nx">index</span><span class="p">]</span> <span class="p">=</span> <span class="nx">s</span><span class="p">;</span>
    <span class="nx">index</span> <span class="p">=</span> <span class="nx">index</span> <span class="o">+</span> <span class="mi">1</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>

            </div>

            <div class="col-xs-12 col-sm-12 col-md-12">
                <table class="cTopInfoContainer cTopControlsContainer">
                    <tr>
                        <td class="cLeftTD">
                            <h2>Identify Trends</h2>
                            <p><p>Sequence is a state machine implementation that detects the sequence of event occurrences over time.
 All the consecutive events need to match the sequence condition and there can not be any
 non-matching events within a matching sequence of events. This can correlate events within a single stream
 or between multiple streams.
 In this example, the peaks in the temperature is detected using a sequence event variation. If the
 temperature is increasing (incoming events have higher temperature reading than the previous event&rsquo;s reading), and
 then decreasing (incoming events have lower temperature reading than the previous event&rsquo;s temperature reading), a
 peak temperature is in the middle.
 Ballerina Streams is an experimental feature. Please use <code>--experimental</code> flag when compiling Ballerina files
 which have streaming constructs.</p>
</p>

                        </td>
                        <td class="cRightTD">
                            <div class="cTopButtonContainer">
                                
                                <div class="cButtonInfoContainer">
                                    <a class="prev" href="identify-patterns.html">
                                        <span>< PREVIOUS</span>
                                        <p>Identify Patterns</p>
                                    </a>
                                </div>
                                 
                                <div class="cButtonInfoContainer">
                                    <a class="next" href="local-transactions.html">
                                        <span>NEXT ></span>
                                        <p>Local Transactions</p>
                                    </a>
                                </div>
                                
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
            <div class="example" id="identify-trends">
                <div class="col-xs-12 col-sm-12 col-md-12 cBBETable-container cCodeLeft">
                    <table class="cTopControlsContainer">
                        <tr>
                            <td class="cLeftTD">
                                <div class="cBBE-links">
                                    <ul>
                                        <li>
                                            <a class="copy"><img src="/img/copy-icon.svg" /></a>
                                        </li>
                                        <li>
                                            <a target="_blank" href="https://github.com/ballerina-platform/ballerina-distribution/tree/master/examples/identify-trends/"><img src="/img/github-logo-green.svg" /></a>
                                        </li>
                                    </ul>
                                </div>
                            </td>
                            <td></td>
                        </tr>
                    </table>

                    <table class="cTopBorder-table">
                        <tr>
                            <td class="cCodeTD"></td>
                            <td class="cDescTD"></td>
                        </tr>
                    </table>

                    
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        

                    <div>

                        <table class="cBBE-body">
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>import ballerina/io;
import ballerina/runtime;
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>type DeviceTempInfo record {
    int deviceID;
    int roomNo;
    float temp;
};
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Create a record type that represents the device temperature reading.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>type TempDiffInfo record {
    float initialTemp;
    float peakTemp;
};
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Create a record type that represents the initial temperature and the peak temperature.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>stream&lt;DeviceTempInfo&gt; tempStream = new;
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>The stream that gets the input temperature readings.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>stream&lt;TempDiffInfo&gt; tempDiffInfoStream = new;
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>The output stream with peak temperature values.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>TempDiffInfo[] tempDiffInfoArray = [];
int index = 0;
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>function deployPeakTempDetectionRules() {
    forever {
        from every tempStream as e1, tempStream
            where e1.temp &lt;= temp [1..] as e2,
        tempStream where e2[e2.length - 1].temp &gt; temp as e3
        select e1.temp as initialTemp,
            e2[e2.length - 1].temp as peakTemp
        =&gt; (TempDiffInfo[] tempDiffInfos) {
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>This is the function that contains the rules that detect the temperature peak values. The first event&rsquo;s temperature
 should be greater than the temperature values that are returned with the next event, which is e2. The last
 temperature value in e2 should be greater than the temperature value that is given in the event e3. This makes
 the last value of e2, the peak temperature.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>            foreach var t in tempDiffInfos {
                tempDiffInfoStream.publish(t);
            }
        }
    }
}
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>If the sequence is matched, the data is pushed/published to the output stream.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>public function main() {
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>    index = 0;
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>    deployPeakTempDetectionRules();
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Deploy the streaming sequence rules.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>    tempDiffInfoStream.subscribe(printInitalAndPeakTemp);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Subscribe to the <code>printInitialAndPeakTemp</code> function. This prints the peak temperature values.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>    DeviceTempInfo t1 = { deviceID: 1, roomNo: 23, temp: 20.0 };
    DeviceTempInfo t2 = { deviceID: 1, roomNo: 23, temp: 22.5 };
    DeviceTempInfo t3 = { deviceID: 1, roomNo: 23, temp: 23.0 };
    DeviceTempInfo t4 = { deviceID: 1, roomNo: 23, temp: 21.0 };
    DeviceTempInfo t5 = { deviceID: 1, roomNo: 23, temp: 24.0 };
    DeviceTempInfo t6 = { deviceID: 1, roomNo: 23, temp: 23.9 };
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Simulating the data that is being sent to the <code>tempStream</code> stream.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>    tempStream.publish(t1);
    runtime:sleep(200);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Start simulating the events with the temperature readings.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>    tempStream.publish(t2);
    runtime:sleep(200);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>    tempStream.publish(t3);
    runtime:sleep(200);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>    tempStream.publish(t4);
    runtime:sleep(200);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>    tempStream.publish(t5);
    runtime:sleep(200);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>    tempStream.publish(t6);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code empty leading">
                                    
                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Finished sending all six temperature events.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>    int count = 0;
    while (true) {
        runtime:sleep(500);
        count += 1;
        if ((tempDiffInfoArray.length()) &gt; 1 || count == 10) {
            break;
        }
    }
}
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Wait until the results are collected.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=ballerina>function printInitalAndPeakTemp(TempDiffInfo tempDiff) {
    io:println(&quot;printInitalAndPeakTemp function is invoked. &quot; +
                    &quot;InitialTemp : &quot; + tempDiff.initialTemp +
                        &quot; and Peak temp : &quot; + tempDiff.peakTemp);
    addToGlobalTempDiffArray(tempDiff);
}
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>The function that prints the peak temperature readings.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code">
                                    <div class="highlight"><pre><code class=ballerina>function addToGlobalTempDiffArray(TempDiffInfo s) {
    tempDiffInfoArray[index] = s;
    index = index + 1;
}
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>The function that keeps track of all the temperature peak values.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                        </table>
                    </div>
                    
                        
                            
                                
                            
                        

                    <div>

                        <table class="cBBE-body">
                            
                            <tr class="cTR cOutputTr">

                                <td class="code cOutput">
                                    <div class="highlight"><pre><code class=shell-session># To run this sample, navigate to the directory that contains the
# `.bal` file and issue the `ballerina run` command.
$ ballerina run --experimental identify_trends.bal
printInitalAndPeakTemp function is invoked. InitialTemp : 20.0 and Peak temp : 23.0
printInitalAndPeakTemp function is invoked. InitialTemp : 21.0 and Peak temp : 24.0
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                        </table>
                    </div>
                    


                    <table class="cBottomBorder-table">
                        <tr>
                            <td class="cCodeTD"></td>
                            <td class="cDescTD"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>

     <script>
            $(document).ready(function() {

                hljs.initHighlightingOnLoad();

                $(".switch").click(function() {
                    $(".cCodeRight").toggleClass('cShow');
                    $(".cCodeLeft").toggleClass('cHide');
                });

                // register "copy to clipboard" event to elements with "copy" class
                var clipboard = new ClipboardJS('.copy', {
                    text: function(trigger) {
                        return $('.FullCode').find('pre').text();
                    }
                });

                // Register events show hide tooltip on click event
                clipboard.on('success', function(e) {
                    setTooltip(e.trigger, 'Copied!');
                    hideTooltip(e.trigger);
                });

                clipboard.on('error', function(e) {
                    setTooltip(e.trigger, 'Failed!');
                    hideTooltip(e.trigger);
                });

                $('.copy').tooltip({
                    trigger: 'click',
                    placement: 'bottom'
                });
                $("a.copy").unbind("click");
            });

            function setTooltip(btn, message) {
                $(btn).attr('data-original-title', message)
                    .tooltip('show');
            }

            function hideTooltip(btn) {
                setTimeout(function() {
                    $(btn).tooltip('hide').removeAttr('data-original-title');
                }, 1000);
            }
        </script>

                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="iBallerinaFooter" class="row cBallerina-io-White-row">
    <div class="container">
    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 cBallerina-io-left-col cBallerinaFooterLinks">
        <ul>
            <li><a class="cBioFooterLink" href="/downloads">Download</a></li>
            <li><a class="cBioFooterLink" href="https://github.com/ballerina-lang/ballerina/blob/master/LICENSE">Code License</a></li>
            <li><a class="cBioFooterLink" href="/license-of-site">Site License</a></li>
            <li><a class="cBioFooterLink" href="/terms-of-service">TERMS OF SERVICE</a></li>
            <li><a class="cBioFooterLink" href="/privacy-policy">PRIVACY POLICY</a></li>
            </ul>
        </div>
    <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3 cBallerina-io-middle-col cBallerinaFooterSignUp">
        <div class="cSocialmedia">
            <ul>
                <li>
                    <a class="cBioFooterLink" href="https://github.com/ballerina-platform" target="_blank"><img src="/img/github.svg"/></a>
                    </li>
                <li><a class="cBioFooterLink" href="https://stackoverflow.com/questions/tagged/ballerina" target="_blank"><img src="/img/stackoverflow.svg"/></a></li>
                <li><a class="cBioFooterLink" href="https://twitter.com/ballerinalang" target="_blank"><img src="/img/twitter.svg"/></a></li>
                <li><a class="cBioFooterLink" href="/community/slack/"><img src="/img/slack.svg"/></a></li>
                </ul>
            <div class="pdframe"></div>
            </div>
        </div>
    <div class="col-xs-12 col-sm-10 col-md-6 col-lg-6 cBallerina-io-right-col">
        <p>In the creation of Ballerina, we were inspired by so many technologies. Thank you to all that have come before us (and forgive us if we missed one): Java, Go, C, C++, D, Rust, Haskell, Kotlin, Dart, TypeScript, JavaScript, Python, Perl, Flow, Swift, Elm, RelaxNG, NPM, Crates, Maven, Gradle, Kubernetes, Docker, Envoy, Markdown, GitHub and WSO2.</p></div>
    </div>
</div>

<script src="/js/theme.js"></script>

<script>
    $(document).ready(function() {
        var gitstar = '<iframe id="iGitStarIframe" src="https://ghbtns.com/github-btn.html?user=ballerina-platform&repo=ballerina-lang&type=star&count=true&size=small" frameborder="0" scrolling="0"></iframe>';
        $('[data-button="iGitStarText"]').replaceWith(gitstar);

        var gitwatch = '<iframe id="iGitWatchIframe" src="https://ghbtns.com/github-btn.html?user=ballerina-platform&repo=ballerina-lang&type=watch&count=true&size=lsmalle&v=2" frameborder="0" scrolling="0"></iframe>';
        $('[data-button="iGitWatchText"]').replaceWith(gitwatch);

    });
</script>

<style>
    .cGitButtonContainer {
        display: inline-block;
        width: 100%;
        margin-bottom: 0px;
    }

    #iGitStarText {
        height: 20px;
        float: left;
        padding: 0;
        margin: 0;
    }
    #iGitStarIframe , #iGitWatchIframe {
        height: 20px;
        width: 100px;
        float: left;
    }
</style>

</body>
</html>

