---
layout: ballerina-example-page
title: MySQL Select Query Operations
description: 
keywords: 
permalink: /1.2/learn/by-example/mysql-query-operation
active: mysql-query-operation
redirect_from:
  - /v1-2/learn/by-example/mysql-query-operation
  - /v1-2/learn/by-example/mysql-query-operation.html
---
<div class="row cBallerina-io-Gray-row">
        <div class="container cBallerinaBySampleContainer">
            <div class="FullCode">
                <div class="highlight"><pre><span class="kn">import</span> <span class="nx">ballerina</span><span class="o">/</span><span class="nx">io</span><span class="p">;</span>
<span class="kn">import</span> <span class="nx">ballerina</span><span class="o">/</span><span class="nx">mysql</span><span class="p">;</span>
<span class="kn">import</span> <span class="nx">ballerina</span><span class="o">/</span><span class="nx">sql</span><span class="p">;</span>

<span class="c1">// Username and password of the MySQL database. This is used in the below</span>
<span class="c1">// examples when initializing the MySQL connector. You need to change these</span>
<span class="c1">// based on your setup to try locally.</span>
<span class="kt">string</span> <span class="nx">dbUser</span> <span class="p">=</span> <span class="s">&quot;root&quot;</span><span class="p">;</span>
<span class="kt">string</span> <span class="nx">dbPassword</span> <span class="p">=</span> <span class="s">&quot;Test@123&quot;</span><span class="p">;</span>

<span class="kd">function</span> <span class="nx">simpleQuery</span><span class="p">(</span><span class="nx">mysql</span><span class="p">:</span><span class="nx">Client</span> <span class="nx">mysqlClient</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;------ Start Simple Query -------&quot;</span><span class="p">);</span>
    <span class="c1">// Select the rows in the database table via the query remote operation.</span>
    <span class="c1">// The result is returned as a stream and the elements of the stream can</span>
    <span class="c1">// be either a record or an error.</span>
    <span class="nx">stream</span><span class="p">&lt;</span><span class="nx">record</span><span class="p">{},</span> <span class="nx">error</span><span class="p">&gt;</span> <span class="nx">resultStream</span> <span class="p">=</span>
        <span class="nx">mysqlClient</span><span class="o">-&gt;</span><span class="nx">query</span><span class="p">(</span><span class="s">&quot;Select * from Customers&quot;</span><span class="p">);</span>

    <span class="c1">// If there is any error during the execution of the SQL query or</span>
    <span class="c1">// iteration of the result stream, the result stream will terminate and</span>
    <span class="c1">// return the error.</span>
    <span class="nx">error</span><span class="err">?</span> <span class="nx">e</span> <span class="p">=</span> <span class="nx">resultStream</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">record</span> <span class="p">{}</span> <span class="nx">result</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Customer full details: &quot;</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Customer first name: &quot;</span><span class="p">,</span> <span class="nx">result</span><span class="p">[</span><span class="s">&quot;FirstName&quot;</span><span class="p">]);</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Customer last name: &quot;</span><span class="p">,</span> <span class="nx">result</span><span class="p">[</span><span class="s">&quot;LastName&quot;</span><span class="p">]);</span>
    <span class="p">});</span>

    <span class="c1">// Check and handle the error during the SQL query</span>
    <span class="c1">// or iteration of the result stream.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span> <span class="nx">is</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;ForEach operation on the stream failed!&quot;</span><span class="p">,</span> <span class="nx">e</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// In general cases, the stream will be closed automatically</span>
    <span class="c1">// when the stream is fully consumed or any error is encountered.</span>
    <span class="c1">// However, in case if the stream is not fully consumed, the stream should be</span>
    <span class="c1">// closed specifically.</span>
    <span class="nx">e</span> <span class="p">=</span> <span class="nx">resultStream</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
    <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;------ End Simple Query -------&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">countRows</span><span class="p">(</span><span class="nx">mysql</span><span class="p">:</span><span class="nx">Client</span> <span class="nx">mysqlClient</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;------ Start Count Total Rows -------&quot;</span><span class="p">);</span>
    <span class="c1">// The result of the count operation is provided as a record stream.</span>
    <span class="nx">stream</span><span class="p">&lt;</span><span class="nx">record</span><span class="p">{},</span> <span class="nx">error</span><span class="p">&gt;</span> <span class="nx">resultStream</span> <span class="p">=</span>
        <span class="nx">mysqlClient</span><span class="o">-&gt;</span><span class="nx">query</span><span class="p">(</span><span class="s">&quot;Select count(*) as Total from Customers&quot;</span><span class="p">);</span>

    <span class="c1">// Since the above count query will return only a single row, the</span>
    <span class="c1">// `next()` operation is sufficient to retrieve the data.</span>
    <span class="nx">record</span> <span class="p">{|</span><span class="nx">record</span> <span class="p">{}</span> <span class="nx">value</span><span class="p">;|}|</span><span class="nx">error</span><span class="err">?</span> <span class="nx">result</span> <span class="p">=</span> <span class="nx">resultStream</span><span class="p">.</span><span class="nx">next</span><span class="p">();</span>

    <span class="c1">// Check the result and retrieve the value for total.</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="nx">is</span> <span class="nx">record</span> <span class="p">{|</span><span class="nx">record</span> <span class="p">{}</span> <span class="nx">value</span><span class="p">;|})</span> <span class="p">{</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Total rows in customer table : &quot;</span><span class="p">,</span> <span class="nx">result</span><span class="p">.</span><span class="nx">value</span><span class="p">[</span><span class="s">&quot;Total&quot;</span><span class="p">]);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">result</span> <span class="nx">is</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Next operation on the stream failed!&quot;</span><span class="p">,</span> <span class="nx">result</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Customer table is empty&quot;</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="c1">// Close the stream.</span>
    <span class="nx">error</span><span class="err">?</span> <span class="nx">e</span> <span class="p">=</span> <span class="nx">resultStream</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
    <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;------ End Count Total Rows -------&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//Define a record to load the query result schema as shown in the &#39;typedQuery&#39; function.</span>
<span class="c1">//In this example, all columns of the customer table will be loaded.</span>
<span class="c1">//Therefore, a `Customer` record will be created with all the columns. The name of the result column</span>
<span class="c1">//and the defined field name of the record will be matched case insensitively.</span>
<span class="nx">type</span> <span class="nx">Customer</span> <span class="nx">record</span> <span class="p">{|</span>
    <span class="kt">int</span> <span class="nx">customerId</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">lastName</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">firstName</span><span class="p">;</span>
    <span class="kt">int</span> <span class="nx">registrationId</span><span class="p">;</span>
    <span class="kt">float</span> <span class="nx">creditLimit</span><span class="p">;</span>
    <span class="kt">string</span> <span class="nx">country</span><span class="p">;</span>
<span class="p">|};</span>

<span class="kd">function</span> <span class="nx">typedQuery</span><span class="p">(</span><span class="nx">mysql</span><span class="p">:</span><span class="nx">Client</span> <span class="nx">mysqlClient</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;------ Start Query With Type Description -------&quot;</span><span class="p">);</span>
    <span class="c1">// The result is returned as a Customer record stream and the elements</span>
    <span class="c1">// of the stream can be either a Customer record or an error.</span>
    <span class="nx">stream</span><span class="p">&lt;</span><span class="nx">record</span><span class="p">{},</span> <span class="nx">error</span><span class="p">&gt;</span> <span class="nx">resultStream</span> <span class="p">=</span>
        <span class="nx">mysqlClient</span><span class="o">-&gt;</span><span class="nx">query</span><span class="p">(</span><span class="s">&quot;Select * from Customers&quot;</span><span class="p">,</span> <span class="nx">Customer</span><span class="p">);</span>

    <span class="c1">// Cast the generic record type to the Customer stream type.</span>
    <span class="nx">stream</span><span class="p">&lt;</span><span class="nx">Customer</span><span class="p">,</span> <span class="nx">sql</span><span class="p">:</span><span class="nx">Error</span><span class="p">&gt;</span> <span class="nx">customerStream</span> <span class="p">=</span>
        <span class="p">&lt;</span><span class="nx">stream</span><span class="p">&lt;</span><span class="nx">Customer</span><span class="p">,</span> <span class="nx">sql</span><span class="p">:</span><span class="nx">Error</span><span class="o">&gt;&gt;</span><span class="nx">resultStream</span><span class="p">;</span>

    <span class="c1">// Iterate the customer stream.</span>
    <span class="nx">error</span><span class="err">?</span> <span class="nx">e</span> <span class="p">=</span> <span class="nx">customerStream</span><span class="p">.</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">Customer</span> <span class="nx">customer</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="nx">customer</span><span class="p">);</span>
    <span class="p">});</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">e</span> <span class="nx">is</span> <span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="nx">e</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Close the stream.</span>
    <span class="nx">e</span> <span class="p">=</span> <span class="nx">resultStream</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>

    <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;------ End Query With Type Description -------&quot;</span><span class="p">);</span>
<span class="p">}</span>

<span class="c1">//Initialize the database table with sample data.</span>
<span class="kd">function</span> <span class="nx">initializeTable</span><span class="p">()</span> <span class="nx">returns</span> <span class="nx">sql</span><span class="p">:</span><span class="nx">Error</span><span class="err">?</span> <span class="p">{</span>
    <span class="nx">mysql</span><span class="p">:</span><span class="nx">Client</span> <span class="nx">mysqlClient</span> <span class="p">=</span> <span class="nx">check</span> <span class="nx">new</span> <span class="p">(</span><span class="nx">user</span> <span class="p">=</span> <span class="nx">dbUser</span><span class="p">,</span> <span class="nx">password</span> <span class="p">=</span> <span class="nx">dbPassword</span><span class="p">);</span>
    <span class="nx">sql</span><span class="p">:</span><span class="nx">ExecuteResult</span><span class="err">?</span> <span class="nx">result</span> <span class="p">=</span>
        <span class="nx">check</span> <span class="nx">mysqlClient</span><span class="o">-&gt;</span><span class="nx">execute</span><span class="p">(</span><span class="s">&quot;CREATE DATABASE IF NOT EXISTS MYSQL_BBE&quot;</span><span class="p">);</span>
    <span class="nx">result</span> <span class="p">=</span> <span class="nx">check</span> <span class="nx">mysqlClient</span><span class="o">-&gt;</span><span class="nx">execute</span><span class="p">(</span><span class="s">&quot;DROP TABLE IF EXISTS &quot;</span><span class="o">+</span>
        <span class="s">&quot;MYSQL_BBE.Customers&quot;</span><span class="p">);</span>
    <span class="nx">result</span> <span class="p">=</span> <span class="nx">check</span> <span class="nx">mysqlClient</span><span class="o">-&gt;</span><span class="nx">execute</span><span class="p">(</span><span class="s">&quot;CREATE TABLE IF NOT EXISTS &quot;</span> <span class="o">+</span>
        <span class="s">&quot;MYSQL_BBE.Customers(customerId INTEGER &quot;</span> <span class="o">+</span>
        <span class="s">&quot;NOT NULL AUTO_INCREMENT, FirstName  VARCHAR(300), LastName  &quot;</span> <span class="o">+</span>
        <span class="s">&quot;VARCHAR(300), RegistrationID INTEGER,&quot;</span> <span class="o">+</span>
        <span class="s">&quot;CreditLimit DOUBLE, Country  VARCHAR(300), PRIMARY KEY (CustomerId))&quot;</span><span class="p">);</span>
    <span class="nx">result</span> <span class="p">=</span> <span class="nx">check</span> <span class="nx">mysqlClient</span><span class="o">-&gt;</span><span class="nx">execute</span><span class="p">(</span><span class="s">&quot;INSERT INTO MYSQL_BBE.Customers &quot;</span><span class="o">+</span>
        <span class="s">&quot;(FirstName,LastName,RegistrationID,&quot;</span> <span class="o">+</span>
        <span class="s">&quot;CreditLimit,Country) VALUES (&#39;Peter&#39;, &#39;Stuart&#39;, 1, 5000.75, &#39;USA&#39;)&quot;</span><span class="p">);</span>
    <span class="nx">result</span> <span class="p">=</span> <span class="nx">check</span> <span class="nx">mysqlClient</span><span class="o">-&gt;</span><span class="nx">execute</span><span class="p">(</span><span class="s">&quot;INSERT INTO MYSQL_BBE.Customers &quot;</span><span class="o">+</span>
        <span class="s">&quot;(FirstName,LastName,RegistrationID,&quot;</span> <span class="o">+</span>
        <span class="s">&quot;CreditLimit,Country) VALUES (&#39;Dan&#39;, &#39;Brown&#39;, 2, 10000, &#39;UK&#39;)&quot;</span><span class="p">);</span>
    <span class="nx">check</span> <span class="nx">mysqlClient</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
<span class="p">}</span>

<span class="nx">public</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="p">{</span>
    <span class="c1">// Initialize the MySQL client.</span>
    <span class="nx">sql</span><span class="p">:</span><span class="nx">Error</span><span class="err">?</span> <span class="nx">err</span> <span class="p">=</span> <span class="nx">initializeTable</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">err</span> <span class="nx">is</span> <span class="nx">sql</span><span class="p">:</span><span class="nx">Error</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Sample data initialization failed!&quot;</span><span class="p">);</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">mysql</span><span class="p">:</span><span class="nx">Client</span><span class="p">|</span><span class="nx">sql</span><span class="p">:</span><span class="nx">Error</span> <span class="nx">mysqlClient</span> <span class="p">=</span> <span class="nx">new</span> <span class="p">(</span><span class="nx">user</span> <span class="p">=</span> <span class="nx">dbUser</span><span class="p">,</span>
            <span class="nx">password</span> <span class="p">=</span> <span class="nx">dbPassword</span><span class="p">,</span> <span class="nx">database</span> <span class="p">=</span> <span class="s">&quot;MYSQL_BBE&quot;</span><span class="p">);</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">mysqlClient</span> <span class="nx">is</span> <span class="nx">mysql</span><span class="p">:</span><span class="nx">Client</span><span class="p">)</span> <span class="p">{</span>
            <span class="c1">// Execute the `select` queries in different options.</span>
            <span class="nx">simpleQuery</span><span class="p">(</span><span class="nx">mysqlClient</span><span class="p">);</span>
            <span class="nx">countRows</span><span class="p">(</span><span class="nx">mysqlClient</span><span class="p">);</span>
            <span class="nx">typedQuery</span><span class="p">(</span><span class="nx">mysqlClient</span><span class="p">);</span>
            <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Queried the database successfully!&quot;</span><span class="p">);</span>

            <span class="c1">// Close the MySQL client.</span>
            <span class="nx">sql</span><span class="p">:</span><span class="nx">Error</span><span class="err">?</span> <span class="nx">e</span> <span class="p">=</span> <span class="nx">mysqlClient</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;MySQL Client initialization for &quot;</span> <span class="o">+</span>
                <span class="s">&quot;querying data failed!&quot;</span><span class="p">,</span> <span class="nx">mysqlClient</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>

            </div>

            <div class="col-xs-12 col-sm-12 col-md-12">
                <table class="cTopInfoContainer cTopControlsContainer">
                    <tr>
                        <td class="cLeftTD">
                            <h2>MySQL Select Query Operations</h2>
                            <p><p>This example demonstrates how to use the JDBC client select query operations
 with the stream return type. Note that the MySQL database driver JAR should
 be placed in the <code>&lt;BALLERINA_HOME&gt;/bre/lib/distributions/jballerina-&lt;VERSION&gt;/bre/lib</code> directory. The MySQL connector uses
 database properties from MySQL version 8.0.x onwards. Therefore, it is
 recommended to use a MySQL driver version greater than 8.0.x.</p>
</p>

                        </td>
                        <td class="cRightTD">
                            <div class="cTopButtonContainer">
                                
                                <div class="cButtonInfoContainer">
                                    <a class="prev" href="mysql-init-options.html?is_ref_by_example=true">
                                        <span>< PREVIOUS</span>
                                        <p>MySQL Client Initialization</p>
                                    </a>
                                </div>
                                 
                                <div class="cButtonInfoContainer">
                                    <a class="next" href="mysql-complex-type-queries.html?is_ref_by_example=true">
                                        <span>NEXT ></span>
                                        <p>MySQL Query with Complex Types</p>
                                    </a>
                                </div>
                                
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
            <div class="example" id="mysql-query-operation">
                <div class="col-xs-12 col-sm-12 col-md-12 cBBETable-container cCodeLeft">
                    <div class="cTopControlsContainer">
                        <div class="cTopControlsRow">
                            <div class="cLeftTD">
                                <div class="cBBE-links">
                                    <ul>
                                        <li>
                                            <a class="copy"><img src="/img/copy-icon.svg" /></a>
                                        </li>
                                        <li>
                                            <a target="_blank" href="https://github.com/ballerina-platform/ballerina-lang/tree/ballerina-1.2.x/examples/mysql-query-operation/"><img src="/img/github-logo-green.svg" /></a>
                                        </li>
                                        
                                    </ul>
                                </div>
                            </div> 
                        </div>
                    </div>
              
                    
                    <div class="codeSnippeset">

                        <div class="cBBE-body">
                            
                            <div class="cTR">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>import ballerina/io;
import ballerina/mysql;
import ballerina/sql;
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>string dbUser = &quot;root&quot;;
string dbPassword = &quot;Test@123&quot;;
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Username and password of the MySQL database. This is used in the below
 examples when initializing the MySQL connector. You need to change these
 based on your setup to try locally.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>function simpleQuery(mysql:Client mysqlClient) {
    io:println(&quot;------ Start Simple Query -------&quot;);
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    stream&lt;record{}, error&gt; resultStream =
        mysqlClient-&gt;query(&quot;Select * from Customers&quot;);
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Select the rows in the database table via the query remote operation.
 The result is returned as a stream and the elements of the stream can
 be either a record or an error.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    error? e = resultStream.forEach(function(record {} result) {
        io:println(&quot;Customer full details: &quot;, result);
        io:println(&quot;Customer first name: &quot;, result[&quot;FirstName&quot;]);
        io:println(&quot;Customer last name: &quot;, result[&quot;LastName&quot;]);
    });
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>If there is any error during the execution of the SQL query or
 iteration of the result stream, the result stream will terminate and
 return the error.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    if (e is error) {
        io:println(&quot;ForEach operation on the stream failed!&quot;, e);
    }
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Check and handle the error during the SQL query
 or iteration of the result stream.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    e = resultStream.close();
    io:println(&quot;------ End Simple Query -------&quot;);
}
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>In general cases, the stream will be closed automatically
 when the stream is fully consumed or any error is encountered.
 However, in case if the stream is not fully consumed, the stream should be
 closed specifically.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>function countRows(mysql:Client mysqlClient) {
    io:println(&quot;------ Start Count Total Rows -------&quot;);
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    stream&lt;record{}, error&gt; resultStream =
        mysqlClient-&gt;query(&quot;Select count(*) as Total from Customers&quot;);
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>The result of the count operation is provided as a record stream.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    record {|record {} value;|}|error? result = resultStream.next();
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Since the above count query will return only a single row, the
 <code>next()</code> operation is sufficient to retrieve the data.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    if (result is record {|record {} value;|}) {
        io:println(&quot;Total rows in customer table : &quot;, result.value[&quot;Total&quot;]);
    } else if (result is error) {
        io:println(&quot;Next operation on the stream failed!&quot;, result);
    } else {
        io:println(&quot;Customer table is empty&quot;);
    }
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Check the result and retrieve the value for total.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    error? e = resultStream.close();
    io:println(&quot;------ End Count Total Rows -------&quot;);
}
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Close the stream.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>type Customer record {|
    int customerId;
    string lastName;
    string firstName;
    int registrationId;
    float creditLimit;
    string country;
|};
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Define a record to load the query result schema as shown in the &lsquo;typedQuery&rsquo; function.
In this example, all columns of the customer table will be loaded.
Therefore, a <code>Customer</code> record will be created with all the columns. The name of the result column
and the defined field name of the record will be matched case insensitively.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>function typedQuery(mysql:Client mysqlClient) {
    io:println(&quot;------ Start Query With Type Description -------&quot;);
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    stream&lt;record{}, error&gt; resultStream =
        mysqlClient-&gt;query(&quot;Select * from Customers&quot;, Customer);
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>The result is returned as a Customer record stream and the elements
 of the stream can be either a Customer record or an error.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    stream&lt;Customer, sql:Error&gt; customerStream =
        &lt;stream&lt;Customer, sql:Error&gt;&gt;resultStream;
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Cast the generic record type to the Customer stream type.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    error? e = customerStream.forEach(function(Customer customer) {
        io:println(customer);
    });
    if (e is error) {
            io:println(e);
    }
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Iterate the customer stream.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    e = resultStream.close();
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Close the stream.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    io:println(&quot;------ End Query With Type Description -------&quot;);
}
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>function initializeTable() returns sql:Error? {
    mysql:Client mysqlClient = check new (user = dbUser, password = dbPassword);
    sql:ExecuteResult? result =
        check mysqlClient-&gt;execute(&quot;CREATE DATABASE IF NOT EXISTS MYSQL_BBE&quot;);
    result = check mysqlClient-&gt;execute(&quot;DROP TABLE IF EXISTS &quot;+
        &quot;MYSQL_BBE.Customers&quot;);
    result = check mysqlClient-&gt;execute(&quot;CREATE TABLE IF NOT EXISTS &quot; +
        &quot;MYSQL_BBE.Customers(customerId INTEGER &quot; +
        &quot;NOT NULL AUTO_INCREMENT, FirstName  VARCHAR(300), LastName  &quot; +
        &quot;VARCHAR(300), RegistrationID INTEGER,&quot; +
        &quot;CreditLimit DOUBLE, Country  VARCHAR(300), PRIMARY KEY (CustomerId))&quot;);
    result = check mysqlClient-&gt;execute(&quot;INSERT INTO MYSQL_BBE.Customers &quot;+
        &quot;(FirstName,LastName,RegistrationID,&quot; +
        &quot;CreditLimit,Country) VALUES (&#39;Peter&#39;, &#39;Stuart&#39;, 1, 5000.75, &#39;USA&#39;)&quot;);
    result = check mysqlClient-&gt;execute(&quot;INSERT INTO MYSQL_BBE.Customers &quot;+
        &quot;(FirstName,LastName,RegistrationID,&quot; +
        &quot;CreditLimit,Country) VALUES (&#39;Dan&#39;, &#39;Brown&#39;, 2, 10000, &#39;UK&#39;)&quot;);
    check mysqlClient.close();
}
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Initialize the database table with sample data.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>public function main() {
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    sql:Error? err = initializeTable();
    if (err is sql:Error) {
        io:println(&quot;Sample data initialization failed!&quot;);
        io:println(err);
    } else {
        mysql:Client|sql:Error mysqlClient = new (user = dbUser,
            password = dbPassword, database = &quot;MYSQL_BBE&quot;);
        if (mysqlClient is mysql:Client) {
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Initialize the MySQL client.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>            simpleQuery(mysqlClient);
            countRows(mysqlClient);
            typedQuery(mysqlClient);
            io:println(&quot;Queried the database successfully!&quot;);
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Execute the <code>select</code> queries in different options.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                            <div class="cTR hover-enable">

                                <div class="code">
                                    <div class="highlight"><pre><code class=language-ballerina>            sql:Error? e = mysqlClient.close();
        } else {
            io:println(&quot;MySQL Client initialization for &quot; +
                &quot;querying data failed!&quot;, mysqlClient);
        }
    }
}
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Close the MySQL client.</p>

                                        </div>
                                    </div>
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    
                    <div class="codeSnippeset">

                        <div class="cBBE-body">
                            
                            <div class="cTR cOutputTr">

                                <div class="code leading cOutput">
                                    <div class="highlight"><pre><code class=shell-session>#  To run this sample, navigate to the directory that contains the
# `.bal` file and execute the `ballerina run` command below.
ballerina run mysql_query_operation.bal
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                </div>
                            </div>
                            
                            <div class="cTR cOutputTr">

                                <div class="code cOutput">
                                    <div class="highlight"><pre><code class=shell-session>------ Start Simple Query -------
Customer full details: customerId=1 FirstName=Peter LastName=Stuart RegistrationID=1 CreditLimit=5000.75 Country=USA
Customer first name: Peter
Customer last name: Stuart
Customer full details: customerId=2 FirstName=Dan LastName=Brown RegistrationID=2 CreditLimit=10000.0 Country=UK
Customer first name: Dan
Customer last name: Brown
------ End Simple Query -------
------ Start Count Total Rows -------
Total rows in customer table : 2
------ End Count Total Rows -------
------ Start Query With Type Description -------
customerId=1 firstName=Peter lastName=Stuart registrationId=1 creditLimit=5000.75 country=USA
customerId=2 firstName=Dan lastName=Brown registrationId=2 creditLimit=10000.0 country=UK
------ End Query With Type Description -------
Queried the database successfully!
</code></pre></div>

                                </div>
                                <div class="docs">
                                    
                                </div>
                            </div>
                            
                        </div>
                    </div>
                    


                     
                </div>
            </div>
        </div>
    </div>

     <script>
            $(document).ready(function() {

                // hljs.initHighlightingOnLoad();

                $(".switch").click(function() {
                    $(".cCodeRight").toggleClass('cShow');
                    $(".cCodeLeft").toggleClass('cHide');
                });

                // register "copy to clipboard" event to elements with "copy" class
                var clipboard = new ClipboardJS('.copy', {
                    text: function(trigger) {
                        return $('.FullCode').find('pre').text();
                    }
                });

                // Register events show hide tooltip on click event
                clipboard.on('success', function(e) {
                    setTooltip(e.trigger, 'Copied!');
                    hideTooltip(e.trigger);
                });

                clipboard.on('error', function(e) {
                    setTooltip(e.trigger, 'Failed!');
                    hideTooltip(e.trigger);
                });

                $('.copy').tooltip({
                    trigger: 'click',
                    placement: 'bottom'
                });
                $("a.copy").unbind("click");
            });

            function setTooltip(btn, message) {
                $(btn).attr('data-original-title', message)
                    .tooltip('show');
            }

            function hideTooltip(btn) {
                setTimeout(function() {
                    $(btn).tooltip('hide').removeAttr('data-original-title');
                }, 1000);
            }
        </script>
