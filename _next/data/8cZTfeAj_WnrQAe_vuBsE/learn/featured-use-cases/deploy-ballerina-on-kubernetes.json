{"pageProps":{"frontmatter":{"layout":"ballerina-deploying-ballerina-on-kubernetes-left-nav-pages-swanlake","title":"Deploy Ballerina on Kubernetes","description":"Let’s dockerize your Ballerina service and deploy it into Kubernetes.","keywords":"ballerina, programming language, cloud, kubernetes, docker, cloud-native","permalink":"/learn/deploy-ballerina-on-kubernetes/","active":"deploy-ballerina-on-kubernetes","intro":"This guide walks you through the steps of writing a simple Ballerina service, dockerizing the application, and deploy it in Kubernetes.","redirect_from":["/learn/deploying-ballerina-on-kubernetes","/learn/deploying-ballerina-on-kubernetes/","/learn/deploy-ballerina-on-kubernetes","/learn/getting-started/deploying-ballerina-on-kubernetes/","/learn/getting-started/deploying-ballerina-on-kubernetes"]},"content":"\nCode to Cloud is a compiler extension, which is packed with Ballerina. It eases generating the artifacts required for the cloud from your Ballerina code. Currently, you could generate Docker and Kubernetes artifacts from the Ballerina code. This process encourages you to write cloud-ready code from day one without any additional effort. \n\n## Set up the prerequisites\n\nTo complete this tutorial, you need:\n\n1. [Ballerina 2202.0.0 (Swan Lake)](/learn/install-ballerina/set-up-ballerina/) or greater\n2. A text editor\n    >**Tip:** Preferably, <a href=\"https://code.visualstudio.com/\" target=\"_blank\">Visual Studio Code</a> with the <a href=\"https://marketplace.visualstudio.com/items?itemName=WSO2.ballerina\" target=\"_blank\">Ballerina extension</a> installed.\n3. A command terminal\n4. [Docker](https://www.docker.com/) installed and configured in your machine\n5. A [Docker Hub](https://hub.docker.com/) account\n6. [Kubectl](https://kubernetes.io/docs/tasks/tools/) installed and configured in a [Kubernetes cluster](https://minikube.sigs.k8s.io/docs/start/)\n\n## Create the Ballerina package\n\nBallerina uses packages to group code. You need to create a Ballerina package and write the business logic in it. In the terminal, execute the command below to create the Ballerina package for the API implementation.\n\n> **Info:** For more information on Ballerina packages, see [Organize Ballerina code](/learn/organize-ballerina-code/).\n\n```\n$ bal new greeter\n```\n\nYou view the output below.\n\n\n```\nCreated new package 'greeter' at greeter.\n```\n\nThis creates a directory named `covid19` with the default module along with a sample code for the service as shown below. \n\n```\n.\ngreeter/\n├── Ballerina.toml\n└── main.bal\n```\n\n## Create the Ballerina service\n\nTo write a Ballerina program that returns a `Hello, World!` string upon invoking the resource, replace the `main.bal` content with the code below.\n\n```ballerina\nimport ballerina/http;\n\nlistener http:Listener httpListener = new (8080);\nservice / on httpListener {\n    resource function get greeting() returns string { \n        return \"Hello, World!\"; \n    }\n}\n```\n\n## Update the `Ballerina.toml` file\n\nTo enable the code to cloud functionality in the Ballerina package, add the `cloud=\"k8s\"` property below to the `build-options` in the `Ballerina.toml` file.\n\n```toml\n[build-options]\ncloud = \"k8s\"\n```\n\n## Create the `Cloud.toml` file\n\nCreate a file named `Cloud.toml` in the package directory and add the content below. \n\n>**Info:** Make sure to replace the value of the repository field with your Docker hub repository name.\n\n```toml\n[container.image]\nrepository=\"wso2inc\" # Docker hub repository name.\nname=\"greeter\" # container name\ntag=\"latest\"\n```\n\n## Build the package\n\nExecute the code below to build the Ballerina package.\n\n```\n$ bal build\n```\n\nYou view the output below.\n\n```\nCompiling source\n        example/greeter:0.1.0\n\nGenerating executable\n\nGenerating artifacts...\n\n        @kubernetes:Service                      - complete 1/1\n        @kubernetes:Deployment                   - complete 1/1\n        @kubernetes:HPA                          - complete 1/1\n        @kubernetes:Docker                       - complete 2/2 \n\n        Execute the below command to deploy the Kubernetes artifacts: \n        kubectl apply -f /home/example/greeter/target/kubernetes/greeter\n\n        Execute the below command to access service via NodePort: \n        kubectl expose deployment greeter-deployment --type=NodePort --name=greeter-svc-local\n```\n\n>**Info:** This generates the cloud artifacts inside the `target/` directory.\n\n## Deploy the package on Docker\n\nExecute the command below to push the created Docker image into Docker Hub.\n\n**Info:** Replace `wso2inc` with your repository name.\n\n```\n$ docker push wso2inc/greeter:latest\n```\n\nYou view the output below.\n\n```\nThe push refers to repository [docker.io/wso2inc/greeter]\nlatest: digest: sha256:c1acf5165848d70c347a970d6b5c32f63669cdbb0d4c1daca2c91cfbe32f61b2 size: 13718\n```\n\n## Deploy the package on Kubernetes\n\nExecute the command below to deploy the Ballerina application into the Kubernetes cluster.\n\n```\n$ kubectl apply -f /home/example/greeter/target/kubernetes/greeter\n```\nYou view the output below.\n\n```ballerina\nservice/greeter-svc created\ndeployment.apps/greeter-deployment created\nhorizontalpodautoscaler.autoscaling/greeter-hpa created\n```\n\n## Learn more\n\nFor in-depth information about executing these deployed applications and the supported customizations in code to cloud, see [Code to Cloud deployment](/learn/run-in-the-cloud/code-to-cloud/code-to-cloud-deployment/).\n ","id":"deploy-ballerina-on-kubernetes","sub":"","third":"","slug":"deploy-ballerina-on-kubernetes"},"__N_SSG":true}