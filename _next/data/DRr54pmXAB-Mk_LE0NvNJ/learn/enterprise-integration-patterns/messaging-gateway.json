{"pageProps":{"tagline":"Encapsulates the messaging from the application","desc":"Messaging Gateway wraps messaging-specific method calls and exposes domain-specific methods to the application.","helps":"Ballerina's classes and modules help to create wrappers and expose domain-specific functions and methods.","category":"Messaging Endpoints","index":42,"tags":["Messaging Gateway","Message"],"link":"https://www.enterpriseintegrationpatterns.com/patterns/messaging/MessagingGateway.html","content":[{"headerCode":"<pre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D73A49\">import</span><span style=\"color:#24292E\"> ballerina/http;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">import</span><span style=\"color:#24292E\"> ballerina/io;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">public</span><span style=\"color:#D73A49\"> type</span><span style=\"color:#6F42C1\"> ActivateLine</span><span style=\"color:#D73A49\"> readonly</span><span style=\"color:#D73A49\"> &#x26;</span><span style=\"color:#D73A49\"> record</span><span style=\"color:#24292E\"> {</span><span style=\"color:#D73A49\">|</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> customerId;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> phoneNumber;</span></span>\n<span class=\"line\"><span style=\"color:#032F62\">    \"NEW ACTIVATION\"</span><span style=\"color:#D73A49\">|</span><span style=\"color:#032F62\">\"TRANSFER\"</span><span style=\"color:#24292E\"> activationType;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> planCode;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> activationDate;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">|</span><span style=\"color:#24292E\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">type</span><span style=\"color:#6F42C1\"> ActivationResponse</span><span style=\"color:#D73A49\"> readonly</span><span style=\"color:#D73A49\"> &#x26;</span><span style=\"color:#D73A49\"> record</span><span style=\"color:#24292E\"> {</span><span style=\"color:#D73A49\">|</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> phoneNumber;</span></span>\n<span class=\"line\"><span style=\"color:#032F62\">    \"REJECTED\"</span><span style=\"color:#D73A49\">|</span><span style=\"color:#032F62\">\"APPROVED\"</span><span style=\"color:#24292E\"> status;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">|</span><span style=\"color:#24292E\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">type</span><span style=\"color:#6F42C1\"> ActivationSuccess</span><span style=\"color:#D73A49\"> readonly</span><span style=\"color:#D73A49\"> &#x26;</span><span style=\"color:#D73A49\"> record</span><span style=\"color:#24292E\"> {</span><span style=\"color:#D73A49\">|</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> phoneNumber;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">|</span><span style=\"color:#24292E\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">type</span><span style=\"color:#6F42C1\"> ActivationFailureError</span><span style=\"color:#D73A49\"> error</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">public class</span><span style=\"color:#6F42C1\"> LineConnectionManager</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    private</span><span style=\"color:#D73A49\"> final</span><span style=\"color:#24292E\"> http</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">Client lineClinet;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    public</span><span style=\"color:#D73A49\"> function</span><span style=\"color:#6F42C1\"> init</span><span style=\"color:#24292E\">() </span><span style=\"color:#D73A49\">returns</span><span style=\"color:#D73A49\"> error?</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">        self</span><span style=\"color:#24292E\">.lineClinet </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#D73A49\"> new</span><span style=\"color:#24292E\"> (</span><span style=\"color:#032F62\">\"http://api.telcox.com.balmock.io\"</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    public</span><span style=\"color:#D73A49\"> function</span><span style=\"color:#6F42C1\"> activateLine</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">ActivateLine</span><span style=\"color:#E36209\"> activateLine</span><span style=\"color:#24292E\">) </span><span style=\"color:#D73A49\">returns</span><span style=\"color:#24292E\"> ActivationSuccess</span><span style=\"color:#D73A49\">|</span><span style=\"color:#24292E\">ActivationFailureError {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        ActivationResponse</span><span style=\"color:#D73A49\">|error</span><span style=\"color:#24292E\"> activationResponse </span><span style=\"color:#D73A49\">=</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">            self</span><span style=\"color:#24292E\">.lineClinet</span><span style=\"color:#D73A49\">->/</span><span style=\"color:#24292E\">plans</span><span style=\"color:#D73A49\">/</span><span style=\"color:#24292E\">[activateLine.planCode]</span><span style=\"color:#D73A49\">/</span><span style=\"color:#24292E\">activate.</span><span style=\"color:#6F42C1\">post</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">activateLine</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        if</span><span style=\"color:#24292E\"> activationResponse </span><span style=\"color:#D73A49\">is</span><span style=\"color:#D73A49\"> error</span><span style=\"color:#D73A49\"> ||</span><span style=\"color:#24292E\"> activationResponse.status </span><span style=\"color:#D73A49\">==</span><span style=\"color:#032F62\"> \"REJECTED\"</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">            return</span><span style=\"color:#D73A49\"> error</span><span style=\"color:#24292E\">(</span><span style=\"color:#032F62\">\"Connection activation failure\"</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">phoneNumber</span><span style=\"color:#D73A49\"> =</span><span style=\"color:#24292E\"> activateLine.phoneNumber);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        }</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        return</span><span style=\"color:#24292E\"> {phoneNumber</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> activateLine.phoneNumber};</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">}</span></span>\n<span class=\"line\"></span></code></pre>","mainCode":"<pre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"><code><span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">public</span><span style=\"color:#D73A49\"> function</span><span style=\"color:#6F42C1\"> main</span><span style=\"color:#24292E\">() </span><span style=\"color:#D73A49\">returns</span><span style=\"color:#D73A49\"> error?</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    ActivateLine activateLine </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        customerId</span><span style=\"color:#D73A49\">:</span><span style=\"color:#032F62\"> \"USER-USW-0012300912\"</span><span style=\"color:#24292E\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        phoneNumber</span><span style=\"color:#D73A49\">:</span><span style=\"color:#032F62\"> \"555-555-5555\"</span><span style=\"color:#24292E\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        activationType</span><span style=\"color:#D73A49\">:</span><span style=\"color:#032F62\"> \"NEW ACTIVATION\"</span><span style=\"color:#24292E\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        planCode</span><span style=\"color:#D73A49\">:</span><span style=\"color:#032F62\"> \"PLN123\"</span><span style=\"color:#24292E\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        activationDate</span><span style=\"color:#D73A49\">:</span><span style=\"color:#032F62\"> \"2023-09-19\"</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    };</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#24292E\">    LineConnectionManager lineConnectionManager </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#D73A49\"> new</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    ActivationSuccess</span><span style=\"color:#D73A49\">|</span><span style=\"color:#24292E\">ActivationFailureError activateLineResult </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> lineConnectionManager.</span><span style=\"color:#6F42C1\">activateLine</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">activateLine</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    io</span><span style=\"color:#D73A49\">:</span><span style=\"color:#6F42C1\">println</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">activateLineResult</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">}</span></span>\n<span class=\"line\"></span></code></pre>","raw":"import ballerina/http;\nimport ballerina/io;\n\npublic type ActivateLine readonly & record {|\n    string customerId;\n    string phoneNumber;\n    \"NEW ACTIVATION\"|\"TRANSFER\" activationType;\n    string planCode;\n    string activationDate;\n|};\n\ntype ActivationResponse readonly & record {|\n    string phoneNumber;\n    \"REJECTED\"|\"APPROVED\" status;\n|};\n\ntype ActivationSuccess readonly & record {|\n    string phoneNumber;\n|};\n\ntype ActivationFailureError error;\n\npublic class LineConnectionManager {\n\n    private final http:Client lineClinet;\n\n    public function init() returns error? {\n        self.lineClinet = check new (\"http://api.telcox.com.balmock.io\");\n    }\n\n    public function activateLine(ActivateLine activateLine) returns ActivationSuccess|ActivationFailureError {\n        ActivationResponse|error activationResponse =\n            self.lineClinet->/plans/[activateLine.planCode]/activate.post(activateLine);\n        if activationResponse is error || activationResponse.status == \"REJECTED\" {\n            return error(\"Connection activation failure\", phoneNumber = activateLine.phoneNumber);\n        }\n        return {phoneNumber: activateLine.phoneNumber};\n    }\n}\n\npublic function main() returns error? {\n    ActivateLine activateLine = {\n        customerId: \"USER-USW-0012300912\",\n        phoneNumber: \"555-555-5555\",\n        activationType: \"NEW ACTIVATION\",\n        planCode: \"PLN123\",\n        activationDate: \"2023-09-19\"\n    };\n\n    LineConnectionManager lineConnectionManager = check new;\n    ActivationSuccess|ActivationFailureError activateLineResult = lineConnectionManager.activateLine(activateLine);\n    io:println(activateLineResult);\n}\n","name":"messaging-gateway.bal"}],"name":" Messaging Gateway"},"__N_SSG":true}