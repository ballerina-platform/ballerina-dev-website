{"pageProps":{"samples":{"code":"<pre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D73A49\">import</span><span style=\"color:#24292E\"> ballerinax/mysql;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">import</span><span style=\"color:#24292E\"> ballerinax/salesforce </span><span style=\"color:#D73A49\">as</span><span style=\"color:#24292E\"> sf;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">type</span><span style=\"color:#6F42C1\"> Product</span><span style=\"color:#D73A49\"> record</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> Name;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> Product_Unit__c;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> CurrencyIsoCode;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">type</span><span style=\"color:#6F42C1\"> ProductRecieved</span><span style=\"color:#D73A49\"> record</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> name;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> unitType;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> currencyISO;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> productId;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">const </span><span style=\"color:#005CC5\">int</span><span style=\"color:#005CC5\"> HEADINGS_ROW</span><span style=\"color:#D73A49\"> =</span><span style=\"color:#005CC5\"> 1</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">//mySQL configuration parameters</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> int</span><span style=\"color:#24292E\"> port </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> host </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> user </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> database </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> password </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Salesforce configuration parameters</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> salesforceAccessToken </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> salesforceBaseUrl </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#24292E\">sf</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">Client salesforce </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#D73A49\"> new</span><span style=\"color:#24292E\"> ({</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    baseUrl</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> salesforceBaseUrl,</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    auth</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        token</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> salesforceAccessToken</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">public</span><span style=\"color:#D73A49\"> function</span><span style=\"color:#6F42C1\"> main</span><span style=\"color:#24292E\">() </span><span style=\"color:#D73A49\">returns</span><span style=\"color:#D73A49\"> error?</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    mysql</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">Client mysql </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#D73A49\"> new</span><span style=\"color:#24292E\"> (</span><span style=\"color:#E36209\">host</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">user</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">password</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">database</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">port</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    stream&#x3C;</span><span style=\"color:#24292E\">ProductRecieved, </span><span style=\"color:#D73A49\">error?></span><span style=\"color:#24292E\"> streamOutput </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> mysql</span><span style=\"color:#D73A49\">-></span><span style=\"color:#6F42C1\">query</span><span style=\"color:#24292E\">(</span></span>\n<span class=\"line\"><span style=\"color:#032F62\">        `SELECT name, unitType, currencyISO, productId FROM products WHERE processed = false`</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    ProductRecieved[] productsRecieved </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#D73A49\"> from</span><span style=\"color:#24292E\"> ProductRecieved items </span><span style=\"color:#D73A49\">in</span><span style=\"color:#24292E\"> streamOutput</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        select</span><span style=\"color:#24292E\"> items;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    foreach </span><span style=\"color:#24292E\">ProductRecieved prductRecieved </span><span style=\"color:#D73A49\">in</span><span style=\"color:#24292E\"> productsRecieved {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        Product product </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            Name</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> prductRecieved.name,</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            Product_Unit__c</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> prductRecieved.unitType,</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            CurrencyIsoCode</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> prductRecieved.currencyISO</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        };</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        _ </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#24292E\"> salesforce</span><span style=\"color:#D73A49\">-></span><span style=\"color:#6F42C1\">create</span><span style=\"color:#24292E\">(</span><span style=\"color:#032F62\">\"Product2\"</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">product</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        _ </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#24292E\"> mysql</span><span style=\"color:#D73A49\">-></span><span style=\"color:#6F42C1\">execute</span><span style=\"color:#24292E\">(</span></span>\n<span class=\"line\"><span style=\"color:#032F62\">            `UPDATE products SET processed = true WHERE productId = ${</span><span style=\"color:#24292E\">prductRecieved</span><span style=\"color:#032F62\">.</span><span style=\"color:#24292E\">productId</span><span style=\"color:#032F62\">}`</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">}</span></span></code></pre>"},"content":"\nimport ballerinax/mysql;\nimport ballerinax/salesforce as sf;\n\ntype Product record {\n    string Name;\n    string Product_Unit__c;\n    string CurrencyIsoCode;\n};\n\ntype ProductRecieved record {\n    string name;\n    string unitType;\n    string currencyISO;\n    string productId;\n};\n\nconst int HEADINGS_ROW = 1;\n\n//mySQL configuration parameters\nconfigurable int port = ?;\nconfigurable string host = ?;\nconfigurable string user = ?;\nconfigurable string database = ?;\nconfigurable string password = ?;\n\n// Salesforce configuration parameters\nconfigurable string salesforceAccessToken = ?;\nconfigurable string salesforceBaseUrl = ?;\n\nsf:Client salesforce = check new ({\n    baseUrl: salesforceBaseUrl,\n    auth: {\n        token: salesforceAccessToken\n    }\n});\n\npublic function main() returns error? {\n    mysql:Client mysql = check new (host, user, password, database, port);\n    stream<ProductRecieved, error?> streamOutput = mysql->query(\n        `SELECT name, unitType, currencyISO, productId FROM products WHERE processed = false`);\n    ProductRecieved[] productsRecieved = check from ProductRecieved items in streamOutput\n        select items;\n    foreach ProductRecieved prductRecieved in productsRecieved {\n        Product product = {\n            Name: prductRecieved.name,\n            Product_Unit__c: prductRecieved.unitType,\n            CurrencyIsoCode: prductRecieved.currencyISO\n        };\n        _ = check salesforce->create(\"Product2\", product);\n        _ = check mysql->execute(\n            `UPDATE products SET processed = true WHERE productId = ${prductRecieved.productId}`);\n    }\n}\n  \n"},"__N_SSG":true}