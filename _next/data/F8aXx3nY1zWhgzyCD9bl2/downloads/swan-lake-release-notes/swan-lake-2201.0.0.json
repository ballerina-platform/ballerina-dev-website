{"pageProps":{"frontmatter":{"layout":"ballerina-left-nav-release-notes","title":"2201.0.0 (Swan Lake)","permalink":"/downloads/swan-lake-release-notes/2201-0-0/","active":"2201-0-0","redirect_from":["/downloads/swan-lake-release-notes/2201-0-0","/downloads/swan-lake-release-notes/2201.0.0/","/downloads/swan-lake-release-notes/2201-0-0-swan-lake/","/downloads/swan-lake-release-notes/2201-0-0-swan-lake"]},"content":"\n### Overview of Ballerina 2201.0.0 (Swan Lake)\n\n<em>2201.0.0 (Swan Lake) is the first major release of 2022, and it includes a new set of features and significant improvements to the compiler, runtime, standard library, and developer tooling. It is based on the 2022R1 version of the Language Specification.</em> \n\n### Updating Ballerina\n\n>**Info:** The version format has been revised. `2201.0.0 (Swan Lake)` represents the format of `$YYMM.$UPDATE.$PATCH ($CODE_NAME)`. For further information, see [Ballerina Swan Lake is on the Horizon](https://blog.ballerina.io/posts/ballerina-swan-lake-is-on-the-horizon/).\n\nIf you are already using Ballerina, use the [Ballerina update tool](/learn/cli-documentation/update-tool/#using-the-update-tool) to directly update to 2201.0.0 (Swan Lake). To do this: \n\n1. Run the command below to get the latest version of the update tool.\n\n   `bal update`\n\n2. Run the command below to update your Ballerina version to 2201.0.0 (Swan Lake).\n\n   `bal dist update`\n\n#### Troubleshooting \n\nIf you already ran the `bal dist update` (or `bal dist pull 2201.0.0`) before the `bal update` command, follow the instructions below to recover your installation.\n\n##### For macOS Users (`.pkg` installations)\n\n1. Run the `rm ~/.ballerina/ballerina-version` command to delete the version configuration.\n2. Run the `chmod 755 /Library/Ballerina/distributions/ballerina-2201.0.0/bin/bal` command to provide execute permissions for the `bal` command.\n3. Run the `bal dist use 2201.0.0` command to switch to the 2201.0.0 version. \n\n##### For Ubuntu Users (`.deb` installations)\n\n1. Run the `rm ~/.ballerina/ballerina-version` command to delete the version configuration.\n2. Run the `chmod 755 /usr/lib/ballerina/distributions/ballerina-2201.0.0/bin/bal` command to provide execute permissions for the `bal` command.\n3. Run the `bal dist use 2201.0.0` command to switch to the 2201.0.0 version.\n\n##### For CentOS Users (`.rpm` installations)\n\n1. Run the `rm ~/.ballerina/ballerina-version` command to delete the version configuration.\n2. Run the `chmod 755 /usr/lib64/ballerina/distributions/ballerina-2201.0.0/bin/bal` command to provide execute permissions for the `bal` command.\n3. Run the `bal dist use 2201.0.0` command to switch to the 2201.0.0 version.\n\n##### For Windows Users (`.msi` installations)\n\n1. Run the `del %userprofile%\\.ballerina\\ballerina-version` command to delete the version configuration.\n2. Run the `bal dist use 2201.0.0` command to switch to the 2201.0.0 version.\n\n### Installing Ballerina\n\nIf you have not installed Ballerina, then download the [installers](/downloads/#swanlake) to install.\n\n### Migrating from Swan Lake Beta Releases\n>**Info:** If you have been using Swan Lake Beta releases, delete the `Dependencies.toml` files in your Ballerina packages when migrating to Balelrina 2201.0.0 (Swan Lake). \n\nA few backward-incompatible changes have been introduced during the Swan Lake Beta program, and thereby, some of your existing packages may not compile with Ballerina 2201.0.0 (Swan Lake). Therefore, you need to delete the `Dependencies.toml` file to force the dependency resolver to use the latest versions of your dependencies. \n\n### Language Updates\n\n#### New Features\n\n##### Support to Refer to Parameters and Local Variables in Object Constructor Expressions\n\nObject constructor expressions can now refer to parameters and local variables. This feature is also available when using an object constructor expression with the `service` qualifier to create a service object. These references can be in field initializers and object methods, including the `init` method.\n\n```ballerina\ntype Person object {\n    string name;\n    string code;\n\n    function getRegistrationId(string prefix) returns string;\n};\n\nfunction createPerson(string name, int id, string department) returns Person|error {\n    string codeId = check getCode(id);\n\n    Person person = object {\n        string name;\n        string code = codeId; // Refers to the `codeId` local variable.\n\n        function init() {\n            self.name = name; // Refers to the `name` parameter.\n        }\n\n        function getRegistrationId(string prefix) returns string {\n            string regId = department + \":\" + self.code; // Refers to the `department` parameter.\n\n            if (prefix.length() > 0) {\n                return prefix + \"-\" + regId;\n            }\n\n            return regId;\n        }\n    };\n\n    return person;\n}\n\nfunction getCode(int id) returns string|error {\n    if id < 0 {\n        return error(\"Invalid ID\");\n    }\n    return id.toString();\n}\n```\n\n#### Bug Fixes\n\n- Fixed a bug that caused constants to be resolved with incorrect types in certain scenarios. The type of constants is now the intersection of readonly and the singleton type containing just the shape of the value named by the constant.\n\n  ```ballerina\n  // Previously, the type of X was `int` and now it is singleton `2`.\n  const int X = 1 + 1;\n   \n  public function main() {\n     // Now results in an error.\n     X y = 3;\n  }\n  ```\n\n  ```ballerina\n  // Previously, the type of X was `map<int>` and now it is the intersection of readonly\n  // and the singleton type containing just the mapping value `{a: 1}`.\n  const map<int> X = {a: 1};\n   \n  public function main() {\n     // Now, this results in an error.\n     X y = {a: 2};\n  }\n  ```\n\n- Fixed a spec deviation in type narrowing. This may result in types that were previously narrowed no longer being narrowed.\n\n   Consider the following records.\n\n   ```ballerina\n   type Employee record {\n      int id;\n      string name;\n      string department;\n   };\n      \n   type Student record {\n      string id;\n      string name;         \n      int grade;\n   };\n   ```\n\n   Previously, when a type test was used as follows, the type of `v` in the else block was narrowed to `Student`.\n\n   ```ballerina\n   function fn(Employee|Student v) {\n      if v is Employee {\n            // `v` is narrowed to `Employee` here.\n            string dept = v.department;\n      } else {\n            // `v` was previously narrowed to `Student` here.\n            // Will now result in a compilation error.\n            int grade = v.grade;\n      }\n   }\n   ```\n\n   Even though jBallerina currently allows only values that belong to either `Employee` or `Student` to be passed as arguments for the parameter of type `Employee|Student`, the Ballerina specification defines subtyping to be semantic. This, along with mutability, would mean that a value that does not belong to `Employee` nor `Student` but belongs to `Employee|Student` can be passed as an argument here, which results in the possibility of the value not belonging to `Student` in the else block.\n\n   For example, one would be able to call `fn` with the following.\n\n   ```ballerina\n   public function main() {\n      record {|\n            int|string id;\n            string name;\n            anydata grade;\n            anydata department;\n      |} rec = {\n            id: \"A1234\",\n            name: \"Amy\",\n            department: [\"physics\", 1],\n            grade: 12\n      };\n      fn(rec);\n   }\n   ```\n\n   Although it is not possible to call this function in this manner at the moment since jBallerina does not support semantic subtyping, the changes to narrowing have been introduced in this release to minimize future incompatibility issues.\n\n- Fixed a spec deviation that allowed non-required fields of records/maps and error detail records/maps to be bound using mapping and error binding patterns in variable declarations and destructuring assignment statements. Attempting to bind a non-required field will now result in a compilation error.\n\n  ```ballerina\n  type Employee record {\n     string name;\n     int age?;\n  };\n   \n  function bindEmployee(Employee emp) {\n     string empName;\n     int empAge;\n   \n     // The 'age' field is optional in the `Employee` record type-descriptor.\n     // Therefore, attempting to bind it will now result in compilation errors.  \n     {name: empName, age: empAge} = emp; // error for `age: empAge`\n     var {name: empNameOne, age: empAgeOne} = emp; // error for `age: empAgeOne`\n   \n     // Similarly, since there is no required `department` field in the `Employee`\n     // record, the following will also result in an error.\n     var {name, department} = emp; // error for `department`\n  }\n   \n  type Error error<record {| int code?; string identifier; boolean...; |}>;\n   \n  function bindError(Error err) {\n     // The 'code' field is optional in the detail record of `Error`.\n     // Therefore, attempting to bind it will now result in a compilation error.\n     Error error(message1, code = code1, identifier = identifier1) = err; // error for 'code = code1'\n   \n     // Similarly, attempting to bind an undefined (non-required) `fatal` field will\n     // also result in a compilation error.\n     var error(message, fatal = fatal) = err; // error for 'fatal = fatal'\n  }\n  ```\n\n- Fixed a bug in the compiler that resulted in some illegal variable shadowing scenarios not being detected. Ballerina allows shadowing only variables that belong to the module scope.\n\n  ```ballerina\n  function fn(int y, int z) returns int {\n     function (int, int, int) returns int f = (x, y, z) => x + y + z; // error: redeclared symbols 'y' and 'z'\n   \n     int x = 34; // This is not in an overlapping scope, so, it does not result in an error.\n     return f(12, 32, 33);\n  }\n   \n  function createService(int age) returns\n         service object { public function getAgeInFiveYears(int age) returns int; } {\n     return service object {\n             public function getAgeInFiveYears(int age) returns int { // error: redeclared symbol 'age'\n                 return 5 + age;\n             }\n         };\n  }\n  ```\n\n- Fixed a bug that caused classes with all `final` fields of immutable types to be considered a `readonly class` (i.e., a subtype of `readonly`).\n\n   Such a class can no longer be used in a context that expects a subtype of `readonly`.\n\n   ```ballerina\n   class Person {\n      final string name;\n      final string[] & readonly address;\n      \n      function init(string name, string[] address) {\n            self.name = name;\n            self.address = address.cloneReadOnly();\n      }\n      \n      function getAddress() returns string => string:'join(\", \", ...self.address);\n   }\n      \n   public function main() {\n      Person person = new (\"May\", [\"Palm Grove\", \"Colombo 3\"]);\n      \n      // This, which was allowed previously results in an error now.\n      readonly readOnlyValue = person;\n   }\n   ```\n\n- Fixed a bug that resulted in invalid table lookups due to not distinguishing between `int`, `float`, and `decimal` zero.\n\n  ```ballerina\n  import ballerina/io;\n   \n  type Employee record {|\n     readonly int|float|decimal age;\n     int code;\n  |};\n   \n  public function main() {\n     table<Employee> key(age) empTable = table [\n         {age: 0, code: 100} // int `0` is the key\n     ];\n   \n     Employee? v1 = empTable[0f]; // Lookup with float `0` as the key.\n     io:println(v1 is Employee); // Previously `true`, now `false`.\n   \n     Employee? v2 = empTable[0d]; // Lookup with decimal `0` as the key.\n     io:println(v2 is Employee); // Previously `true`, now `false`.\n   \n     Employee? v3 = empTable[0]; // Lookup with int `0` as the key.\n     io:println(v3 is Employee); // Only this will continue to be `true`.\n  }\n  ```\n\nTo view bug fixes, see the [GitHub milestone for 2201.0.0 (Swan Lake)](https://github.com/ballerina-platform/ballerina-lang/issues?q=is%3Aissue+is%3Aclosed+label%3AType%2FBug+label%3ATeam%2FCompilerFE+milestone%3A%22Ballerina+2201.0.0%22).\n\n### Runtime Updates\n\n#### Bug Fixes\n\nTo view bug fixes, see the [GitHub milestone for 2201.0.0 (Swan Lake)](https://github.com/ballerina-platform/ballerina-lang/issues?q=is%3Aissue+is%3Aclosed+label%3AType%2FBug+label%3ATeam%2FjBallerina+milestone%3A%22Ballerina+2201.0.0%22).\n\n### Standard Library Updates\n\n#### New Features\n\n##### `graphql` Package\n- Added the CORS configuration support\n\n##### `http` Package\n\n- Implemented typed `headers` for the HTTP response\n- Added the `map<string>` data binding support for `application/www-x-form-urlencoded`\n- Added support to provide an inline request/response body with `x-form-urlencoded` content\n- Added compiler plugin validation for usage of the `@http:Payload` annotation\n\n#### Improvements\n\n##### `graphql` Package\n- Removed the deprecated `add` method in the `graphql:Context` object\n\n##### `grpc` Package\n- Changed the `--proto_path` option of the gRPC command to `--proto-path`\n\n##### `websub` Package\n- Added support for `readonly` parameters in remote methods\n\n#### `websubhub` Package\n- Added support for `readonly` parameters in remote methods\n\n##### `kafka` Package\n- Made the `kafka:Caller` optional in the `onConsumerRecord` method of the `kafka:Service`\n- Allowed the `readonly & kafka:ConsumerRecord[]` parameter type in the `onConsumerRecord` method\n\n### Code to Cloud Updates\n\n#### Improvements\n- Removed `awslambda` and `azure_functions` module support for single `.bal` files\n\n#### Bug Fixes\n\nTo view bug fixes, see the [GitHub milestone for 2201.0.0 (Swan Lake)](https://github.com/ballerina-platform/module-ballerina-c2c/issues?q=is%3Aissue+is%3Aclosed+milestone%3A%22Ballerina+2201.0.0%22+label%3AType%2FBug).\n\n\n### Developer Tools Updates\n\n#### New Features\n\n##### Ballerina Shell\n\n- Added the module auto-import feature to the Ballerina Shell. If the user code contains a module prefix for a module that has not been imported, the Ballerina Shell provides the option to import the module.\n\n\n   For example, see below.\n   ```ballerina\n    =$ io:println(\"Hello World\")\n    |\n    | Found following undefined module(s).\n    | io\n    |\n    | Following undefined modules can be imported.\n    | 1. io\n    Do you want to import mentioned modules (yes/y) (no/n)? y\n    |\n    | Adding import: import ballerina/io\n    | Import added: import ballerina/io\n    \n    Hello World\n    ```\n\n#### Improvements\n\n##### Ballerina OpenAPI Tool\n\n###### OpenAPI Contract Generation\n- Added support for HTTP headers of types `int`, `int[]`, `boolean`, and `boolean[]`\n- Added support for HTTP payloads of type `map<string>`\n- Improved the OAS response header mapping for contexts in which the header details are defined within the return type\n\n###### Ballerina Service Generation\n- Added support for OAS query parameters with nested/optional/nullable types and default values\n- Added support for OAS header parameters with optional/nullable types and default values\n\n##### Ballerina update tool\n- Improved the view for `bal dist list` with the `-a` flag\n- Improved the `bal dist use` command to check for the distribution availability prior to the download suggestion\n\n#### Bug Fixes\n\nTo view bug fixes, see the GitHub milestone for 2201.0.0 (Swan Lake) of the repositories below.\n\n- [Language Server](https://github.com/ballerina-platform/ballerina-lang/issues?q=is%3Aissue+milestone%3A%22Ballerina+2201.0.0%22+is%3Aclosed+label%3ATeam%2FLanguageServer)\n- [update tool](https://github.com/ballerina-platform/ballerina-update-tool/issues?q=is%3Aissue+milestone%3A%22Ballerina+2201.0.0%22+is%3Aclosed+label%3AType%2FBug)\n- [OpenAPI](https://github.com/ballerina-platform/openapi-tools/issues?q=is%3Aissue+label%3AType%2FBug+milestone%3A%22Ballerina+2201.0.0%22+is%3Aclosed)\n\n<!-- <style>.cGitButtonContainer, .cBallerinaTocContainer {display:none;}</style> -->\n","id":"swan-lake-2201.0.0"},"__N_SSG":true}