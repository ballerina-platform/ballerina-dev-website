{"pageProps":{"frontmatter":{"layout":"build-a-change-data-capture-service-left-nav-pages-swanlake","title":"Build a Change Data Capture (CDC) service in Ballerina","description":"Capture and process database changes in real-time using Ballerina CDC connectors.","keywords":"ballerina, cdc, change data capture, database, streaming, API","permalink":"/learn/build-a-change-data-capture-service-in-ballerina/","active":"build-a-change-data-capture-service","intro":"In this guide, you’ll learn how to build a Change Data Capture (CDC) service using Ballerina to implement real-time fraud detection. The service monitors changes to a MySQL database and flags high-value transactions that exceed a defined threshold."},"content":"\n## Prerequisites\n\nTo follow along with this tutorial, ensure you have:\n\n* [Ballerina 2201.12.0 (Swan Lake)](https://ballerina.io/downloads/) or later\n* A text editor  \n\n  > **Tip:** Preferably [Visual Studio Code](https://code.visualstudio.com/) with the [Ballerina extension](https://marketplace.visualstudio.com/items?itemName=WSO2.ballerina)\n* A terminal or command-line interface\n* MySQL 8.0 or later\n\n## Set up a MySQL server instance\n\nYou can use one of the following methods to set up MySQL:\n\n1. **Install MySQL locally** from the [official MySQL site](https://dev.mysql.com/doc/mysql-getting-started/en/#mysql-getting-started-installing)\n2. **Use a server stack** like [XAMPP](https://www.apachefriends.org/) or [WampServer](https://wampserver.aviatechno.net/)\n3. **Run MySQL in Docker** using [these official instructions](https://dev.mysql.com/doc/mysql-installation-excerpt/8.0/en/docker-mysql-getting-started.html)\n4. **Use a cloud-hosted instance** from [Google Cloud SQL](https://cloud.google.com/sql), [Amazon RDS](https://aws.amazon.com/rds/mysql/), or [Azure Database for MySQL](https://azure.microsoft.com/en-us/services/mysql/)\n\n> **Tip:** Keep your MySQL connection details (host, port, username, and password) handy.\n\n## Set up the MySQL database\n\n### Enable CDC in MySQL\n\nCDC relies on [MySQL’s binary logging](https://dev.mysql.com/doc/refman/8.4/en/binary-log.html) feature, which is enabled by default in MySQL 8.0+ unless explicitly disabled.\n\n#### Verify binary logging\n\nRun the following SQL to confirm:\n\n```sql\nSHOW VARIABLES LIKE 'log_bin';\n```\n\nIf `log_bin` is `ON`, you're good to go.\n\n#### Ensure proper CDC settings\n\nAlso, verify the following:\n\n```sql\nSHOW VARIABLES LIKE 'binlog_format';\nSHOW VARIABLES LIKE 'binlog_row_image';\n```\n\nIf needed, update your `my.cnf` or `my.ini` file:\n\n```ini\n[mysqld]\nserver-id=223344\nlog-bin=mysql-bin\nbinlog-format=ROW\nbinlog-row-image=FULL\n```\n\nThen restart MySQL to apply the changes.\n\n### Create necessary tables\n\nLog in to your MySQL server and execute:\n\n```sql\nCREATE DATABASE IF NOT EXISTS finance_db;\nUSE finance_db;\n\nCREATE TABLE transactions (\n    tx_id INT AUTO_INCREMENT PRIMARY KEY,\n    user_id INT,\n    amount DECIMAL(10,2),\n    status VARCHAR(50),\n    created_at DATETIME\n);\n\nINSERT INTO transactions (user_id, amount, status, created_at) VALUES\n(10, 9000.00, 'COMPLETED', '2025-04-01 08:00:00'),\n(11, 12000.00, 'COMPLETED', '2025-04-01 08:10:00'), -- this triggers fraud logic\n(12, 4500.00, 'PENDING', '2025-04-01 08:30:00');\n```\n\n## Create a Ballerina service package\n\nBallerina uses packages to group code. You need to create a Ballerina package and write the business logic.\n\n> **Info:** For more information on Ballerina packages, see [Organize Ballerina code](https://ballerina.io/learn/organize-ballerina-code/).\n\nIn the terminal, run the following to create a new Ballerina package:\n\n```\n$ bal new fraud_detection\n```\n\nThis creates:\n\n```\nfraud_detection/\n├── Ballerina.toml\n└── main.bal\n```\n\n> **Tip:** Delete the auto-generated `main.bal` — we’ll create our own.\n\n## Define the `Transaction` record\n\nIn Ballerina, records represent structured data. Define one that matches the `transactions` table:\n\n```ballerina\ntype Transactions record {|\n    int tx_id;\n    int user_id;\n    float amount;\n    string status;\n    int created_at;\n|};\n```\n\n## Import required modules\n\nAdd the following imports to your Ballerina program:\n\n- `ballerinax/cdc`: Core module that provides APIs to capture and process database change events.\n- `ballerinax/mysql`: Provides MySQL-specific listener and types for CDC.\n- `ballerinax/mysql.cdc.driver as _`: Debezium-based driver for MySQL CDC.\n\n```ballerina\nimport ballerinax/cdc;\nimport ballerinax/mysql;\nimport ballerinax/mysql.cdc.driver as _;\n```\n\n## Add CDC listener and base service\n\nSet up the CDC listener using the [`mysql:CdcListener`](https://central.ballerina.io/ballerinax/mysql/latest#CdcListener) and [`cdc:Service`](https://central.ballerina.io/ballerinax/cdc/latest#Service):\n\n```ballerina\nimport ballerinax/cdc;\nimport ballerinax/mysql;\nimport ballerinax/mysql.cdc.driver as _;\n\nconfigurable string username = ?;\nconfigurable string password = ?;\n\nlistener mysql:CdcListener financeDBListener = new (\n    database = {\n        username,\n        password,\n        includedDatabases: \"finance_db\",\n        includedTables: \"finance_db.transactions\"\n    },\n    options = {\n        snapshotMode: cdc:NO_DATA,\n        skippedOperations: [cdc:TRUNCATE, cdc:UPDATE, cdc:DELETE]\n    }\n);\n```\n\n> **Tip:** Use [Ballerina configurable variables](https://ballerina.io/learn/configure-a-sample-ballerina-service/) to manage credentials securely.\n\n*Define the CDC Service*\n\n```ballerina\nservice cdc:Service on financeDBListener {\n    isolated remote function onCreate(Transactions trx) returns error? {\n        log:printInfo(`Transaction with id: ${trx.tx_id}`);\n        if trx.amount > 10000.0 {\n            log:printWarn(\n                `⚠️ Fraud alert: High-value transaction detected: \n                Id: ${trx.tx_id}, \n                User Id: ${trx.user_id}, \n                Amount: $${trx.amount}`\n            );\n        }\n    }\n\n    isolated remote function onError(cdc:Error e) {\n        log:printError(\"CDC error occurred\", e);\n    }\n}\n```\n\n> **Note:** We're only handling `onCreate` here, but the service can also support `onRead`, `onUpdate`, and `onDelete`.\n\n## The complete code\n\nHere’s the complete `main.bal`:\n\n```ballerina\nimport ballerina/log;\nimport ballerinax/cdc;\nimport ballerinax/mysql;\nimport ballerinax/mysql.cdc.driver as _;\n\nconfigurable string username = ?;\nconfigurable string password = ?;\n\ntype Transactions record {|\n    int tx_id;\n    int user_id;\n    float amount;\n    string status;\n    int created_at;\n|};\n\nlistener mysql:CdcListener financeDBListener = new (\n    database = {\n        username,\n        password,\n        includedDatabases: \"finance_db\",\n        includedTables: \"finance_db.transactions\"\n    },\n    options = {\n        snapshotMode: cdc:NO_DATA,\n        skippedOperations: [cdc:TRUNCATE, cdc:UPDATE, cdc:DELETE]\n    }\n);\n\nservice cdc:Service on financeDBListener {\n    isolated remote function onCreate(Transactions trx) returns error? {\n        log:printInfo(`Transaction with id: ${trx.tx_id}`);\n        if trx.amount > 10000.0 {\n            log:printWarn(\n                `⚠️ Fraud alert: High-value transaction detected: \n                Id: ${trx.tx_id}, \n                User Id: ${trx.user_id}, \n                Amount: $${trx.amount}`\n            );\n        }\n    }\n\n    isolated remote function onError(cdc:Error e) {\n        log:printError(\"CDC error occurred\", e);\n    }\n}\n```\n\n## Run the service\n\n### Add the credentials\n\nIn the package directory, create a new file named `Config.toml` and specify the configurations below to connect to the MySQL database.\n\n```toml\nusername=\"root\"\npassword=\"rootPassword\"\n```\n\n### Execute the `bal run` command\n\n```\n$ bal run\n```\n\nYou should see the listener start up and await changes.\n```\nCompiling source\n        foo/fraud_detection:0.1.0\n\nRunning executable\n```\n\n## Try it out\n\nRun the following SQL to simulate transactions:\n\n```sql\nUSE finance_db;\n\nINSERT INTO transactions (user_id, amount, status, created_at) VALUES\n(11, 2000.00, 'COMPLETED', '2025-04-01 08:10:00');\n\nINSERT INTO transactions (user_id, amount, status, created_at) VALUES\n(11, 12000.00, 'COMPLETED', '2025-04-01 08:10:00');\n```\n\nExpected output:\n\n```\ntime=2025-05-28T22:49:59.231+05:30 level=INFO module=wso2/fraud_detection message=\"Transaction with id: 5\"\ntime=2025-05-28T22:49:59.245+05:30 level=WARN module=wso2/fraud_detection message=\"⚠️ Fraud alert: High-value transaction detected: Id: 5, User Id: 11, Amount: $12000.0\"\n```\n\n## Learn more\n\nTo learn more about CDC service in Ballerina, see the following.\n\n* [CDC module docs](https://central.ballerina.io/ballerinax/cdc/latest)\n* [MySQL CDC Listener](https://central.ballerina.io/ballerinax/mysql/latest#CdcListener)\n* [CDC Examples](https://ballerina.io/learn/by-example/#change-data-capture)\n","id":"build-a-change-data-capture-service-in-ballerina","sub":"featured-scenarios","third":"","slug":"featured-scenarios/build-a-change-data-capture-service-in-ballerina","codes":"[[324597558,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">SHOW VARIABLES </span><span style=\\\"color:#D73A49\\\">LIKE</span><span style=\\\"color:#032F62\\\"> 'log_bin'</span><span style=\\\"color:#24292E\\\">;</span></span></code></pre>\"],[1648848907,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">SHOW VARIABLES </span><span style=\\\"color:#D73A49\\\">LIKE</span><span style=\\\"color:#032F62\\\"> 'binlog_format'</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">SHOW VARIABLES </span><span style=\\\"color:#D73A49\\\">LIKE</span><span style=\\\"color:#032F62\\\"> 'binlog_row_image'</span><span style=\\\"color:#24292E\\\">;</span></span></code></pre>\"],[551879033,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span>[mysqld]</span></span>\\n<span class=\\\"line\\\"><span>server-id=223344</span></span>\\n<span class=\\\"line\\\"><span>log-bin=mysql-bin</span></span>\\n<span class=\\\"line\\\"><span>binlog-format=ROW</span></span>\\n<span class=\\\"line\\\"><span>binlog-row-image=FULL</span></span></code></pre>\"],[468515752,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">CREATE</span><span style=\\\"color:#D73A49\\\"> DATABASE</span><span style=\\\"color:#6F42C1\\\"> IF</span><span style=\\\"color:#D73A49\\\"> NOT</span><span style=\\\"color:#D73A49\\\"> EXISTS</span><span style=\\\"color:#24292E\\\"> finance_db;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">USE</span><span style=\\\"color:#24292E\\\"> finance_db;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">CREATE</span><span style=\\\"color:#D73A49\\\"> TABLE</span><span style=\\\"color:#6F42C1\\\"> transactions</span><span style=\\\"color:#24292E\\\"> (</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    tx_id </span><span style=\\\"color:#D73A49\\\">INT</span><span style=\\\"color:#24292E\\\"> AUTO_INCREMENT </span><span style=\\\"color:#D73A49\\\">PRIMARY KEY</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    user_id </span><span style=\\\"color:#D73A49\\\">INT</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    amount </span><span style=\\\"color:#D73A49\\\">DECIMAL</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#005CC5\\\">10</span><span style=\\\"color:#24292E\\\">,</span><span style=\\\"color:#005CC5\\\">2</span><span style=\\\"color:#24292E\\\">),</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    status</span><span style=\\\"color:#D73A49\\\"> VARCHAR</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#005CC5\\\">50</span><span style=\\\"color:#24292E\\\">),</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    created_at </span><span style=\\\"color:#D73A49\\\">DATETIME</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">INSERT INTO</span><span style=\\\"color:#24292E\\\"> transactions (user_id, amount, </span><span style=\\\"color:#D73A49\\\">status</span><span style=\\\"color:#24292E\\\">, created_at) </span><span style=\\\"color:#D73A49\\\">VALUES</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#005CC5\\\">10</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#005CC5\\\">9000</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">00</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#032F62\\\">'COMPLETED'</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#032F62\\\">'2025-04-01 08:00:00'</span><span style=\\\"color:#24292E\\\">),</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#005CC5\\\">11</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#005CC5\\\">12000</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">00</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#032F62\\\">'COMPLETED'</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#032F62\\\">'2025-04-01 08:10:00'</span><span style=\\\"color:#24292E\\\">), </span><span style=\\\"color:#6A737D\\\">-- this triggers fraud logic</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#005CC5\\\">12</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#005CC5\\\">4500</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">00</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#032F62\\\">'PENDING'</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#032F62\\\">'2025-04-01 08:30:00'</span><span style=\\\"color:#24292E\\\">);</span></span></code></pre>\"],[-1254634845,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> Transactions</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    int</span><span style=\\\"color:#24292E\\\"> tx_id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    int</span><span style=\\\"color:#24292E\\\"> user_id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    float</span><span style=\\\"color:#24292E\\\"> amount;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> status;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    int</span><span style=\\\"color:#24292E\\\"> created_at;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[1231173846,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerinax/cdc;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerinax/mysql;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerinax/mysql.cdc.driver </span><span style=\\\"color:#D73A49\\\">as</span><span style=\\\"color:#24292E\\\"> _;</span></span></code></pre>\"],[-245923791,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerinax/cdc;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerinax/mysql;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerinax/mysql.cdc.driver </span><span style=\\\"color:#D73A49\\\">as</span><span style=\\\"color:#24292E\\\"> _;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">configurable</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> username </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> ?</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">configurable</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> password </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> ?</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">listener</span><span style=\\\"color:#24292E\\\"> mysql</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">CdcListener financeDBListener </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#E36209\\\">    database</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        username,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        password,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        includedDatabases</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#032F62\\\"> \\\"finance_db\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        includedTables</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#032F62\\\"> \\\"finance_db.transactions\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    },</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#E36209\\\">    options</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        snapshotMode</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> cdc:NO_DATA,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        skippedOperations</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> [</span><span style=\\\"color:#6F42C1\\\">cdc</span><span style=\\\"color:#24292E\\\">:TRUNCATE, </span><span style=\\\"color:#6F42C1\\\">cdc</span><span style=\\\"color:#24292E\\\">:UPDATE, </span><span style=\\\"color:#6F42C1\\\">cdc</span><span style=\\\"color:#24292E\\\">:DELETE]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">);</span></span></code></pre>\"],[1858553738,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">service</span><span style=\\\"color:#24292E\\\"> cdc:Service </span><span style=\\\"color:#D73A49\\\">on</span><span style=\\\"color:#24292E\\\"> financeDBListener {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    isolated</span><span style=\\\"color:#D73A49\\\"> remote</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> onCreate</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">Transactions</span><span style=\\\"color:#E36209\\\"> trx</span><span style=\\\"color:#24292E\\\">) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#D73A49\\\"> error?</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        log</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#6F42C1\\\">printInfo</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#032F62\\\">`Transaction with id: ${</span><span style=\\\"color:#24292E\\\">trx</span><span style=\\\"color:#032F62\\\">.</span><span style=\\\"color:#24292E\\\">tx_id</span><span style=\\\"color:#032F62\\\">}`</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        if</span><span style=\\\"color:#24292E\\\"> trx.amount </span><span style=\\\"color:#D73A49\\\">></span><span style=\\\"color:#005CC5\\\"> 10000.0</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            log</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#6F42C1\\\">printWarn</span><span style=\\\"color:#24292E\\\">(</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#032F62\\\">                `⚠️ Fraud alert: High-value transaction detected: </span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#032F62\\\">                Id: ${</span><span style=\\\"color:#24292E\\\">trx</span><span style=\\\"color:#032F62\\\">.</span><span style=\\\"color:#24292E\\\">tx_id</span><span style=\\\"color:#032F62\\\">}, </span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#032F62\\\">                User Id: ${</span><span style=\\\"color:#24292E\\\">trx</span><span style=\\\"color:#032F62\\\">.</span><span style=\\\"color:#24292E\\\">user_id</span><span style=\\\"color:#032F62\\\">}, </span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#032F62\\\">                Amount: $${</span><span style=\\\"color:#24292E\\\">trx</span><span style=\\\"color:#032F62\\\">.</span><span style=\\\"color:#24292E\\\">amount</span><span style=\\\"color:#032F62\\\">}`</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            );</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    isolated</span><span style=\\\"color:#D73A49\\\"> remote</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> onError</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">cdc</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Error e) {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        log</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#6F42C1\\\">printError</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#032F62\\\">\\\"CDC error occurred\\\"</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#E36209\\\">e</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[1418876369,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerina/log;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerinax/cdc;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerinax/mysql;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerinax/mysql.cdc.driver </span><span style=\\\"color:#D73A49\\\">as</span><span style=\\\"color:#24292E\\\"> _;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">configurable</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> username </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> ?</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">configurable</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> password </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> ?</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> Transactions</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    int</span><span style=\\\"color:#24292E\\\"> tx_id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    int</span><span style=\\\"color:#24292E\\\"> user_id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    float</span><span style=\\\"color:#24292E\\\"> amount;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> status;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    int</span><span style=\\\"color:#24292E\\\"> created_at;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">listener</span><span style=\\\"color:#24292E\\\"> mysql</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">CdcListener financeDBListener </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#E36209\\\">    database</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        username,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        password,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        includedDatabases</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#032F62\\\"> \\\"finance_db\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        includedTables</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#032F62\\\"> \\\"finance_db.transactions\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    },</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#E36209\\\">    options</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        snapshotMode</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> cdc:NO_DATA,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        skippedOperations</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> [</span><span style=\\\"color:#6F42C1\\\">cdc</span><span style=\\\"color:#24292E\\\">:TRUNCATE, </span><span style=\\\"color:#6F42C1\\\">cdc</span><span style=\\\"color:#24292E\\\">:UPDATE, </span><span style=\\\"color:#6F42C1\\\">cdc</span><span style=\\\"color:#24292E\\\">:DELETE]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">service</span><span style=\\\"color:#24292E\\\"> cdc:Service </span><span style=\\\"color:#D73A49\\\">on</span><span style=\\\"color:#24292E\\\"> financeDBListener {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    isolated</span><span style=\\\"color:#D73A49\\\"> remote</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> onCreate</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">Transactions</span><span style=\\\"color:#E36209\\\"> trx</span><span style=\\\"color:#24292E\\\">) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#D73A49\\\"> error?</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        log</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#6F42C1\\\">printInfo</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#032F62\\\">`Transaction with id: ${</span><span style=\\\"color:#24292E\\\">trx</span><span style=\\\"color:#032F62\\\">.</span><span style=\\\"color:#24292E\\\">tx_id</span><span style=\\\"color:#032F62\\\">}`</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        if</span><span style=\\\"color:#24292E\\\"> trx.amount </span><span style=\\\"color:#D73A49\\\">></span><span style=\\\"color:#005CC5\\\"> 10000.0</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            log</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#6F42C1\\\">printWarn</span><span style=\\\"color:#24292E\\\">(</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#032F62\\\">                `⚠️ Fraud alert: High-value transaction detected: </span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#032F62\\\">                Id: ${</span><span style=\\\"color:#24292E\\\">trx</span><span style=\\\"color:#032F62\\\">.</span><span style=\\\"color:#24292E\\\">tx_id</span><span style=\\\"color:#032F62\\\">}, </span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#032F62\\\">                User Id: ${</span><span style=\\\"color:#24292E\\\">trx</span><span style=\\\"color:#032F62\\\">.</span><span style=\\\"color:#24292E\\\">user_id</span><span style=\\\"color:#032F62\\\">}, </span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#032F62\\\">                Amount: $${</span><span style=\\\"color:#24292E\\\">trx</span><span style=\\\"color:#032F62\\\">.</span><span style=\\\"color:#24292E\\\">amount</span><span style=\\\"color:#032F62\\\">}`</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            );</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    isolated</span><span style=\\\"color:#D73A49\\\"> remote</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> onError</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">cdc</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Error e) {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        log</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#6F42C1\\\">printError</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#032F62\\\">\\\"CDC error occurred\\\"</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#E36209\\\">e</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[926587392,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">username=</span><span style=\\\"color:#032F62\\\">\\\"root\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">password=</span><span style=\\\"color:#032F62\\\">\\\"rootPassword\\\"</span></span></code></pre>\"],[1479489880,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">USE</span><span style=\\\"color:#24292E\\\"> finance_db;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">INSERT INTO</span><span style=\\\"color:#24292E\\\"> transactions (user_id, amount, </span><span style=\\\"color:#D73A49\\\">status</span><span style=\\\"color:#24292E\\\">, created_at) </span><span style=\\\"color:#D73A49\\\">VALUES</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#005CC5\\\">11</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#005CC5\\\">2000</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">00</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#032F62\\\">'COMPLETED'</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#032F62\\\">'2025-04-01 08:10:00'</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">INSERT INTO</span><span style=\\\"color:#24292E\\\"> transactions (user_id, amount, </span><span style=\\\"color:#D73A49\\\">status</span><span style=\\\"color:#24292E\\\">, created_at) </span><span style=\\\"color:#D73A49\\\">VALUES</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#005CC5\\\">11</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#005CC5\\\">12000</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">00</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#032F62\\\">'COMPLETED'</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#032F62\\\">'2025-04-01 08:10:00'</span><span style=\\\"color:#24292E\\\">);</span></span></code></pre>\"]]"},"__N_SSG":true}