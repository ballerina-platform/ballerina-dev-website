{"pageProps":{"frontmatter":{"layout":"ballerina-persist-documentation-left-nav-pages-swanlake","title":"Type-safe client API","description":"The sections give details on the generated Client API.","keywords":"ballerina, programming language, ballerina packages, persist, type-safe client API","permalink":"/learn/ballerina-persist/persist-client-api/","active":"persist_client_api","intro":"The generated client API is used to perform CRUD operations on the data source. Each entity type will have five resource methods for each operation. The resource methods are get, get(get by identity), post, put, and delete. The CLI tool will generate the derived Entity Types and the Clients from the model definition."},"content":"\n## Derived entity types\n\nBallerina record types used in the generated clients are derived from the entity types defined in the data model.\n\nBelow is an example of a defined entity.\n```ballerina\ntype Workspace record {|\n    readonly string id;\n    string workspaceType;\n    Building location; // 1-n relation (parent)\n    Employee? employees; // 1-1 relation (child)\n|};\n```\n\nThere are six derived entity types as follows\n### `Entity` types\n\nThese are the types defined in the data model. They are used to indicate the data structure in the data source. The entity, which is the association parent will include the foreign key field(s).\n\n```ballerina\npublic type Workspace record {|\n    readonly string id;\n    string workspaceType;\n    string locationCode;\n|};\n```\n\n### `Insert` types\n\nThese are the records used to insert data in the data source. This is the same as the entity type, except when the readonly field has the [`@sql:Generated`](/learn/persist-model/#declare-generated-fields-with-generated-annotation) annotation. When the readonly field has the [`@sql:Generated`](/learn/persist-model/#declare-generated-fields-with-generated-annotation) annotation, the field will be removed from the insert type.\n\n```ballerina\npublic type WorkspaceInsert Workspace;\n```\n\n### `Update` types\n\nThese are the records used to update data in the data source. They are entity types without identity fields. All fields will be optional. Only the fields for which values are provided will be updated.\n\n```ballerina\npublic type WorkspaceUpdate record {|\n    string workspaceType?;\n    string locationCode?;\n|};\n```\n\n### `Optionalized` types\n\nThese are the same as the entity types but all the fields are made optional. This type is not directly used in any operations.\n\n```ballerina\npublic type WorkspaceOptionalized record {|\n    readonly string id?;\n    string workspaceType?;\n    string locationCode?;\n|};\n```\n\n### `With-relations` types\n\nThese types inherit all fields from the corresponding `optionalized` type and add the relation fields as optional. They are not directly used in any operations.\n\n```ballerina\npublic type WorkspaceWithRelations record {|\n    *WorkspaceOptionalized;\n    BuildingOptionalized location?;\n    EmployeeOptionalized employees?;\n|};\n```\n\n### `Target` types\n\nThese types are used to retrieve data from the data source. If the entity contains a relation field, the target type\nwill be a type description of the corresponding `WithRelations` type. Otherwise, the target type will be a\ntype description of the corresponding `optionalized` type.\n\n```ballerina\npublic type WorkspaceTargetType typedesc<WorkspaceWithRelations>;\n```\n\n## Client Object\n\nThe client object is derived for each data model definition file, and it is used to perform CRUD operations on the data source. Each entity type will have five resource methods for each operation. The resource methods are `get`, `get(get by identity)`, `post`, `put`, and `delete`. In addition, there are two `remote` functions to perform native SQL query and execute.\n\nThe skeleton of the client object is as follows.\n\n```ballerina\npublic client class Client {\n    *persist:AbstractPersistClient;\n\n    public function init() returns persist:Error? {\n    }\n\n    isolated resource function get workspaces(WorkspaceTargetType targetType = <>) returns stream<targetType, Error?> {\n    };\n\n    isolated resource function get workspaces/[string id](WorkspaceTargetType targetType = <>) returns targetType|Error {\n    };\n\n    isolated resource function post workspaces(WorkspaceInsert[] data) returns string[]|persist:Error {\n    };\n\n    isolated resource function put workspaces/[string id](WorkspaceUpdate data) returns Workspace|persist:Error {\n    };\n\n    isolated resource function delete workspaces/[string id]() returns Workspace|persist:Error {\n    };\n    \n    remote isolated function queryNativeSQL(sql:ParameterizedQuery sqlQuery, typedesc<record {}> rowType = <>) returns stream<rowType, persist:Error?> {\n    };\n\n    remote isolated function executeNativeSQL(sql:ParameterizedQuery sqlQuery) returns psql:ExecutionResult|persist:Error {\n    };\n\n    public function close() returns persist:Error? {\n    }\n}\n```\n\nThe conventions used in deriving the client object is as follows.\n1. Since there can be only one generated client in a Ballerina package, the client name is always `Client`.\n2. The client should be of the `persist:AbstractPersistClient` type.\n3. It should contain the `init()` and `close()` functions.\n4. It should contain five resource methods (i.e., `get`, `get(get by identity)`, `post`, `put`, and `delete` for each entity type defined in the data model and two remote functions to perform native queries directly.\n5. Resource names should be in the plural form of the entity names in lowercase.\n6. The resource method should return the derived entity types.\n7. Resource methods with path parameters will support composite identity fields by having multiple path parameters.\n\n### Client usage\n\n#### Client initialization\n\nThe `init()` function is used to initialize the client. The client will be initialized with the data source configuration provided in the `Config.toml` file. The `init()` function will return an error if the client initialization fails.\n\nYou can initialize the client as follows.\n\n```ballerina\nClient sClient = check new();\n```\n\n#### CRUD operations\n\nYou can perform CRUD operations on the `Workspace` table in the data store using the client object as follows.\n\n```ballerina\n// Create a new workspace record.\nWorkspaceInsert workspace = {id: \"WK001\", workspaceType: \"Host Desk\", locationCode: \"B001\"};\nstring[]|error workspaceId = sClient->/workspaces.post([workspace]);\n\n// Get the workspace record with the ID: `WK001`.\nWorkspace|error workspace = sClient->/workspaces/WK001;\n\n// Update the workspace record with the ID: `WK001`.\nWorkspace|error updated = sClient->/workspaces/WK001.put({workspaceType: \"Cubical\"});\n\n// Delete the workspace record with the ID: `WK001`.\nWorkspace|error deleted = sClient->/workspaces/WK001.delete();\n\n// Get all the workspace records.\nstream<Workspace, error?> workspaces = sClient->/workspaces;\n```\n\n#### Relation operations\n\nYou can perform relation operations on the `Workspace` table in the data store using the client object as follows.\n\nLet's extend the `Workspace` entity type with a relation field `employees` as follows.\n\n```ballerina\ntype Workspace record {|\n    readonly string id;\n    string workspaceType;\n    Building location; // 1-n relation (parent)\n    Employee? employees; // 1-1 relation (child)\n|};\n\ntype Employee record {|\n    readonly string id;\n    string firstName;\n    string lastName;\n    string email;\n    float salary;\n    Workspace workspace; // 1-1 relation (parent)\n|};\n\ntype Building record {|\n    readonly string code;\n    string name;\n    string address;\n    Workspace[] workspaces; // 1-n relation (child)\n|};\n```\n\nYou can retrieve Workspace records with the related `Employee` record by using a custom target type as follows. This is equivalent to an SQL `join` operation between the `Workspace` and `Employee` tables.\n\n```ballerina\n// Get the workspace record with the ID `WK001` with the related employee record.\nWorkspaceWithEmployee|error workspace = sClient->/workspaces/WK001.get();\n\n// `WorkspaceWithEmployee` is a record with the following fields.\ntype WorkspaceWithEmployee record {|\n    readonly string id;\n    string workspaceType;\n    string locationCode\n    Employee employees; // 1-1 relation (child)\n|};\n```\n\nThis is the same as writing the following SQL query to retrieve data from a relational database,\n\n```sql\nSELECT * \nFROM workspace w\nINNER JOIN employee e ON w.id = e.workspaceId\nWHERE w.workspaceId = 'WK001';\n```\n\nThe persisted client will automatically perform the `join` operation and return the result.\n\n#### Projection operations\n\nYou can retrieve the `Workspace` records with the related `Employee` record and the related `Building` record by using a custom target type. When specifying the target type, you can specify the target type with a subset of fields of the entity types as follows.\n\nThis is equivalent to an SQL `join` operation between the `Workspace`, `Employee`, and `Building` tables, and also an SQL `projection` operation.\n\n```ballerina\n// Get the `workspace` record with the ID `WK001` with the related `employee` record and the related `building` record.\n\nWorkspaceWithRelations|error workspace = sClient->/workspaces/WK001.get();\n\n// `WorkspaceWithRelations` is a record with the following fields.\ntype WorkspaceWithRelations record {|\n    string workspaceType;\n    record {|\n        string firstName;\n        string lastName;\n    |} employees; // 1-1 relation (child)\n    record {|\n        string name;\n        string address;\n    |} location; // 1-n relation (parent)\n|};\n```\n\nThis is the same as writing the following SQL query to retrieve data from a relational database.\n\n```sql\nSELECT w.workspaceType, e.firstName, e.lastName, b.name, b.address\nFROM workspace w\nINNER JOIN employee e ON w.id = e.workspaceId\nINNER JOIN building b ON w.locationCode = b.code\nWHERE w.workspaceId = 'WK001';\n```\n\nThe client will automatically perform the `join` and `projection` operations on the data source and return the result.\n\n## Learn more\n\nFor more information on the client API usage, see the [`bal persist` examples](https://ballerina.io/learn/by-example/persist-get-all/).\n","id":"persist-client-api","sub":"ballerina-persist","third":"","slug":"ballerina-persist/persist-client-api","codes":"[[-661932771,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> Workspace</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    readonly</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> workspaceType;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Building location; </span><span style=\\\"color:#6A737D\\\">// 1-n relation (parent)</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Employee</span><span style=\\\"color:#D73A49\\\">?</span><span style=\\\"color:#24292E\\\"> employees; </span><span style=\\\"color:#6A737D\\\">// 1-1 relation (child)</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[-1832102120,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> type</span><span style=\\\"color:#6F42C1\\\"> Workspace</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    readonly</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> workspaceType;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> locationCode;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[1743783207,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> type</span><span style=\\\"color:#6F42C1\\\"> WorkspaceInsert</span><span style=\\\"color:#24292E\\\"> Workspace;</span></span></code></pre>\"],[1161585018,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> type</span><span style=\\\"color:#6F42C1\\\"> WorkspaceUpdate</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> workspaceType?;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> locationCode?;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[-677166419,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> type</span><span style=\\\"color:#6F42C1\\\"> WorkspaceOptionalized</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    readonly</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> id?;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> workspaceType?;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> locationCode?;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[1913184517,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> type</span><span style=\\\"color:#6F42C1\\\"> WorkspaceWithRelations</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    *</span><span style=\\\"color:#24292E\\\">WorkspaceOptionalized;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    BuildingOptionalized location</span><span style=\\\"color:#D73A49\\\">?</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    EmployeeOptionalized employees</span><span style=\\\"color:#D73A49\\\">?</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[119073339,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> type</span><span style=\\\"color:#6F42C1\\\"> WorkspaceTargetType</span><span style=\\\"color:#D73A49\\\"> typedesc&#x3C;</span><span style=\\\"color:#24292E\\\">WorkspaceWithRelations</span><span style=\\\"color:#D73A49\\\">></span><span style=\\\"color:#24292E\\\">;</span></span></code></pre>\"],[1897591674,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> client class</span><span style=\\\"color:#6F42C1\\\"> Client</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    *</span><span style=\\\"color:#24292E\\\">persist</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">AbstractPersistClient;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    public</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> init</span><span style=\\\"color:#24292E\\\">() </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> persist</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Error? {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    isolated</span><span style=\\\"color:#D73A49\\\"> resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> get</span><span style=\\\"color:#6F42C1\\\"> workspaces</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">WorkspaceTargetType</span><span style=\\\"color:#E36209\\\"> targetType</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#D73A49\\\"> &#x3C;></span><span style=\\\"color:#24292E\\\">) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#D73A49\\\"> stream&#x3C;</span><span style=\\\"color:#24292E\\\">targetType, Error</span><span style=\\\"color:#D73A49\\\">?></span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    };</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    isolated</span><span style=\\\"color:#D73A49\\\"> resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> get</span><span style=\\\"color:#6F42C1\\\"> workspaces</span><span style=\\\"color:#24292E\\\">/[</span><span style=\\\"color:#005CC5\\\">string</span><span style=\\\"color:#E36209\\\"> id</span><span style=\\\"color:#24292E\\\">](</span><span style=\\\"color:#E36209\\\">WorkspaceTargetType</span><span style=\\\"color:#E36209\\\"> targetType</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#D73A49\\\"> &#x3C;></span><span style=\\\"color:#24292E\\\">) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> targetType</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">Error {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    };</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    isolated</span><span style=\\\"color:#D73A49\\\"> resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> post</span><span style=\\\"color:#6F42C1\\\"> workspaces</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">WorkspaceInsert</span><span style=\\\"color:#24292E\\\">[] </span><span style=\\\"color:#E36209\\\">data</span><span style=\\\"color:#24292E\\\">) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\">[]</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">persist</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Error {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    };</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    isolated</span><span style=\\\"color:#D73A49\\\"> resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> put</span><span style=\\\"color:#6F42C1\\\"> workspaces</span><span style=\\\"color:#24292E\\\">/[</span><span style=\\\"color:#005CC5\\\">string</span><span style=\\\"color:#E36209\\\"> id</span><span style=\\\"color:#24292E\\\">](</span><span style=\\\"color:#E36209\\\">WorkspaceUpdate</span><span style=\\\"color:#E36209\\\"> data</span><span style=\\\"color:#24292E\\\">) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> Workspace</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">persist</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Error {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    };</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    isolated</span><span style=\\\"color:#D73A49\\\"> resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> delete</span><span style=\\\"color:#6F42C1\\\"> workspaces</span><span style=\\\"color:#24292E\\\">/[</span><span style=\\\"color:#005CC5\\\">string</span><span style=\\\"color:#E36209\\\"> id</span><span style=\\\"color:#24292E\\\">]() </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> Workspace</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">persist</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Error {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    };</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    </span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    remote</span><span style=\\\"color:#D73A49\\\"> isolated</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> queryNativeSQL</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">sql</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">ParameterizedQuery sqlQuery, </span><span style=\\\"color:#E36209\\\">typedesc</span><span style=\\\"color:#D73A49\\\">&#x3C;record</span><span style=\\\"color:#24292E\\\"> {}</span><span style=\\\"color:#D73A49\\\">></span><span style=\\\"color:#E36209\\\"> rowType</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#D73A49\\\"> &#x3C;></span><span style=\\\"color:#24292E\\\">) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#D73A49\\\"> stream&#x3C;</span><span style=\\\"color:#24292E\\\">rowType, persist</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Error?</span><span style=\\\"color:#D73A49\\\">></span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    };</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    remote</span><span style=\\\"color:#D73A49\\\"> isolated</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> executeNativeSQL</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">sql</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">ParameterizedQuery sqlQuery) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> psql</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">ExecutionResult</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">persist:Error {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    };</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    public</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> close</span><span style=\\\"color:#24292E\\\">() </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> persist</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Error? {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[-138818324,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">Client sClient </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> check</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\">();</span></span></code></pre>\"],[-1624017161,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">// Create a new workspace record.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">WorkspaceInsert workspace </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> {id</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#032F62\\\"> \\\"WK001\\\"</span><span style=\\\"color:#24292E\\\">, workspaceType</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#032F62\\\"> \\\"Host Desk\\\"</span><span style=\\\"color:#24292E\\\">, locationCode</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#032F62\\\"> \\\"B001\\\"</span><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">string</span><span style=\\\"color:#24292E\\\">[]</span><span style=\\\"color:#D73A49\\\">|error</span><span style=\\\"color:#24292E\\\"> workspaceId </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> sClient</span><span style=\\\"color:#D73A49\\\">->/</span><span style=\\\"color:#24292E\\\">workspaces.</span><span style=\\\"color:#6F42C1\\\">post</span><span style=\\\"color:#24292E\\\">([workspace]);</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">// Get the workspace record with the ID: `WK001`.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">Workspace</span><span style=\\\"color:#D73A49\\\">|error</span><span style=\\\"color:#24292E\\\"> workspace </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> sClient</span><span style=\\\"color:#D73A49\\\">->/</span><span style=\\\"color:#24292E\\\">workspaces</span><span style=\\\"color:#D73A49\\\">/</span><span style=\\\"color:#24292E\\\">WK001;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">// Update the workspace record with the ID: `WK001`.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">Workspace</span><span style=\\\"color:#D73A49\\\">|error</span><span style=\\\"color:#24292E\\\"> updated </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> sClient</span><span style=\\\"color:#D73A49\\\">->/</span><span style=\\\"color:#24292E\\\">workspaces</span><span style=\\\"color:#D73A49\\\">/</span><span style=\\\"color:#24292E\\\">WK001.</span><span style=\\\"color:#6F42C1\\\">put</span><span style=\\\"color:#24292E\\\">({workspaceType</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#032F62\\\"> \\\"Cubical\\\"</span><span style=\\\"color:#24292E\\\">});</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">// Delete the workspace record with the ID: `WK001`.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">Workspace</span><span style=\\\"color:#D73A49\\\">|error</span><span style=\\\"color:#24292E\\\"> deleted </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> sClient</span><span style=\\\"color:#D73A49\\\">->/</span><span style=\\\"color:#24292E\\\">workspaces</span><span style=\\\"color:#D73A49\\\">/</span><span style=\\\"color:#24292E\\\">WK001.</span><span style=\\\"color:#6F42C1\\\">delete</span><span style=\\\"color:#24292E\\\">();</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">// Get all the workspace records.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">stream&#x3C;</span><span style=\\\"color:#24292E\\\">Workspace, </span><span style=\\\"color:#D73A49\\\">error?></span><span style=\\\"color:#24292E\\\"> workspaces </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> sClient</span><span style=\\\"color:#D73A49\\\">->/</span><span style=\\\"color:#24292E\\\">workspaces;</span></span></code></pre>\"],[-2025978845,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> Workspace</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    readonly</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> workspaceType;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Building location; </span><span style=\\\"color:#6A737D\\\">// 1-n relation (parent)</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Employee</span><span style=\\\"color:#D73A49\\\">?</span><span style=\\\"color:#24292E\\\"> employees; </span><span style=\\\"color:#6A737D\\\">// 1-1 relation (child)</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> Employee</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    readonly</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> firstName;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> lastName;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> email;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    float</span><span style=\\\"color:#24292E\\\"> salary;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Workspace workspace; </span><span style=\\\"color:#6A737D\\\">// 1-1 relation (parent)</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> Building</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    readonly</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> code;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> name;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> address;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Workspace[] workspaces; </span><span style=\\\"color:#6A737D\\\">// 1-n relation (child)</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[401697644,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">// Get the workspace record with the ID `WK001` with the related employee record.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">WorkspaceWithEmployee</span><span style=\\\"color:#D73A49\\\">|error</span><span style=\\\"color:#24292E\\\"> workspace </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> sClient</span><span style=\\\"color:#D73A49\\\">->/</span><span style=\\\"color:#24292E\\\">workspaces</span><span style=\\\"color:#D73A49\\\">/</span><span style=\\\"color:#24292E\\\">WK001.</span><span style=\\\"color:#6F42C1\\\">get</span><span style=\\\"color:#24292E\\\">();</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">// `WorkspaceWithEmployee` is a record with the following fields.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> WorkspaceWithEmployee</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    readonly</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> workspaceType;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> locationCode</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Employee employees; </span><span style=\\\"color:#6A737D\\\">// 1-1 relation (child)</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[52764881,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">SELECT</span><span style=\\\"color:#D73A49\\\"> *</span><span style=\\\"color:#24292E\\\"> </span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">FROM</span><span style=\\\"color:#24292E\\\"> workspace w</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">INNER JOIN</span><span style=\\\"color:#24292E\\\"> employee e </span><span style=\\\"color:#D73A49\\\">ON</span><span style=\\\"color:#005CC5\\\"> w</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">id</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#005CC5\\\"> e</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">workspaceId</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">WHERE</span><span style=\\\"color:#005CC5\\\"> w</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">workspaceId</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#032F62\\\"> 'WK001'</span><span style=\\\"color:#24292E\\\">;</span></span></code></pre>\"],[-1206323533,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">// Get the `workspace` record with the ID `WK001` with the related `employee` record and the related `building` record.</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">WorkspaceWithRelations</span><span style=\\\"color:#D73A49\\\">|error</span><span style=\\\"color:#24292E\\\"> workspace </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> sClient</span><span style=\\\"color:#D73A49\\\">->/</span><span style=\\\"color:#24292E\\\">workspaces</span><span style=\\\"color:#D73A49\\\">/</span><span style=\\\"color:#24292E\\\">WK001.</span><span style=\\\"color:#6F42C1\\\">get</span><span style=\\\"color:#24292E\\\">();</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">// `WorkspaceWithRelations` is a record with the following fields.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> WorkspaceWithRelations</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> workspaceType;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        string</span><span style=\\\"color:#24292E\\\"> firstName;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        string</span><span style=\\\"color:#24292E\\\"> lastName;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    |</span><span style=\\\"color:#24292E\\\">} employees; </span><span style=\\\"color:#6A737D\\\">// 1-1 relation (child)</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        string</span><span style=\\\"color:#24292E\\\"> name;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        string</span><span style=\\\"color:#24292E\\\"> address;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    |</span><span style=\\\"color:#24292E\\\">} location; </span><span style=\\\"color:#6A737D\\\">// 1-n relation (parent)</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[-1887548072,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">SELECT</span><span style=\\\"color:#005CC5\\\"> w</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">workspaceType</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#005CC5\\\">e</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">firstName</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#005CC5\\\">e</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">lastName</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#005CC5\\\">b</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">name</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#005CC5\\\">b</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">address</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">FROM</span><span style=\\\"color:#24292E\\\"> workspace w</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">INNER JOIN</span><span style=\\\"color:#24292E\\\"> employee e </span><span style=\\\"color:#D73A49\\\">ON</span><span style=\\\"color:#005CC5\\\"> w</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">id</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#005CC5\\\"> e</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">workspaceId</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">INNER JOIN</span><span style=\\\"color:#24292E\\\"> building b </span><span style=\\\"color:#D73A49\\\">ON</span><span style=\\\"color:#005CC5\\\"> w</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">locationCode</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#005CC5\\\"> b</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">code</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">WHERE</span><span style=\\\"color:#005CC5\\\"> w</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#005CC5\\\">workspaceId</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#032F62\\\"> 'WK001'</span><span style=\\\"color:#24292E\\\">;</span></span></code></pre>\"]]"},"__N_SSG":true}