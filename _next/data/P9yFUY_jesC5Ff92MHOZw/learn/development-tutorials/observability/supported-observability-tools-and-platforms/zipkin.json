{"pageProps":{"frontmatter":{"title":"Observe tracing using Zipkin","description":"See how Ballerina supports observability by exposing itself via tracing to Zipkin.","keywords":"ballerina, observability, tracing, zipkin","permalink":"/learn/supported-observability-tools-and-platforms/zipkin/","active":"zipkin","intro":"Users can configure Ballerina to support distributed tracing with [Zipkin](https://zipkin.io/), which is one of the open-source and distributed tracing platforms that helps troubleshoot latency problems in service architectures. Ballerina provides tracing data in OpenTelemetry format."},"content":"\nThe sample [shop service](/learn/overview-of-ballerina-observability/#example-observe-a-ballerina-service) will be used in this guide. Follow the steps given below to observe Ballerina tracing in Zipkin.\n\n## Step 1 - Set up Zipkin\n\nYou can configure Ballerina to support distributed tracing with Zipkin. This section focuses on configuring Zipkin with Docker as a quick installation.\n\n>**Tip:** There are many possible ways to deploy Zipkin. For more information, see <a href=\"https://zipkin.io/pages/quickstart\" target=\"_blank\">Zipkin Quickstart</a>.\n\nInstall Zipkin via Docker and start the Docker container by executing the command below.\n\n```\n$ docker run -d -p 9411:9411 openzipkin/zipkin\n```\n\n## Step 2 - Import Ballerina Zipkin extension\n\nTo include the Zipkin extension into the executable, the `ballerinax/zipkin` module needs to be imported into your Ballerina project `main.bal` file.\n\n```ballerina\nimport ballerinax/zipkin as _;\n```\n\nZipkin extension has a `Zipkin Span Exporter` which will push tracing data as batches to the Zipkin server endpoint (default - http://localhost:9411) in Zipkin format.\n\n## Step 3 - Configure Ballerina runtime configurations\n\nTracing can be enabled in your Ballerina project using configurations similar to the following in your `Config.toml` file.\n\n```toml\n[ballerina.observe]\ntracingEnabled=true\ntracingProvider=\"zipkin\"\n\n[ballerinax.zipkin]\nagentHostname=\"localhost\"\nagentPort=9411\nsamplerType=\"const\"\nsamplerParam=1.0\nreporterFlushInterval=1000\nreporterBufferSize=10000\n```\n\nThe table below provides the descriptions of each configuration option and possible values that can be assigned.\n\nConfiguration key | Description | Default value | Possible values \n--- | --- | --- | --- \nballerinax.zipkin. agentHostname | Hostname of the Zipkin agent | localhost | IP or hostname of the Zipkin agent. If it is running on the same node as Ballerina, it can be localhost. \nballerinax.zipkin. agentPort | Port of the Zipkin agent | 4317 | The port on which the Zipkin agent is listening.\nballerinax.zipkin. samplerType | Type of the sampling methods used in the Zipkin tracer. | const | `const`, `probabilistic`, or `ratelimiting`.\nballerinax.zipkin. samplerParam | It is a floating value. Based on the sampler type, the effect of the sampler param varies | 1.0 | For `const` `0` (no sampling) or `1` (sample all spans), for `probabilistic` `0.0` to `1.0`, for `ratelimiting` any positive integer (rate per second).\nballerinax.zipkin. reporterFlushInterval | The Zipkin client will be sending the spans to the agent at this interval. | 2000 | Any positive integer value.\nballerinax.zipkin. reporterBufferSize | Queue size of the Zipkin client. | 2000 | Any positive integer value.\n\n## Step 4 - Run the Ballerina service\n\nWhen Ballerina observability is enabled, the Ballerina runtime collects tracing data and traces will be published to Zipkin.\n\nRun the following command to start the Ballerina service.\n\n```\n$ bal run\n\nCompiling source\n\nRunning executable\n\nballerina: started publishing traces to Zipkin on http://localhost:9411\n```\n\n## Step 5 - Send requests\n \nSend requests to <http://localhost:8090/shop/products>.\n\nExample cURL commands:\n\n```\n$ curl -X GET http://localhost:8090/shop/products\n```\n```\n$ curl -X POST http://localhost:8090/shop/product \\\n-H \"Content-Type: application/json\" \\\n-d '{\n    \"id\": 4, \n    \"name\": \"Laptop Charger\", \n    \"price\": 50.00\n}'\n```\n```\n$ curl -X POST http://localhost:8090/shop/order \\\n-H \"Content-Type: application/json\" \\\n-d '{\n    \"productId\": 1, \n    \"quantity\": 1\n}'\n```\n```\n$ curl -X GET http://localhost:8090/shop/order/0\n```\n\n## Step 6 - View distributed tracing on the Zipkin server\n\nGo to <http://localhost:9411> and load the web UI of Zipkin to make sure it is functioning properly. You can select the service for which you need tracing information find traces.\n\nThe image below is the sample tracing information you can see in Zipkin.\n    \n![Zipkin tracing Dashboard](/learn/images/zipkin-tracing-dashboard.png \"Zipkin tracing Dashboard\")\n","id":"zipkin","sub":"observability","third":"supported-observability-tools-and-platforms","slug":"observability/supported-observability-tools-and-platforms/zipkin","codes":"[[1108646213,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerinax/zipkin </span><span style=\\\"color:#D73A49\\\">as</span><span style=\\\"color:#24292E\\\"> _;</span></span></code></pre>\"],[1752049227,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">ballerina</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">observe</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">tracingEnabled=</span><span style=\\\"color:#005CC5\\\">true</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">tracingProvider=</span><span style=\\\"color:#032F62\\\">\\\"zipkin\\\"</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">ballerinax</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">zipkin</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">agentHostname=</span><span style=\\\"color:#032F62\\\">\\\"localhost\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">agentPort=</span><span style=\\\"color:#005CC5\\\">9411</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">samplerType=</span><span style=\\\"color:#032F62\\\">\\\"const\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">samplerParam=</span><span style=\\\"color:#005CC5\\\">1.0</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">reporterFlushInterval=</span><span style=\\\"color:#005CC5\\\">1000</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">reporterBufferSize=</span><span style=\\\"color:#005CC5\\\">10000</span></span></code></pre>\"]]"},"__N_SSG":true}