{"pageProps":{"frontmatter":{"layout":"ballerina-cloud-left-nav-pages-swanlake","title":"Containerized deployment","description":"Ballerina Code to Cloud module is designed to allow developers to write code without thinking about the deployment platform. This module generates Kubernetes and Docker artifacts directly from your Ballerina code, enabling developers to focus on business logic.","keywords":"ballerina, programming language, services, cloud, kubernetes, docker","active":"ballerina-deployment-guideLines","intro":"Ballerina Code to Cloud is designed to allow developers to write code without thinking about the deployment platform. This module generates Kubernetes artifacts directly from your Ballerina code, enabling developers to focus on business logic."},"content":"\nThis greatly simplifies the experience of developing and deploying Ballerina code in the cloud. It also enables using cloud-native technologies easily without in-depth knowledge.\n\nAs of now, Ballerina Code to Cloud supports generating the deployment artifacts of the platforms below.\n\n1. Docker\n2. Kubernetes\n\n## Set up the prerequisites\n\nTo complete this tutorial, you need:\n1. <a href=\"https://www.docker.com/\" target=\"_blank\">Docker</a> installed and configured in your machine\n2. <a href=\"https://kubernetes.io/docs/tasks/tools/\" target=\"_blank\">Kubectl</a> installed and configured in a <a href=\"https://minikube.sigs.k8s.io/docs/start/\" target=\"_blank\">Kubernetes cluster</a>\n\n>**Note:** macOS users with Apple Silicon chips need to set an environment variable named `DOCKER_DEFAULT_PLATFORM` to `linux/amd64`, before building the image. This is because the Ballerina Docker image is not supported on Apple Silicon chips yet.\n>\n> ```\n> export DOCKER_DEFAULT_PLATFORM=linux/amd64\n> ```\n\n## How Code to Cloud works\n\nCode to cloud builds the containers and required artifacts by deriving the required values from the code. This process happens when the package is being compiled. To override the default values given by the compiler, the `Cloud.toml` file needs to be created in the package directory.\n\n## Package layout\n\nBallerina encourages having one microservice per package. To adhere to that rule, Code to Cloud generates only one container per package. These artifacts can be found in the `target` directory of the package. A complete representation of the package layout is as follows.\n\n```\n├── Cloud.toml                               \n├── Ballerina.lock\n├── Ballerina.toml\n├── Config.toml\n├── entry.bal                          \n└── target\n    ├── bala\n    │   └── module-0.0.1.bala\n    ├── bin\n    │   └── <module>.jar\n    ├── docker\n    │       └── Dockerfile                        \n    └── kubernetes\n            └── <module>-0.0.1.yaml \n```\n\n***Cloud.toml***\n\nThe configuration file is used to override the default values generated by Code to Cloud.\n\n>**Note:** The `Cloud.toml` file is completely optional and you only have to specify the values you need to override. If the value is not specified for a certain field, the compiler will take the default value. All the supported properties can be found in the <a href=\"https://github.com/ballerina-platform/ballerina-spec/blob/master/c2c/code-to-cloud-spec.md\" target=\"_blank\">Code to Cloud specification</a>.\n\n***Ballerina.toml***\n\nContains metadata about the Ballerina package. This file is used to fetch defaults for deployment artifacts generation.\n>**Note:** The `Ballerina.toml` file can be used to specify the build option.\n```toml\n[build-options]\n# cloud = \"docker\"\ncloud = \"k8s\" \n```\n\n***Config.toml***\n\nContains the values, which need to be passed into the configurable variables. To learn more about this, see [Configure a sample Ballerina service](https://ballerina.io/learn/configure-a-sample-ballerina-service/). When you are using the cloud-related features in Ballerina, the `Config.toml` file is not being packed with the container image as it can contain sensitive information. You need to explicitly provide this file in the runtime.\n\n***entry.bal***\n\nRepresents any `.bal` file that has an entry point. The compiler will be using this file to retrieve service-related information for the deployment artifacts.\n\n***target/docker/***\n\nContains the Docker artifacts generated by Code to Cloud. These artifacts will be required to build the Docker image.\n\n***target/kubernetes/***\n\nContains the Kubernetes artifacts generated by Code to Cloud. These artifacts will be required to deploy the Ballerina application in Kubernetes.\n\n## Docker deployment\n\n### Create the Ballerina package\n\n1. Execute the `bal new hello_docker` command to create a new package named `hello_docker`.\n\n2. Replace the content of the `./hello_docker/main.bal` file with the content below.\n\n   >**Note:** The source is completely focused on the business logic.\n\n   ***main.bal***\n\n    ```ballerina\n    import ballerina/http;\n\n    listener http:Listener helloEP = new (9090);\n\n    configurable string name = ?;\n\n    service /helloWorld on helloEP {\n        resource function get sayHello() returns string {   \n            return string `Hello, ${name}!`;\n        }\n    }\n    ```\n3. Add `cloud = \"docker\"` under the `[build-options]` table into the `Ballerina.toml` file in the package.\n\n   ***Ballerina.toml***\n\n    ```toml\n    [build-options]\n    cloud = \"docker\"\n    ```\n\n4. Create a file named `Cloud.toml` in the package directory and add the content below.\n\n   ***Cloud.toml***\n\n    ```toml\n    [container.image]\n    repository=\"wso2inc\" # Docker hub name\n    name=\"hello\" # container name\n    tag=\"v0.1.0\"\n\n    [settings]\n    buildImage=true # you can make this false if you don't want to build the image and you just need the Dockerfile\n    ```\n5. Create the `Config.toml` file in the package directory or anywhere else and paste the following content.\n\n   ***Config.toml***\n\n    ```toml\n    name = \"Docker\"\n    ```\n\n### Generate the artifacts\n\nExecute the `bal build` command to build the Ballerina package and view the output below. If you haven't added the cloud option to `Ballerina.toml` file, you can execute `bal build --cloud=docker` to generate the artifacts and build the package by providing the build option inline.\n\n```\n$ bal build\nCompiling source\n        wso2/hello_docker:0.1.0\n\nGenerating executable\n\nGenerating artifacts...\n\n        @kubernetes:Docker                       - complete 2/2 \n\n        Execute the below command to run the generated docker image: \n        docker run -d -p 9090:9090 wso2inc/hello:v0.1.0\n\n        target/bin/hello_docker.jar\n```\n\nBefore invoking the container, let’s observe the Dockerfile below that has been generated. This is a Dockerfile created by the compiler extension from your code to run your HTTP service in the Docker environment easily.\n\n***target/docker/hello/Dockerfile***\n\n```\n# Auto Generated Dockerfile\nFROM ballerina/jvm-runtime:1.0\n\nLABEL maintainer=\"dev@ballerina.io\"\n\nCOPY ballerina-http-2.2.0.jar /home/ballerina/jars/ \nCOPY ballerina-io-1.2.0.jar /home/ballerina/jars/ \nCOPY wso2-hello_docker-0.1.0.jar /home/ballerina/jars/ \n...\n\nRUN addgroup troupe \\\n    && adduser -S -s /bin/bash -g 'ballerina' -G troupe -D ballerina \\\n    && apk add --update --no-cache bash \\\n    && chown -R ballerina:troupe /usr/bin/java \\\n    && rm -rf /var/cache/apk/*\n\nWORKDIR /home/ballerina\nCOPY wso2-hello_docker-0.1.0.jar /home/ballerina\n\nEXPOSE  9090\nUSER ballerina\n\nCMD java -Xdiag -cp \"anjana-http2_test-0.1.0.jar:jars/*\" 'anjana/http2_test/0/$_init'\n```\n\n### Execute the Docker image\n\nFollow the steps below to execute the Docker image separately.\n\n1. Execute the `docker images` command to verify if the Docker image is generated.\n\n    ```\n    $ docker images\n    REPOSITORY                    TAG                 IMAGE ID            CREATED              SIZE\n    wso2inc/hello                 v0.1.0              60d95f0928b2        About a minute ago   228MB\n    ```\n\n2. Execute the `docker run -d -v <path/to/config>/Config.toml:/home/ballerina/Config.toml -p 9090:9090 wso2inc/hello:v0.1.0` command to run the generated Docker image.\n\n>**Info:** Make sure to set the correct path of the created `Config.toml`. Using volume mount is one way of providing the `Config.toml` file into the runtime. For other ways of providing configurable values, see the [Ballerina specification](https://github.com/ballerina-platform/ballerina-spec/blob/master/configurable/spec.md#locating-toml-files).\n\n  ```\n  $ docker run -d -v /home/wso2/c2c-guide/hello_docker/Config.toml:/home/ballerina/Config.toml -p 9090:9090 wso2inc/hello:v0.1.0\n  c04194eb0b4d0d78cbc8ca55e0527d381d8ab4a1a68f8ea5dd3770a0845d5fbb\n  ```\n\n3. Execute the `curl http://localhost:9090/helloWorld/sayHello` command to access the service.\n\n  ```\n  $ curl http://localhost:9090/helloWorld/sayHello\n  Hello, Docker!\n  ```\n\n## Kubernetes deployment\n\n### Create the Ballerina package\nBelow sample describes a Ballerina application that reads a greeting string from a config map and greets the user upon HTTP request. By following the steps below, you can make a Kubernetes deployment that has container resource limits, horizontal pod autoscaling, config maps and liveness, readiness probes with the help of Code to Cloud.\n\n1. Execute the `bal new hello_k8s` command to create a new package named `hello_k8s` and go inside that directory.\n\n2. Replace the content of the `main.bal` file with the content below.\n\n   ***main.bal***\n\n    ```ballerina\n    import ballerina/http;\n\n    listener http:Listener helloEP = new (9090);\n\n    configurable string greeting = ?;\n\n    service /helloWorld on helloEP {\n        resource function get sayHello() returns string|error? {\n            return greeting + \", Kubernetes!\";\n        }\n    }\n    ```\n2. Create `probes.bal` with the following contents.\n\n   ***probes.bal***\n\n    ```ballerina\n    import ballerina/http;\n\n    listener http:Listener probeEP = new (9091);\n    \n    service /probes on probeEP {\n        resource function get healthz() returns boolean {\n            return true;\n        }\n        resource function get readyz() returns boolean {\n            return true;\n        }\n    }\n    ```\n3. Create the `Config.toml` file in the package directory and paste the following content into it.\n\n   ***Config.toml***\n    ```toml\n    greeting = \"Hello\"\n    ```\n\n4. Add `cloud = \"k8s\"` under the `[build-options]` table into the `Ballerina.toml` file in the package.\n\n   ***Ballerina.toml***\n\n    ```toml\n    [build-options]\n    cloud = \"k8s\"\n    ```\n\n5. Create a file named `Cloud.toml` in the package directory and add the content below. You can use some properties from the docker sample here since `cloud=\"k8s\"` option builds both Docker image and Kubernetes. You can see a brief description of the properties in the comments.\n\n   ***Cloud.toml***\n\n    ```toml\n    [container.image]\n    repository=\"wso2inc\" # Ex - Docker hub repository name.\n    name=\"hello-k8s\" # Container name\n    tag=\"v0.1.0\"\n\n    [cloud.deployment]\n    min_memory=\"100Mi\" # Minimum memory required for the container.\n    max_memory=\"256Mi\" # Maximum memory a single container can take.\n    min_cpu=\"500m\"  # Minimum CPU required for the container.\n    max_cpu=\"500m\" # Maximum CPU a single container can take.\n\n    [cloud.deployment.autoscaling]\n    min_replicas=2 # Minimum number of container instances ran at a given time\n    max_replicas=5 # Maximum number of replicas of the container can scale up to\n    cpu=60 # Average CPU utilization of pods\n\n    [[cloud.config.files]] # Mounts the `Config.toml` file as a config map in Kubernetes.\n    file=\"./Config.toml\"\n\n    [cloud.deployment.probes.liveness]\n    port=9091\n    path=\"/probes/healthz\"\n\n    [cloud.deployment.probes.readiness]\n    port=9091\n    path=\"/probes/readyz\"\n    ```\n\n### Generate the artifacts\n\nOnce you build the Ballerina package, the compiler extension will generate the artifacts required for k8s deployment.\n\n>**Tip:** If you are using Minikube, execute the `eval $(minikube docker-env)` command before building the image if you don't want to push the container to the Docker registry.\n\n>**Tip:** If you don't have the cloud=\"k8s\" entry on the `Ballerina.toml` you can execute `bal build --cloud=k8s` command to provide the build option inline.\n\n```\n$ bal build\nCompiling source\n        wso2/hello_k8s:0.1.0\n\nGenerating executable\n\nGenerating artifacts...\n\n        @kubernetes:Service                      - complete 1/2\n        @kubernetes:Service                      - complete 2/2\n        @kubernetes:ConfigMap                    - complete 1/1\n        @kubernetes:Deployment                   - complete 1/1\n        @kubernetes:HPA                          - complete 1/1\n        @kubernetes:Docker                       - complete 2/2 \n\n        Execute the below command to deploy the Kubernetes artifacts: \n        kubectl apply -f /home/wso2/c2c-guide/hello_k8s/target/kubernetes/hello_k8s\n\n        Execute the below command to access service via NodePort: \n        kubectl expose deployment hello-k8s-deployment --type=NodePort --name=hello-k8s-svc-local\n\n        target/bin/hello_k8s.jar\n```\n\n>**Note:** Before invoking the Kubernetes service, observe the Kubernetes yamls that have been generated. You should be able to find services for ports that have been exposed, `HorizontalPodAutoscaler` for scaling and Deployment, and Config maps.\n\n***target/kubernetes/hello_k8s***\n\n```yaml\n---\n---\napiVersion: \"v1\"\nkind: \"Service\"\nmetadata:\n  labels:\n    app: \"hello_k8s\"\n  name: \"hello-k8s-svc\"\nspec:\n  ports:\n  - name: \"port-1-hello-k8\"\n    port: 9090\n    protocol: \"TCP\"\n    targetPort: 9090\n  - name: \"port-2-hello-k8\"\n    port: 9091\n    protocol: \"TCP\"\n    targetPort: 9091\n  selector:\n    app: \"hello_k8s\"\n  type: \"ClusterIP\"\n---\napiVersion: \"v1\"\nkind: \"ConfigMap\"\nmetadata:\n  name: \"config-config-map\"\ndata:\n  Config.toml: \"greeting = \\\"Hello\\\"\\n\"\n---\napiVersion: \"apps/v1\"\nkind: \"Deployment\"\nmetadata:\n  labels:\n    app: \"hello_k8s\"\n  name: \"hello-k8s-deployment\"\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: \"hello_k8s\"\n  template:\n    metadata:\n      labels:\n        app: \"hello_k8s\"\n    spec:\n      containers:\n      - env:\n        - name: \"BAL_CONFIG_FILES\"\n          value: \"/home/ballerina/conf/Config.toml:\"\n        image: \"wso2inc/hello-k8s:v0.1.0\"\n        lifecycle:\n          preStop:\n            exec:\n              command:\n              - \"sleep\"\n              - \"15\"\n        livenessProbe:\n          httpGet:\n            path: \"/probes/healthz\"\n            port: 9091\n          initialDelaySeconds: 30\n        name: \"hello-k8s-deployment\"\n        ports:\n        - containerPort: 9090\n          name: \"port-1-hello-k8\"\n          protocol: \"TCP\"\n        - containerPort: 9091\n          name: \"port-2-hello-k8\"\n          protocol: \"TCP\"\n        readinessProbe:\n          httpGet:\n            path: \"/probes/readyz\"\n            port: 9091\n          initialDelaySeconds: 30\n        resources:\n          limits:\n            memory: \"256Mi\"\n            cpu: \"500m\"\n          requests:\n            memory: \"100Mi\"\n            cpu: \"500m\"\n        volumeMounts:\n        - mountPath: \"/home/ballerina/conf/\"\n          name: \"config-config-map-volume\"\n          readOnly: false\n      nodeSelector: {}\n      volumes:\n      - configMap:\n          name: \"config-config-map\"\n        name: \"config-config-map-volume\"\n---\napiVersion: \"autoscaling/v1\"\nkind: \"HorizontalPodAutoscaler\"\nmetadata:\n  labels:\n    app: \"hello_k8s\"\n  name: \"hello-k8s-hpa\"\nspec:\n  maxReplicas: 5\n  minReplicas: 2\n  scaleTargetRef:\n    apiVersion: \"apps/v1\"\n    kind: \"Deployment\"\n    name: \"hello-k8s-deployment\"\n  targetCPUUtilizationPercentage: 60\n```\n\n### Execute the Kubernetes service\n\nFollow the steps below to execute the Kubernetes service.\n1. Execute `docker push <repository>/<name>:<tag>` to push the container to docker hub. You can skip this step if you executed `eval $(minikube docker-env)` before building the container.\n    ```\n    $ docker push wso2inc/hello-k8s:v0.1.0\n    ```\n\n2. Execute the `kubectl apply -f target/kubernetes/hello_k8s` command to execute the service.\n\n    ```\n    $ kubectl apply -f target/kubernetes/hello_k8s\n    service/hello-k8s-svc created\n    configmap/hello-k8s-config-json created\n    deployment.apps/hello-k8s-deployment created\n    horizontalpodautoscaler.autoscaling/hello-k8s-hpa created\n    ```\n\n3. Execute the `kubectl get pods` command to verify the Kubernetes pods.\n\n    ```\n    $ kubectl get pods\n    NAME                                        READY   STATUS    RESTARTS   AGE\n    hello-k8s-deployment-577d8dbf8-p8zg5   1/1     Running   0          37s\n    hello-k8s-deployment-577d8dbf8-p8zg5   1/1     Running   0          57s\n    ```\n\n4. Execute the `kubectl expose deployment hello-k8s-deployment --type=NodePort --name=hello-k8s-svc-local` command to expose the service via NodePort to test in the development environment.\n\n    ```\n    $ kubectl expose deployment hello-k8s-deployment --type=NodePort --name=hello-k8s-svc-local\n    service/hello-k8s-svc-local exposed\n    ```\n\n5. Execute the `kubectl get svc` command to get the EXTERNAL-IP and port of the Kubernetes service.\n\n    ```\n    $ kubectl get svc\n    NAME                      TYPE        CLUSTER-IP       EXTERNAL-IP   PORT(S)          AGE\n    hello-k8s-svc         ClusterIP   10.96.173.207   <none>        9090/TCP,9091/TCP               5m11s\n    hello-k8s-svc-local   NodePort    10.99.245.41    <none>        9090:30342/TCP,9091:30515/TCP   66s\n    kubernetes            ClusterIP   10.96.0.1       <none>        443/TCP                         130m\n    ```\n\n   >**Tip:** If you are using Minikube, execute the `minikube ip` command to get the IP address.\n\n    ```\n    $ minikube ip\n    192.168.49.2\n    ```\n\n6. Execute the `curl http://192.168.49.2:30342/helloWorld/sayHello` command to access the deployed service via cURL.\n\n    ```\n    $ curl http://192.168.49.2:30342/helloWorld/sayHello\n    Hello, Kubernetes!\n    ```\n\n>**Note:** You can visit the <a href=\"https://github.com/ballerina-platform/ballerina-spec/blob/master/c2c/code-to-cloud-spec.md\" target=\"_blank\">Code to Cloud specification</a> for detailed information about all the supported features. As mentioned in the beginning, Code to Cloud is a tool created to make the development process easier. It does not cover the operational properties in Kubernetes. If you want to have these additional features in your deployment, or you need to change the generated Kubernetes artifacts, you can use <a href=\"https://kustomize.io\" target=\"_blank\">Kustomize</a> for modifying the generated YAML.\n\n\n## Kubernetes deployment with Kustomize\n\n[Kustomize](https://kustomize.io/) is a tool that allows you to modify Kubernetes YAML files without altering the original files. It can enhance the generated YAML from code-to-cloud deployments by applying additional customizations. The `kustomization.yaml` file in the root directory demonstrates how to combine and manage the generated YAML files from multiple projects. Using Kustomize patches, you can add environment variables, such as specifying the location of the `Config.toml` file for a service, to enable additional configuration.\n\n**kustomization.yaml**\n```yaml\nresources:\n  - /path/to/target/kubernetes/hotel/hotel.ymal\n  - /path/to/target/kubernetes/room/room.yaml\n  - …\n\npatchesStrategicMerge:\n- secret-env-patch.yaml\n\n```\n\n## CI/CD with Kubernetes\n\nThis [Ballerina GitHub](https://github.com/ballerina-platform/ballerina-action) action workflow automates the continuous integration and continuous deployment (CI/CD) process for a Ballerina project. It is triggered by every push to the repository and automatically builds the project.\n\n```yaml\n\nname: Ballerina CI/CD with Kubernetes and Ballerina Central Push\non: [push]\n\njobs:\n  build-and-deploy:\n    runs-on: ubuntu-latest\n\n    steps:\n      # Step 1: Checkout the Repository\n      - name: Checkout\n        uses: actions/checkout@v2\n\n      # Step 2: Build the Ballerina Project\n      - name: Ballerina Build\n        uses: ballerina-platform/ballerina-action@master\n        with:\n          args: build --cloud=k8s\n\n      # Step 3: Log in to Docker Registry\n      - name: Log in to Docker Registry\n        uses: docker/login-action@v2\n        with:\n          registry: ${{ secrets.DOCKER_REGISTRY_URL }}\n          username: ${{ secrets.DOCKER_USERNAME }}\n          password: ${{ secrets.DOCKER_PASSWORD }}\n\n      # Step 4: Push the Docker Image\n      - name: Push Docker Image\n        run: |\n          docker push ${{ secrets.DOCKER_REGISTRY_URL }}/your-docker-repo/your-app:${{ github.sha }}\n\n      # Step 5: Set up Kubectl\n      - name: Set up Kubectl\n        uses: azure/setup-kubectl@v3\n        with:\n          version: 'v1.22.0'\n\n      # Step 6: Deploy to Kubernetes\n      - name: Deploy to Kubernetes\n        env:\n          KUBE_CONFIG_DATA: ${{ secrets.KUBE_CONFIG_DATA }}\n        run: |\n          echo \"${KUBE_CONFIG_DATA}\" | base64 --decode > $HOME/.kube/config\n          kubectl apply -f <path to generated artifacts>\n```\n- **Step 01:** This step checks out the repository.\n- **Step 02:** This step builds the Ballerina project, compiling the source code and preparing the necessary artifacts for deployment in Kubernetes.\n- **Step 03:** This step logs into a Docker registry (such as Docker Hub or a private registry) to allow pushing the Docker image created in the build to the registry.\n- **Step 04:** Pushes the Docker image to the specified Docker registry.\n- **Step 05:** This step installs kubectl, the Kubernetes command-line tool, which is necessary for managing Kubernetes clusters and deploying applications.\n- **Step 06:** Deploy the application to a Kubernetes cluster by applying the Kubernetes YAML configuration files generated by the Ballerina build in Step 2.\n>**Note:** Replace <path to generated artifacts> with the actual path to the Kubernetes YAML files generated by the Ballerina build command (e.g., target/kubernetes).\n\n","id":"containerized-deployment","sub":"deployment-guide","third":"","slug":"deployment-guide/containerized-deployment","codes":"[[570818786,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">build-options</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\"># cloud = \\\"docker\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">cloud = </span><span style=\\\"color:#032F62\\\">\\\"k8s\\\"</span></span></code></pre>\"],[-361695723,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerina/http;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">listener</span><span style=\\\"color:#24292E\\\"> http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Listener helloEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span><span style=\\\"color:#005CC5\\\">9090</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">configurable</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> name </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> ?</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">service</span><span style=\\\"color:#6F42C1\\\"> /helloWorld</span><span style=\\\"color:#D73A49\\\"> on</span><span style=\\\"color:#24292E\\\"> helloEP {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> get</span><span style=\\\"color:#6F42C1\\\"> sayHello</span><span style=\\\"color:#24292E\\\">() </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> {   </span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        return</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#032F62\\\"> `Hello, ${</span><span style=\\\"color:#24292E\\\">name</span><span style=\\\"color:#032F62\\\">}!`</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[-235926273,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">build-options</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">cloud = </span><span style=\\\"color:#032F62\\\">\\\"docker\\\"</span></span></code></pre>\"],[-1605246216,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">container</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">image</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">repository=</span><span style=\\\"color:#032F62\\\">\\\"wso2inc\\\"</span><span style=\\\"color:#6A737D\\\"> # Docker hub name</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">name=</span><span style=\\\"color:#032F62\\\">\\\"hello\\\"</span><span style=\\\"color:#6A737D\\\"> # container name</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">tag=</span><span style=\\\"color:#032F62\\\">\\\"v0.1.0\\\"</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">settings</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">buildImage=</span><span style=\\\"color:#005CC5\\\">true</span><span style=\\\"color:#6A737D\\\"> # you can make this false if you don't want to build the image and you just need the Dockerfile</span></span></code></pre>\"],[-1091297096,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">name = </span><span style=\\\"color:#032F62\\\">\\\"Docker\\\"</span></span></code></pre>\"],[-1965229756,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerina/http;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">listener</span><span style=\\\"color:#24292E\\\"> http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Listener helloEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span><span style=\\\"color:#005CC5\\\">9090</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">configurable</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#24292E\\\"> greeting </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> ?</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">service</span><span style=\\\"color:#6F42C1\\\"> /helloWorld</span><span style=\\\"color:#D73A49\\\"> on</span><span style=\\\"color:#24292E\\\"> helloEP {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> get</span><span style=\\\"color:#6F42C1\\\"> sayHello</span><span style=\\\"color:#24292E\\\">() </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#005CC5\\\"> string</span><span style=\\\"color:#D73A49\\\">|error?</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        return</span><span style=\\\"color:#24292E\\\"> greeting </span><span style=\\\"color:#D73A49\\\">+</span><span style=\\\"color:#032F62\\\"> \\\", Kubernetes!\\\"</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[-5346878,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerina/http;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">listener</span><span style=\\\"color:#24292E\\\"> http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Listener probeEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span><span style=\\\"color:#005CC5\\\">9091</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">service</span><span style=\\\"color:#6F42C1\\\"> /probes</span><span style=\\\"color:#D73A49\\\"> on</span><span style=\\\"color:#24292E\\\"> probeEP {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> get</span><span style=\\\"color:#6F42C1\\\"> healthz</span><span style=\\\"color:#24292E\\\">() </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#005CC5\\\"> boolean</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        return</span><span style=\\\"color:#D73A49\\\"> true</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> get</span><span style=\\\"color:#6F42C1\\\"> readyz</span><span style=\\\"color:#24292E\\\">() </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#005CC5\\\"> boolean</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        return</span><span style=\\\"color:#D73A49\\\"> true</span><span style=\\\"color:#24292E\\\">;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[937380936,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">greeting = </span><span style=\\\"color:#032F62\\\">\\\"Hello\\\"</span></span></code></pre>\"],[1431467551,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">build-options</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">cloud = </span><span style=\\\"color:#032F62\\\">\\\"k8s\\\"</span></span></code></pre>\"],[-239496856,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">container</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">image</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">repository=</span><span style=\\\"color:#032F62\\\">\\\"wso2inc\\\"</span><span style=\\\"color:#6A737D\\\"> # Ex - Docker hub repository name.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">name=</span><span style=\\\"color:#032F62\\\">\\\"hello-k8s\\\"</span><span style=\\\"color:#6A737D\\\"> # Container name</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">tag=</span><span style=\\\"color:#032F62\\\">\\\"v0.1.0\\\"</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">cloud</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">deployment</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">min_memory=</span><span style=\\\"color:#032F62\\\">\\\"100Mi\\\"</span><span style=\\\"color:#6A737D\\\"> # Minimum memory required for the container.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">max_memory=</span><span style=\\\"color:#032F62\\\">\\\"256Mi\\\"</span><span style=\\\"color:#6A737D\\\"> # Maximum memory a single container can take.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">min_cpu=</span><span style=\\\"color:#032F62\\\">\\\"500m\\\"</span><span style=\\\"color:#6A737D\\\">  # Minimum CPU required for the container.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">max_cpu=</span><span style=\\\"color:#032F62\\\">\\\"500m\\\"</span><span style=\\\"color:#6A737D\\\"> # Maximum CPU a single container can take.</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">cloud</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">deployment</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">autoscaling</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">min_replicas=</span><span style=\\\"color:#005CC5\\\">2</span><span style=\\\"color:#6A737D\\\"> # Minimum number of container instances ran at a given time</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">max_replicas=</span><span style=\\\"color:#005CC5\\\">5</span><span style=\\\"color:#6A737D\\\"> # Maximum number of replicas of the container can scale up to</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">cpu=</span><span style=\\\"color:#005CC5\\\">60</span><span style=\\\"color:#6A737D\\\"> # Average CPU utilization of pods</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[[</span><span style=\\\"color:#6F42C1\\\">cloud</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">config</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">files</span><span style=\\\"color:#24292E\\\">]] </span><span style=\\\"color:#6A737D\\\"># Mounts the `Config.toml` file as a config map in Kubernetes.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">file=</span><span style=\\\"color:#032F62\\\">\\\"./Config.toml\\\"</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">cloud</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">deployment</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">probes</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">liveness</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">port=</span><span style=\\\"color:#005CC5\\\">9091</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">path=</span><span style=\\\"color:#032F62\\\">\\\"/probes/healthz\\\"</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">[</span><span style=\\\"color:#6F42C1\\\">cloud</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">deployment</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">probes</span><span style=\\\"color:#24292E\\\">.</span><span style=\\\"color:#6F42C1\\\">readiness</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">port=</span><span style=\\\"color:#005CC5\\\">9091</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">path=</span><span style=\\\"color:#032F62\\\">\\\"/probes/readyz\\\"</span></span></code></pre>\"],[1572447630,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#6F42C1\\\">---</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6F42C1\\\">---</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">apiVersion</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"v1\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">kind</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"Service\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">metadata</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  labels</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    app</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"hello_k8s\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"hello-k8s-svc\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">spec</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  ports</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">  - </span><span style=\\\"color:#22863A\\\">name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"port-1-hello-k8\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    port</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">9090</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    protocol</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"TCP\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    targetPort</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">9090</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">  - </span><span style=\\\"color:#22863A\\\">name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"port-2-hello-k8\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    port</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">9091</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    protocol</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"TCP\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    targetPort</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">9091</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  selector</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    app</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"hello_k8s\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  type</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"ClusterIP\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6F42C1\\\">---</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">apiVersion</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"v1\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">kind</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"ConfigMap\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">metadata</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"config-config-map\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">data</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  Config.toml</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"greeting = </span><span style=\\\"color:#005CC5\\\">\\\\\\\"</span><span style=\\\"color:#032F62\\\">Hello</span><span style=\\\"color:#005CC5\\\">\\\\\\\"\\\\n</span><span style=\\\"color:#032F62\\\">\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6F42C1\\\">---</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">apiVersion</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"apps/v1\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">kind</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"Deployment\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">metadata</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  labels</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    app</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"hello_k8s\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"hello-k8s-deployment\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">spec</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  replicas</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">1</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  selector</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    matchLabels</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">      app</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"hello_k8s\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  template</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    metadata</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">      labels</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">        app</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"hello_k8s\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    spec</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">      containers</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">      - </span><span style=\\\"color:#22863A\\\">env</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        - </span><span style=\\\"color:#22863A\\\">name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"BAL_CONFIG_FILES\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          value</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"/home/ballerina/conf/Config.toml:\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">        image</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"wso2inc/hello-k8s:v0.1.0\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">        lifecycle</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          preStop</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">            exec</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">              command</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">              - </span><span style=\\\"color:#032F62\\\">\\\"sleep\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">              - </span><span style=\\\"color:#032F62\\\">\\\"15\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">        livenessProbe</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          httpGet</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">            path</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"/probes/healthz\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">            port</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">9091</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          initialDelaySeconds</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">30</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">        name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"hello-k8s-deployment\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">        ports</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        - </span><span style=\\\"color:#22863A\\\">containerPort</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">9090</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"port-1-hello-k8\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          protocol</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"TCP\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        - </span><span style=\\\"color:#22863A\\\">containerPort</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">9091</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"port-2-hello-k8\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          protocol</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"TCP\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">        readinessProbe</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          httpGet</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">            path</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"/probes/readyz\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">            port</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">9091</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          initialDelaySeconds</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">30</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">        resources</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          limits</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">            memory</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"256Mi\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">            cpu</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"500m\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          requests</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">            memory</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"100Mi\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">            cpu</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"500m\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">        volumeMounts</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        - </span><span style=\\\"color:#22863A\\\">mountPath</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"/home/ballerina/conf/\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"config-config-map-volume\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          readOnly</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">false</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">      nodeSelector</span><span style=\\\"color:#24292E\\\">: {}</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">      volumes</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">      - </span><span style=\\\"color:#22863A\\\">configMap</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">          name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"config-config-map\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">        name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"config-config-map-volume\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6F42C1\\\">---</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">apiVersion</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"autoscaling/v1\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">kind</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"HorizontalPodAutoscaler\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">metadata</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  labels</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    app</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"hello_k8s\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"hello-k8s-hpa\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">spec</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  maxReplicas</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">5</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  minReplicas</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">2</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  scaleTargetRef</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    apiVersion</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"apps/v1\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    kind</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"Deployment\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">    name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"hello-k8s-deployment\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">  targetCPUUtilizationPercentage</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">60</span></span></code></pre>\"],[1224654367,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">resources</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">  - </span><span style=\\\"color:#032F62\\\">/path/to/target/kubernetes/hotel/hotel.ymal</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">  - </span><span style=\\\"color:#032F62\\\">/path/to/target/kubernetes/room/room.yaml</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">  - </span><span style=\\\"color:#032F62\\\">…</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">patchesStrategicMerge</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">- </span><span style=\\\"color:#032F62\\\">secret-env-patch.yaml</span></span></code></pre>\"],[359831675,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">ame</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">Ballerina CI/CD with Kubernetes and Ballerina Central Push</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">n</span><span style=\\\"color:#24292E\\\">: [</span><span style=\\\"color:#032F62\\\">push</span><span style=\\\"color:#24292E\\\">]</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">obs</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\"> build-and-deploy</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">   runs-on</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">ubuntu-latest</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">   steps</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">     # Step 1: Checkout the Repository</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">     - </span><span style=\\\"color:#22863A\\\">name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">Checkout</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">       uses</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">actions/checkout@v2</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">     # Step 2: Build the Ballerina Project</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">     - </span><span style=\\\"color:#22863A\\\">name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">Ballerina Build</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">       uses</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">ballerina-platform/ballerina-action@master</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">       with</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">         args</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">build --cloud=k8s</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">     # Step 3: Log in to Docker Registry</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">     - </span><span style=\\\"color:#22863A\\\">name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">Log in to Docker Registry</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">       uses</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">docker/login-action@v2</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">       with</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">         registry</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">${{ secrets.DOCKER_REGISTRY_URL }}</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">         username</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">${{ secrets.DOCKER_USERNAME }}</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">         password</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">${{ secrets.DOCKER_PASSWORD }}</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">     # Step 4: Push the Docker Image</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">     - </span><span style=\\\"color:#22863A\\\">name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">Push Docker Image</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">       run</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#032F62\\\">         docker push ${{ secrets.DOCKER_REGISTRY_URL }}/your-docker-repo/your-app:${{ github.sha }}</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">     # Step 5: Set up Kubectl</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">     - </span><span style=\\\"color:#22863A\\\">name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">Set up Kubectl</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">       uses</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">azure/setup-kubectl@v3</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">       with</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">         version</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">'v1.22.0'</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">     # Step 6: Deploy to Kubernetes</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">     - </span><span style=\\\"color:#22863A\\\">name</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">Deploy to Kubernetes</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">       env</span><span style=\\\"color:#24292E\\\">:</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">         KUBE_CONFIG_DATA</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">${{ secrets.KUBE_CONFIG_DATA }}</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#22863A\\\">       run</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#032F62\\\">         echo \\\"${KUBE_CONFIG_DATA}\\\" | base64 --decode > $HOME/.kube/config</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#032F62\\\">         kubectl apply -f &#x3C;path to generated artifacts></span></span></code></pre>\"]]"},"__N_SSG":true}