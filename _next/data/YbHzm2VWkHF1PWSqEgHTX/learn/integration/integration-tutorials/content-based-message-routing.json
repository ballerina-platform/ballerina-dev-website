{"pageProps":{"frontmatter":{"layout":"ballerina-content-based-message-routing-left-nav-pages-swanlake","title":"Content-based message routing","permalink":"/learn/content-based-message-routing/","description":"Integration tutorial for message routing based on the content.","keywords":"ballerina, programming language, client, restful-api, integration","active":"content-based-message-routing","intro":"This tutorial helps you understand how content-based routing can be done in Ballerina."},"content":"\n## Overview\n\nIn this tutorial, you will develop a service via which you can reserve appointments at several hospitals. The requests are routed to the relevant hospital based on the content of the request payload.\n\nTo implement this use case, you will develop a REST service with a single resource using Visual Studio Code with the Ballerina Swan Lake extension. The resource will receive the user request, select the hospital endpoint based on the hospital ID, send a request to the relevant hospital service to make a reservation, and respond with the reservation details.\n\nThe flow is as follows.\n\n1. Receive a request with a JSON payload similar to the following.\n\n    ```json\n    {\n        \"patient\": {\n            \"name\": \"John Doe\",\n            \"dob\": \"1940-03-19\",\n            \"ssn\": \"234-23-525\",\n            \"address\": \"California\",\n            \"phone\": \"8770586755\",\n            \"email\": \"johndoe@gmail.com\"\n        },\n        \"doctor\": \"thomas collins\",\n        \"hospital\": \"grand oak community hospital\",\n        \"hospital_id\": \"grandoak\",\n        \"appointment_date\": \"2023-10-02\"\n    }\n    ```\n\n2. Extract the `hospital_id` field and select the corresponding hospital service endpoint.\n\n   - grandoak -> `http://localhost:9090/grandoak/categories`\n   - clemency -> `http://localhost:9090/clemency/categories`\n   - pinevalley -> `http://localhost:9090/pinevalley/categories`\n\n3. Send a request to the selected hospital endpoint and retrieve the response which will be similar to the following.\n\n    ```json\n    {\n        \"appointmentNumber\": 8,\n        \"doctor\": {\n            \"name\": \"thomas collins\",\n            \"hospital\": \"grand oak community hospital\",\n            \"category\": \"surgery\",\n            \"availability\": \"9.00 a.m - 11.00 a.m\",\n            \"fee\": 7000.0\n        },\n        \"patient\": {\n            \"name\": \"John Doe\",\n            \"dob\": \"1940-03-19\",\n            \"ssn\": \"234-23-525\",\n            \"address\": \"California\",\n            \"phone\": \"8770586755\",\n            \"email\": \"johndoe@gmail.com\"\n        },\n        \"hospital\": \"grand oak community hospital\",\n        \"confirmed\": false,\n        \"appointmentDate\": \"2023-10-02\"\n    }\n    ```\n\n### Concepts covered\n\n- REST API\n- HTTP Client\n\n## Develop the application\n\n### Step 1: Set up the workspace\n\nInstall [Ballerina Swan Lake](https://ballerina.io/downloads/) and the [Ballerina Swan Lake VS Code extension](https://marketplace.visualstudio.com/items?itemName=wso2.ballerina) on VS Code.\n\n### Step 2: Develop the service\n\nFollow the instructions given in this section to develop the service.\n\n1. Create a new Ballerina project using the `bal` command and open it in VS Code.\n\n    ```\n    $ bal new content-based-message-routing\n    ```\n\n2. Remove the generated content in the `main.bal` file and open the diagram view in VS Code.\n\n    ![Open diagram view](/learn/images/integration-tutorials/content-based-message-routing/open_diagram_view.gif)\n\n3. Define an enum to represent the hospital IDs.\n\n    ![Define an enum](/learn/images/integration-tutorials/content-based-message-routing/define_enum.gif)\n\n    The generated `HospitalId` enum will be as follows.\n\n    ```ballerina\n    enum HospitalId {\n        grandoak,\n        clemency,\n        pinevalley\n    }\n    ```\n\n4. Generate record types corresponding to the response from the hospital backend service by providing a sample of the expected JSON payload.\n\n    The payload from the hospital backend service will be a JSON object similar to the following.\n\n    ```json\n    {\n        \"appointmentNumber\": 1,\n        \"doctor\": {\n            \"name\": \"thomas collins\",\n            \"hospital\": \"grand oak community hospital\",\n            \"category\": \"surgery\",\n            \"availability\": \"9.00 a.m - 11.00 a.m\",\n            \"fee\": 7000.0\n        },\n        \"patient\": {\n            \"name\": \"John Doe\",\n            \"dob\": \"1940-03-19\",\n            \"ssn\": \"234-23-525\",\n            \"address\": \"California\",\n            \"phone\": \"8770586755\",\n            \"email\": \"johndoe@gmail.com\"\n        },\n        \"hospital\": \"grand oak community hospital\",\n        \"confirmed\": false,\n        \"appointmentDate\": \"2023-10-02\"\n    }\n    ```\n\n    ![Define record types](/learn/images/integration-tutorials/content-based-message-routing/define_record_types.gif)\n   \n    The generated record types will be as follows.\n\n    ```ballerina\n    type Patient record {\n        string name;\n        string dob;\n        string ssn;\n        string address;\n        string phone;\n        string email;\n    };\n\n    type Doctor record {\n        string name;\n        string hospital;\n        string category;\n        string availability;\n        decimal fee;\n    };\n\n    type ReservationResponse record {\n        int appointmentNumber;\n        Doctor doctor;\n        Patient patient;\n        string hospital;\n        boolean confirmed;\n        string appointmentDate;\n    };\n    ```\n\n    Similarly, generate a record corresponding to the request payload (e.g., `ReservationRequest`) and update the `hospital_id` field to be of the `HospitalId` type that was defined previously. Remove the duplicate `Patient` record if the same type has already been generated.\n\n    ```ballerina\n    type ReservationRequest record {\n        Patient patient;\n        string doctor;\n        HospitalId hospital_id;\n        string hospital;\n        string appointment_date;\n    };\n    ```\n\n    > **Note:**\n    > While it is possible to work with the JSON payload directly, using record types offers several advantages including enhanced type safety, data validation, and better tooling experience (e.g., completion).\n\n    > **Note:**\n    > When the fields of the JSON objects are expected to be exactly those specified in the sample payload, the generated records can be updated to be [closed records](https://ballerina.io/learn/by-example/controlling-openness/), which would indicate that no other fields are allowed or expected.\n\n5. Define the [HTTP service (REST API)](https://ballerina.io/learn/by-example/#rest-service) that has the resource that accepts user requests, retrieves relevant details from the backend service, and responds to the request.\n\n    - Open the [Ballerina HTTP API Designer](https://wso2.com/ballerina/vscode/docs/design-the-services/http-api-designer) in VS Code.\n\n    - Use `/healthcare` as the service path (or the context) of the service, which is attached to the listener listening on port `8290`.\n\n        ![Define the service](/learn/images/integration-tutorials/content-based-message-routing/define_a_service.gif)\n\n    - Define an HTTP resource that allows the `POST` operation on the resource path `/categories/{category}/reserve` and accepts the `category` path parameter (corresponding to the specialization). Use `ReservationRequest` as a parameter indicating that the resource expects a JSON object corresponding to `ReservationRequest` as the payload. Use `ReservationResponse`, `http:NotFound`, and `http:InternalServerError` as the response types.\n\n        ![Define the resource](/learn/images/integration-tutorials/content-based-message-routing/define_a_resource.gif)\n\n    The generated service will be as follows.\n\n    ```ballerina\n    service /healthcare on new http:Listener(8290) {\n        resource function post categories/[string category]/reserve(ReservationRequest reservation) \n               returns ReservationResponse|http:NotFound|http:InternalServerError {\n            \n        }\n    }\n    ```\n\n6. Define three [`http:Client`](https://ballerina.io/learn/by-example/#http-client) objects to send requests to the backend services.\n\n    ![Define a client](/learn/images/integration-tutorials/content-based-message-routing/define_a_client.gif)\n\n    The generated code will be as follows.\n\n    ```ballerina\n    final http:Client grandOakEP = check new (\"http://localhost:9090/grandoak/categories\");\n    final http:Client clemencyEP = check new (\"http://localhost:9090/clemency/categories\");\n    final http:Client pineValleyEP = check new (\"http://localhost:9090/pinevalley/categories\");\n    ```\n\n7. Implement the logic.\n\n    ```ballerina\n    service /healthcare on new http:Listener(8290) {\n        resource function post categories/[string category]/reserve(ReservationRequest reservation)\n                returns ReservationResponse|http:NotFound|http:InternalServerError {\n            http:Client hospitalEP;\n            match reservation.hospital_id {\n                grandoak => {\n                    hospitalEP = grandOakEP;\n                }\n                clemency => {\n                    hospitalEP = clemencyEP;\n                }\n                _ => {\n                    hospitalEP = pineValleyEP;\n                }\n            }\n\n            ReservationResponse|http:ClientError resp = hospitalEP->/[category]/reserve.post({\n                patient: reservation.patient,\n                doctor: reservation.doctor,\n                hospital: reservation.hospital,\n                appointment_date: reservation.appointment_date\n            });\n\n            if resp is ReservationResponse {\n                return resp;\n            }\n\n            log:printError(\"Reservation request failed\", resp);\n            if resp is http:ClientRequestError {\n                return <http:NotFound> {body: \"Unknown hospital, doctor or category\"};\n            }\n\n            return <http:InternalServerError> {body: resp.message()};\n        }\n    }\n    ```\n\n    - Define an `http:Client` variable named `hospitalEP`. Later, the relevant client is assigned to this variable based on the `hospital_id` value.\n\n    - Use a [match statement](https://ballerina.io/learn/by-example/match-statement) to assign the relevant client to the `hospitalEP` variable based on the `hospital_id` value.\n\n    - Make a `POST` request to the relevant backend hospital service to make the reservation. The `category` value is used as a path parameter.\n\n    - Use the `is` check to check whether the response is a `ReservationResponse` record, which would indicate a successful reservation. If the response is a `ReservationResponse` record, return the record from the resource method to send a `201 Created` response with the `ReservationResponse` value as the payload.\n\n    - If the response is not a `ReservationResponse` record (i.e., `http:ClientError`) which indicates that the request failed, log the failure at `ERROR` level.  Return an `http:NotFound` response if the response is `http:ClientRequestError`, or an `http:InternalServerError` response if the response is `http:ServerError`.\n\nYou have successfully developed the required service.\n\n#### Complete source code\n\n```ballerina\nimport ballerina/http;\nimport ballerina/log;\n\nfinal http:Client grandOakEP = check new (\"http://localhost:9090/grandoak/categories\");\nfinal http:Client clemencyEP = check new (\"http://localhost:9090/clemency/categories\");\nfinal http:Client pineValleyEP = check new (\"http://localhost:9090/pinevalley/categories\");\n\nenum HospitalId {\n    grandoak,\n    clemency,\n    pinevalley\n};\n\ntype Patient record {|\n    string name;\n    string dob;\n    string ssn;\n    string address;\n    string phone;\n    string email;\n|};\n\ntype Doctor record {|\n    string name;\n    string hospital;\n    string category;\n    string availability;\n    decimal fee;\n|};\n\ntype ReservationResponse record {|\n    int appointmentNumber;\n    Doctor doctor;\n    Patient patient;\n    string hospital;\n    boolean confirmed;\n    string appointmentDate;\n|};\n\ntype ReservationRequest record {|\n    Patient patient;\n    string doctor;\n    HospitalId hospital_id;\n    string hospital;\n    string appointment_date;\n|};\n\nservice /healthcare on new http:Listener(8290) {\n    resource function post categories/[string category]/reserve(ReservationRequest reservation)\n            returns ReservationResponse|http:NotFound|http:InternalServerError {\n        http:Client hospitalEP;\n        match reservation.hospital_id {\n            grandoak => {\n                hospitalEP = grandOakEP;\n            }\n            clemency => {\n                hospitalEP = clemencyEP;\n            }\n            _ => {\n                hospitalEP = pineValleyEP;\n            }\n        }\n\n        ReservationResponse|http:ClientError resp = hospitalEP->/[category]/reserve.post({\n            patient: reservation.patient,\n            doctor: reservation.doctor,\n            hospital: reservation.hospital,\n            appointment_date: reservation.appointment_date\n        });\n\n        if resp is ReservationResponse {\n            return resp;\n        }\n\n        log:printError(\"Reservation request failed\", resp);\n        if resp is http:ClientRequestError {\n            return <http:NotFound> {body: \"Unknown hospital, doctor or category\"};\n        }\n\n        return <http:InternalServerError> {body: resp.message()};\n    }\n}\n```\n\n### Step 3: Build and run the service\n\n![Run the service](/learn/images/integration-tutorials/content-based-message-routing/run_the_service.gif)\n\n> **Note:** Alternatively, you can run this service by navigating to the project root and using the `bal run` command.\n>\n> ```\n> content-based-message-routing$ bal run\n> Compiling source\n>         integration_tutorials/content_based_message_routing:0.1.0\n> \n> Running executable\n> ```\n\n### Step 4: Try out the use case\n\nLet's test the use case by sending a request to the service.\n\n#### Start the backend service\n\nDownload the JAR file for the [backend service](https://github.com/ballerina-guides/integration-tutorials/blob/main/backends/hospital-service/hospitalservice.jar) and execute the following command to start the service.\n\n```\n$ bal run hospitalservice.jar\n```\n\n#### Send a request to the service\n\nUse the [Try it](https://wso2.com/ballerina/vscode/docs/try-the-services/try-http-services/) feature to send a request to the service. Specify `surgery` as the path parameter. Use the following as the request payload.\n\n```json\n{\n    \"patient\": {\n        \"name\": \"John Doe\",\n        \"dob\": \"1940-03-19\",\n        \"ssn\": \"234-23-525\",\n        \"address\": \"California\",\n        \"phone\": \"8770586755\",\n        \"email\": \"johndoe@gmail.com\"\n    },\n    \"doctor\": \"thomas collins\",\n    \"hospital_id\": \"grandoak\",\n    \"hospital\": \"grand oak community hospital\",\n    \"appointment_date\": \"2023-10-02\"\n}\n```\n\n![Send a request](/learn/images/integration-tutorials/content-based-message-routing/try_it.gif)\n\n#### Verify the response\n\nYou will see a response similar to the following for a successful appointment reservation.\n\n```json\n{\n    \"appointmentNumber\": 1,\n    \"doctor\": {\n        \"name\": \"thomas collins\",\n        \"hospital\": \"grand oak community hospital\",\n        \"category\": \"surgery\",\n        \"availability\": \"9.00 a.m - 11.00 a.m\",\n        \"fee\": 7000.0\n    },\n    \"patient\": {\n        \"name\": \"John Doe\",\n        \"dob\": \"1940-03-19\",\n        \"ssn\": \"234-23-525\",\n        \"address\": \"California\",\n        \"phone\": \"8770586755\",\n        \"email\": \"johndoe@gmail.com\"\n    },\n    \"hospital\": \"grand oak community hospital\",\n    \"confirmed\": false,\n    \"appointmentDate\": \"2023-10-02\"\n}\n```\n\n## Complete implementation\n\nCheck out the [complete implementation](https://github.com/ballerina-guides/integration-tutorials/tree/main/content-based-message-routing) on GitHub.\n\n## References\n\n- [`ballerina/http` API docs](https://lib.ballerina.io/ballerina/http/latest)\n- [`ballerina/log` API docs](https://lib.ballerina.io/ballerina/log/latest)\n","slug":"content-based-message-routing","codes":"[[1523796153,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">{</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"patient\\\"</span><span style=\\\"color:#24292E\\\">: {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"name\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"John Doe\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"dob\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"1940-03-19\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"ssn\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"234-23-525\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"address\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"California\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"phone\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"8770586755\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"email\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"johndoe@gmail.com\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    },</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"doctor\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"thomas collins\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"hospital\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"grand oak community hospital\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"hospital_id\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"grandoak\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"appointment_date\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"2023-10-02\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[-1810967847,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">{</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"appointmentNumber\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">8</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"doctor\\\"</span><span style=\\\"color:#24292E\\\">: {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"name\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"thomas collins\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"hospital\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"grand oak community hospital\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"category\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"surgery\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"availability\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"9.00 a.m - 11.00 a.m\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"fee\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">7000.0</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    },</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"patient\\\"</span><span style=\\\"color:#24292E\\\">: {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"name\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"John Doe\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"dob\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"1940-03-19\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"ssn\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"234-23-525\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"address\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"California\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"phone\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"8770586755\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"email\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"johndoe@gmail.com\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    },</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"hospital\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"grand oak community hospital\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"confirmed\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">false</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"appointmentDate\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"2023-10-02\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[-1606115978,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">enum</span><span style=\\\"color:#6F42C1\\\"> HospitalId</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    grandoak</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    clemency</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    pinevalley</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[1379860178,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">{</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"appointmentNumber\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">1</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"doctor\\\"</span><span style=\\\"color:#24292E\\\">: {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"name\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"thomas collins\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"hospital\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"grand oak community hospital\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"category\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"surgery\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"availability\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"9.00 a.m - 11.00 a.m\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"fee\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">7000.0</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    },</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"patient\\\"</span><span style=\\\"color:#24292E\\\">: {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"name\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"John Doe\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"dob\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"1940-03-19\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"ssn\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"234-23-525\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"address\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"California\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"phone\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"8770586755\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"email\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"johndoe@gmail.com\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    },</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"hospital\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"grand oak community hospital\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"confirmed\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#005CC5\\\">false</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"appointmentDate\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"2023-10-02\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[-725946286,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> Patient</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> name;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> dob;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> ssn;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> address;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> phone;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> email;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> Doctor</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> name;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> hospital;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> category;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> availability;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    decimal</span><span style=\\\"color:#24292E\\\"> fee;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> ReservationResponse</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    int</span><span style=\\\"color:#24292E\\\"> appointmentNumber;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Doctor doctor;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Patient patient;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> hospital;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    boolean</span><span style=\\\"color:#24292E\\\"> confirmed;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> appointmentDate;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[1604242273,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> ReservationRequest</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Patient patient;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> doctor;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    HospitalId hospital_id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> hospital;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> appointment_date;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[8106564,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">service</span><span style=\\\"color:#6F42C1\\\"> /healthcare</span><span style=\\\"color:#D73A49\\\"> on</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> http:Listener(</span><span style=\\\"color:#005CC5\\\">8290</span><span style=\\\"color:#24292E\\\">) {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> post</span><span style=\\\"color:#6F42C1\\\"> categories</span><span style=\\\"color:#24292E\\\">/[</span><span style=\\\"color:#005CC5\\\">string</span><span style=\\\"color:#E36209\\\"> category</span><span style=\\\"color:#24292E\\\">]/reserve(</span><span style=\\\"color:#E36209\\\">ReservationRequest</span><span style=\\\"color:#E36209\\\"> reservation</span><span style=\\\"color:#24292E\\\">) </span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">           returns</span><span style=\\\"color:#24292E\\\"> ReservationResponse</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">NotFound</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">http:InternalServerError {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        </span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[609288118,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">final</span><span style=\\\"color:#24292E\\\"> http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Client grandOakEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> check</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span><span style=\\\"color:#032F62\\\">\\\"http://localhost:9090/grandoak/categories\\\"</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">final</span><span style=\\\"color:#24292E\\\"> http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Client clemencyEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> check</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span><span style=\\\"color:#032F62\\\">\\\"http://localhost:9090/clemency/categories\\\"</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">final</span><span style=\\\"color:#24292E\\\"> http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Client pineValleyEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> check</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span><span style=\\\"color:#032F62\\\">\\\"http://localhost:9090/pinevalley/categories\\\"</span><span style=\\\"color:#24292E\\\">);</span></span></code></pre>\"],[-177294250,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">service</span><span style=\\\"color:#6F42C1\\\"> /healthcare</span><span style=\\\"color:#D73A49\\\"> on</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> http:Listener(</span><span style=\\\"color:#005CC5\\\">8290</span><span style=\\\"color:#24292E\\\">) {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> post</span><span style=\\\"color:#6F42C1\\\"> categories</span><span style=\\\"color:#24292E\\\">/[</span><span style=\\\"color:#005CC5\\\">string</span><span style=\\\"color:#E36209\\\"> category</span><span style=\\\"color:#24292E\\\">]/reserve(</span><span style=\\\"color:#E36209\\\">ReservationRequest</span><span style=\\\"color:#E36209\\\"> reservation</span><span style=\\\"color:#24292E\\\">)</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">            returns</span><span style=\\\"color:#24292E\\\"> ReservationResponse</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">NotFound</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">http:InternalServerError {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Client hospitalEP;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        match</span><span style=\\\"color:#24292E\\\"> reservation.hospital_id {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            grandoak </span><span style=\\\"color:#D73A49\\\">=></span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">                hospitalEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> grandOakEP;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            clemency </span><span style=\\\"color:#D73A49\\\">=></span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">                hospitalEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> clemencyEP;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            _ </span><span style=\\\"color:#D73A49\\\">=></span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">                hospitalEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> pineValleyEP;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        }</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        ReservationResponse</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">ClientError resp </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> hospitalEP</span><span style=\\\"color:#D73A49\\\">->/</span><span style=\\\"color:#24292E\\\">[category]</span><span style=\\\"color:#D73A49\\\">/</span><span style=\\\"color:#24292E\\\">reserve.</span><span style=\\\"color:#6F42C1\\\">post</span><span style=\\\"color:#24292E\\\">({</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            patient</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> reservation.patient,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            doctor</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> reservation.doctor,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            hospital</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> reservation.hospital,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            appointment_date</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> reservation.appointment_date</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        });</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        if</span><span style=\\\"color:#24292E\\\"> resp </span><span style=\\\"color:#D73A49\\\">is</span><span style=\\\"color:#24292E\\\"> ReservationResponse {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">            return</span><span style=\\\"color:#24292E\\\"> resp;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        }</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        log</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#6F42C1\\\">printError</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#032F62\\\">\\\"Reservation request failed\\\"</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#E36209\\\">resp</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        if</span><span style=\\\"color:#24292E\\\"> resp </span><span style=\\\"color:#D73A49\\\">is</span><span style=\\\"color:#24292E\\\"> http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">ClientRequestError {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">            return</span><span style=\\\"color:#D73A49\\\"> &#x3C;</span><span style=\\\"color:#24292E\\\">http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">NotFound</span><span style=\\\"color:#D73A49\\\">></span><span style=\\\"color:#24292E\\\"> {body</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#032F62\\\"> \\\"Unknown hospital, doctor or category\\\"</span><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        }</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        return</span><span style=\\\"color:#D73A49\\\"> &#x3C;</span><span style=\\\"color:#24292E\\\">http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">InternalServerError</span><span style=\\\"color:#D73A49\\\">></span><span style=\\\"color:#24292E\\\"> {body</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> resp.</span><span style=\\\"color:#6F42C1\\\">message</span><span style=\\\"color:#24292E\\\">()};</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[-935815988,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerina/http;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">import</span><span style=\\\"color:#24292E\\\"> ballerina/log;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">final</span><span style=\\\"color:#24292E\\\"> http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Client grandOakEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> check</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span><span style=\\\"color:#032F62\\\">\\\"http://localhost:9090/grandoak/categories\\\"</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">final</span><span style=\\\"color:#24292E\\\"> http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Client clemencyEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> check</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span><span style=\\\"color:#032F62\\\">\\\"http://localhost:9090/clemency/categories\\\"</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">final</span><span style=\\\"color:#24292E\\\"> http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Client pineValleyEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> check</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span><span style=\\\"color:#032F62\\\">\\\"http://localhost:9090/pinevalley/categories\\\"</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">enum</span><span style=\\\"color:#6F42C1\\\"> HospitalId</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    grandoak</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    clemency</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    pinevalley</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> Patient</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> name;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> dob;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> ssn;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> address;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> phone;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> email;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> Doctor</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> name;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> hospital;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> category;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> availability;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    decimal</span><span style=\\\"color:#24292E\\\"> fee;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> ReservationResponse</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    int</span><span style=\\\"color:#24292E\\\"> appointmentNumber;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Doctor doctor;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Patient patient;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> hospital;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    boolean</span><span style=\\\"color:#24292E\\\"> confirmed;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> appointmentDate;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">type</span><span style=\\\"color:#6F42C1\\\"> ReservationRequest</span><span style=\\\"color:#D73A49\\\"> record</span><span style=\\\"color:#24292E\\\"> {</span><span style=\\\"color:#D73A49\\\">|</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    Patient patient;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> doctor;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    HospitalId hospital_id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> hospital;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    string</span><span style=\\\"color:#24292E\\\"> appointment_date;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">service</span><span style=\\\"color:#6F42C1\\\"> /healthcare</span><span style=\\\"color:#D73A49\\\"> on</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> http:Listener(</span><span style=\\\"color:#005CC5\\\">8290</span><span style=\\\"color:#24292E\\\">) {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">    resource</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> post</span><span style=\\\"color:#6F42C1\\\"> categories</span><span style=\\\"color:#24292E\\\">/[</span><span style=\\\"color:#005CC5\\\">string</span><span style=\\\"color:#E36209\\\"> category</span><span style=\\\"color:#24292E\\\">]/reserve(</span><span style=\\\"color:#E36209\\\">ReservationRequest</span><span style=\\\"color:#E36209\\\"> reservation</span><span style=\\\"color:#24292E\\\">)</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">            returns</span><span style=\\\"color:#24292E\\\"> ReservationResponse</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">NotFound</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">http:InternalServerError {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Client hospitalEP;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        match</span><span style=\\\"color:#24292E\\\"> reservation.hospital_id {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            grandoak </span><span style=\\\"color:#D73A49\\\">=></span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">                hospitalEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> grandOakEP;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            clemency </span><span style=\\\"color:#D73A49\\\">=></span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">                hospitalEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> clemencyEP;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            _ </span><span style=\\\"color:#D73A49\\\">=></span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">                hospitalEP </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> pineValleyEP;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        }</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        ReservationResponse</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">ClientError resp </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> hospitalEP</span><span style=\\\"color:#D73A49\\\">->/</span><span style=\\\"color:#24292E\\\">[category]</span><span style=\\\"color:#D73A49\\\">/</span><span style=\\\"color:#24292E\\\">reserve.</span><span style=\\\"color:#6F42C1\\\">post</span><span style=\\\"color:#24292E\\\">({</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            patient</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> reservation.patient,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            doctor</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> reservation.doctor,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            hospital</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> reservation.hospital,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">            appointment_date</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> reservation.appointment_date</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        });</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        if</span><span style=\\\"color:#24292E\\\"> resp </span><span style=\\\"color:#D73A49\\\">is</span><span style=\\\"color:#24292E\\\"> ReservationResponse {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">            return</span><span style=\\\"color:#24292E\\\"> resp;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        }</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        log</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#6F42C1\\\">printError</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#032F62\\\">\\\"Reservation request failed\\\"</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#E36209\\\">resp</span><span style=\\\"color:#24292E\\\">);</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        if</span><span style=\\\"color:#24292E\\\"> resp </span><span style=\\\"color:#D73A49\\\">is</span><span style=\\\"color:#24292E\\\"> http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">ClientRequestError {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">            return</span><span style=\\\"color:#D73A49\\\"> &#x3C;</span><span style=\\\"color:#24292E\\\">http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">NotFound</span><span style=\\\"color:#D73A49\\\">></span><span style=\\\"color:#24292E\\\"> {body</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#032F62\\\"> \\\"Unknown hospital, doctor or category\\\"</span><span style=\\\"color:#24292E\\\">};</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">        }</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">        return</span><span style=\\\"color:#D73A49\\\"> &#x3C;</span><span style=\\\"color:#24292E\\\">http</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">InternalServerError</span><span style=\\\"color:#D73A49\\\">></span><span style=\\\"color:#24292E\\\"> {body</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\"> resp.</span><span style=\\\"color:#6F42C1\\\">message</span><span style=\\\"color:#24292E\\\">()};</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    }</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"],[784688757,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">{</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"patient\\\"</span><span style=\\\"color:#24292E\\\">: {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"name\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"John Doe\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"dob\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"1940-03-19\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"ssn\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"234-23-525\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"address\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"California\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"phone\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"8770586755\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">        \\\"email\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"johndoe@gmail.com\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">    },</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"doctor\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"thomas collins\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"hospital_id\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"grandoak\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"hospital\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"grand oak community hospital\\\"</span><span style=\\\"color:#24292E\\\">,</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#005CC5\\\">    \\\"appointment_date\\\"</span><span style=\\\"color:#24292E\\\">: </span><span style=\\\"color:#032F62\\\">\\\"2023-10-02\\\"</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">}</span></span></code></pre>\"]]"},"__N_SSG":true}