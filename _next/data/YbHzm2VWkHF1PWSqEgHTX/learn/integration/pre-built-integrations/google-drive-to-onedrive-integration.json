{"pageProps":{"samples":{"code":"<pre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D73A49\">import</span><span style=\"color:#24292E\"> ballerina/log;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">import</span><span style=\"color:#24292E\"> ballerinax/googleapis.drive;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">import</span><span style=\"color:#24292E\"> ballerinax/microsoft.onedrive;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> gDriveAccessToken </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> gDriveFolderId </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> oneDriveAccessToken </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> oneDrivePath </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> boolean</span><span style=\"color:#24292E\"> filesOverridable </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">public</span><span style=\"color:#D73A49\"> function</span><span style=\"color:#6F42C1\"> main</span><span style=\"color:#24292E\">() </span><span style=\"color:#D73A49\">returns</span><span style=\"color:#D73A49\"> error?</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    drive</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">Client gDrive </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#D73A49\"> new</span><span style=\"color:#24292E\"> ({auth</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> {token: gDriveAccessToken}});</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    onedrive</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">Client onedrive </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#D73A49\"> new</span><span style=\"color:#24292E\"> ({auth</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> {token: oneDriveAccessToken}});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> gDriveQuery </span><span style=\"color:#D73A49\">=</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#032F62\"> `'${</span><span style=\"color:#24292E\">gDriveFolderId</span><span style=\"color:#032F62\">}' in parents and trashed = false`</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    stream&#x3C;</span><span style=\"color:#24292E\">drive</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">File</span><span style=\"color:#D73A49\">></span><span style=\"color:#24292E\"> filesInGDrive </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#24292E\"> gDrive</span><span style=\"color:#D73A49\">-></span><span style=\"color:#6F42C1\">getAllFiles</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">gDriveQuery</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    foreach </span><span style=\"color:#24292E\">drive</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">File file </span><span style=\"color:#D73A49\">in</span><span style=\"color:#24292E\"> filesInGDrive {</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">        string</span><span style=\"color:#24292E\">? fileName </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> file?.name;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">        string</span><span style=\"color:#24292E\">? fileId </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> file?.id;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">        boolean</span><span style=\"color:#24292E\"> writable </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> false</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        if</span><span style=\"color:#24292E\"> fileName </span><span style=\"color:#D73A49\">is</span><span style=\"color:#24292E\"> () </span><span style=\"color:#D73A49\">||</span><span style=\"color:#24292E\"> fileId </span><span style=\"color:#D73A49\">is</span><span style=\"color:#24292E\"> () {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            log</span><span style=\"color:#D73A49\">:</span><span style=\"color:#6F42C1\">printError</span><span style=\"color:#24292E\">(</span><span style=\"color:#032F62\">\"File name or ID not found\"</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">            continue</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        }</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        if</span><span style=\"color:#D73A49\"> !</span><span style=\"color:#24292E\">filesOverridable {</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">            boolean</span><span style=\"color:#D73A49\">|error</span><span style=\"color:#24292E\"> isExistingFile </span><span style=\"color:#D73A49\">=</span><span style=\"color:#6F42C1\"> checkIfFileExistsInOneDrive</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">fileName</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">onedrive</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">            if</span><span style=\"color:#24292E\"> isExistingFile </span><span style=\"color:#D73A49\">is</span><span style=\"color:#D73A49\"> error</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">                log</span><span style=\"color:#D73A49\">:</span><span style=\"color:#6F42C1\">printError</span><span style=\"color:#24292E\">(</span><span style=\"color:#032F62\">\"Searching files in Microsoft OneDrive failed!\"</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">isExistingFile</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">                continue</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            writable </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> !</span><span style=\"color:#24292E\">isExistingFile;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        }</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        if</span><span style=\"color:#24292E\"> filesOverridable </span><span style=\"color:#D73A49\">||</span><span style=\"color:#24292E\"> writable {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            drive</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">FileContent</span><span style=\"color:#D73A49\">|error</span><span style=\"color:#24292E\"> fileContent </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> gDrive</span><span style=\"color:#D73A49\">-></span><span style=\"color:#6F42C1\">getFileContent</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">fileId</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">            if</span><span style=\"color:#24292E\"> fileContent </span><span style=\"color:#D73A49\">is</span><span style=\"color:#D73A49\"> error</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">                log</span><span style=\"color:#D73A49\">:</span><span style=\"color:#6F42C1\">printError</span><span style=\"color:#24292E\">(</span><span style=\"color:#032F62\">\"Retrieving file from Google Drive failed!\"</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">fileContent</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">                continue</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            onedrive</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">DriveItemData</span><span style=\"color:#D73A49\">|error</span><span style=\"color:#24292E\"> driveItemData </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> onedrive</span><span style=\"color:#D73A49\">-></span></span>\n<span class=\"line\"><span style=\"color:#6F42C1\">                    uploadFileToFolderByPath</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">oneDrivePath</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">fileName</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">fileContent?</span><span style=\"color:#24292E\">.content,</span></span>\n<span class=\"line\"><span style=\"color:#E36209\">                    fileContent?</span><span style=\"color:#24292E\">.mimeType);</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">            if</span><span style=\"color:#24292E\"> driveItemData </span><span style=\"color:#D73A49\">is</span><span style=\"color:#D73A49\"> error</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">                log</span><span style=\"color:#D73A49\">:</span><span style=\"color:#6F42C1\">printError</span><span style=\"color:#24292E\">(</span><span style=\"color:#032F62\">\"Uploading file to Microsoft OneDrive failed!\"</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">driveItemData</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">                continue</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            log</span><span style=\"color:#D73A49\">:</span><span style=\"color:#6F42C1\">printInfo</span><span style=\"color:#24292E\">(</span><span style=\"color:#005CC5\">string</span><span style=\"color:#032F62\"> `File ${</span><span style=\"color:#24292E\">fileName</span><span style=\"color:#032F62\">} uploaded successfully!`</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">}</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">isolated</span><span style=\"color:#D73A49\"> function</span><span style=\"color:#6F42C1\"> checkIfFileExistsInOneDrive</span><span style=\"color:#24292E\">(</span><span style=\"color:#005CC5\">string</span><span style=\"color:#E36209\"> fileName</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">onedrive</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">Client onedriveEndpoint) </span><span style=\"color:#D73A49\">returns</span><span style=\"color:#005CC5\"> boolean</span><span style=\"color:#D73A49\">|error</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    stream&#x3C;</span><span style=\"color:#24292E\">onedrive</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">DriveItemData, onedrive</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">Error?</span><span style=\"color:#D73A49\">></span><span style=\"color:#24292E\"> searchDriveItems </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#24292E\"> onedriveEndpoint</span><span style=\"color:#D73A49\">-></span><span style=\"color:#6F42C1\">searchDriveItems</span><span style=\"color:#24292E\">(</span></span>\n<span class=\"line\"><span style=\"color:#E36209\">        fileName</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    return</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#24292E\"> searchDriveItems.</span><span style=\"color:#6F42C1\">next</span><span style=\"color:#24292E\">() </span><span style=\"color:#D73A49\">!is</span><span style=\"color:#24292E\"> ();</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">}</span></span></code></pre>"},"content":"\nimport ballerina/log;\nimport ballerinax/googleapis.drive;\nimport ballerinax/microsoft.onedrive;\n\nconfigurable string gDriveAccessToken = ?;\nconfigurable string gDriveFolderId = ?;\n\nconfigurable string oneDriveAccessToken = ?;\nconfigurable string oneDrivePath = ?;\n\nconfigurable boolean filesOverridable = ?;\n\npublic function main() returns error? {\n    drive:Client gDrive = check new ({auth: {token: gDriveAccessToken}});\n    onedrive:Client onedrive = check new ({auth: {token: oneDriveAccessToken}});\n\n    string gDriveQuery = string `'${gDriveFolderId}' in parents and trashed = false`;\n    stream<drive:File> filesInGDrive = check gDrive->getAllFiles(gDriveQuery);\n\n    foreach drive:File file in filesInGDrive {\n        string? fileName = file?.name;\n        string? fileId = file?.id;\n        boolean writable = false;\n\n        if fileName is () || fileId is () {\n            log:printError(\"File name or ID not found\");\n            continue;\n        }\n        if !filesOverridable {\n            boolean|error isExistingFile = checkIfFileExistsInOneDrive(fileName, onedrive);\n            if isExistingFile is error {\n                log:printError(\"Searching files in Microsoft OneDrive failed!\", isExistingFile);\n                continue;\n            }\n            writable = !isExistingFile;\n        }\n        if filesOverridable || writable {\n            drive:FileContent|error fileContent = gDrive->getFileContent(fileId);\n            if fileContent is error {\n                log:printError(\"Retrieving file from Google Drive failed!\", fileContent);\n                continue;\n            }\n            onedrive:DriveItemData|error driveItemData = onedrive->\n                    uploadFileToFolderByPath(oneDrivePath, fileName, fileContent?.content,\n                    fileContent?.mimeType);\n            if driveItemData is error {\n                log:printError(\"Uploading file to Microsoft OneDrive failed!\", driveItemData);\n                continue;\n            }\n            log:printInfo(string `File ${fileName} uploaded successfully!`);\n        }\n    }\n}\n\nisolated function checkIfFileExistsInOneDrive(string fileName, onedrive:Client onedriveEndpoint) returns boolean|error {\n    stream<onedrive:DriveItemData, onedrive:Error?> searchDriveItems = check onedriveEndpoint->searchDriveItems(\n        fileName);\n    return check searchDriveItems.next() !is ();\n}\n\n"},"__N_SSG":true}