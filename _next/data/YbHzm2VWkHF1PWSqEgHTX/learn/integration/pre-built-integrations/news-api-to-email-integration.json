{"pageProps":{"samples":{"code":"<pre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D73A49\">import</span><span style=\"color:#24292E\"> ballerina/email;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">import</span><span style=\"color:#24292E\"> ballerina/log;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">import</span><span style=\"color:#24292E\"> ballerinax/newsapi;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// News API configuration</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#24292E\"> newsapi</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">ApiKeysConfig apiKeyConfig </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Email client configuration parameters</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> smtpPassword </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> smtpUsername </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> smtpHost </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#6A737D\">// Email configuration parameters</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> fromAddress </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">configurable</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> emailAddress </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> ?</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">public</span><span style=\"color:#D73A49\"> function</span><span style=\"color:#6F42C1\"> main</span><span style=\"color:#24292E\">() </span><span style=\"color:#D73A49\">returns</span><span style=\"color:#D73A49\"> error?</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    newsapi</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">Client newsapi </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#D73A49\"> new</span><span style=\"color:#24292E\"> (</span><span style=\"color:#E36209\">apiKeyConfig</span><span style=\"color:#24292E\">, {}, </span><span style=\"color:#032F62\">\"https://newsapi.org/v2\"</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    email</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">SmtpClient email </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#D73A49\"> new</span><span style=\"color:#24292E\"> (</span><span style=\"color:#E36209\">smtpHost</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">smtpUsername</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">smtpPassword</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    newsapi</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">WSNewsTopHeadlineResponse topHeadlines </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#24292E\"> newsapi</span><span style=\"color:#D73A49\">-></span><span style=\"color:#6F42C1\">listTopHeadlines</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">sources</span><span style=\"color:#D73A49\"> =</span><span style=\"color:#032F62\"> \"bbc-news\"</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">page</span><span style=\"color:#D73A49\"> =</span><span style=\"color:#005CC5\"> 1</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    newsapi</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">WSNewsArticle[]? articles </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> topHeadlines?.articles;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    if</span><span style=\"color:#24292E\"> articles </span><span style=\"color:#D73A49\">is</span><span style=\"color:#24292E\"> () </span><span style=\"color:#D73A49\">||</span><span style=\"color:#24292E\"> articles.</span><span style=\"color:#6F42C1\">length</span><span style=\"color:#24292E\">() </span><span style=\"color:#D73A49\">==</span><span style=\"color:#005CC5\"> 0</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        log</span><span style=\"color:#D73A49\">:</span><span style=\"color:#6F42C1\">printInfo</span><span style=\"color:#24292E\">(</span><span style=\"color:#032F62\">\"No news found\"</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        return</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    }</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> mailBody </span><span style=\"color:#D73A49\">=</span><span style=\"color:#032F62\"> \"BBC top news are</span><span style=\"color:#B31D28;font-style:italic\">,</span></span>\n<span class=\"line\"><span style=\"color:#032F62\">\"</span><span style=\"color:#B31D28;font-style:italic\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    foreach </span><span style=\"color:#24292E\">newsapi</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">WSNewsArticle article </span><span style=\"color:#D73A49\">in</span><span style=\"color:#24292E\"> articles {</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">        string</span><span style=\"color:#24292E\">? title </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> article?.title;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        if</span><span style=\"color:#24292E\"> title </span><span style=\"color:#D73A49\">is</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            mailBody </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> mailBody </span><span style=\"color:#D73A49\">+</span><span style=\"color:#005CC5\"> string</span><span style=\"color:#032F62\"> `${</span><span style=\"color:#24292E\">title</span><span style=\"color:#032F62\">}${\"</span></span>\n<span class=\"line\"><span style=\"color:#032F62\">\"}`</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    email</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">Message message </span><span style=\"color:#D73A49\">=</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        to</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> emailAddress,</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        'from</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> fromAddress,</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        subject</span><span style=\"color:#D73A49\">:</span><span style=\"color:#032F62\"> \"BBC Headlines\"</span><span style=\"color:#24292E\">,</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        body</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\"> mailBody</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    };</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    check</span><span style=\"color:#24292E\"> email</span><span style=\"color:#D73A49\">-></span><span style=\"color:#6F42C1\">sendMessage</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">message</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    log</span><span style=\"color:#D73A49\">:</span><span style=\"color:#6F42C1\">printInfo</span><span style=\"color:#24292E\">(</span><span style=\"color:#032F62\">\"Email sent successfully!\"</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">}</span></span></code></pre>"},"content":"\nimport ballerina/email;\nimport ballerina/log;\nimport ballerinax/newsapi;\n\n// News API configuration\nconfigurable newsapi:ApiKeysConfig apiKeyConfig = ?;\n\n// Email client configuration parameters\nconfigurable string smtpPassword = ?;\nconfigurable string smtpUsername = ?;\nconfigurable string smtpHost = ?;\n\n// Email configuration parameters\nconfigurable string fromAddress = ?;\nconfigurable string emailAddress = ?;\n\npublic function main() returns error? {\n    newsapi:Client newsapi = check new (apiKeyConfig, {}, \"https://newsapi.org/v2\");\n    email:SmtpClient email = check new (smtpHost, smtpUsername, smtpPassword);\n    newsapi:WSNewsTopHeadlineResponse topHeadlines = check newsapi->listTopHeadlines(sources = \"bbc-news\", page = 1);\n    newsapi:WSNewsArticle[]? articles = topHeadlines?.articles;\n    if articles is () || articles.length() == 0 {\n        log:printInfo(\"No news found\");\n        return;\n    }\n    string mailBody = \"BBC top news are,\n\";\n    foreach newsapi:WSNewsArticle article in articles {\n        string? title = article?.title;\n        if title is string {\n            mailBody = mailBody + string `${title}${\"\n\"}`;\n        }\n    }\n    email:Message message = {\n        to: emailAddress,\n        'from: fromAddress,\n        subject: \"BBC Headlines\",\n        body: mailBody\n    };\n    check email->sendMessage(message);\n    log:printInfo(\"Email sent successfully!\");\n}  \n"},"__N_SSG":true}