{"pageProps":{"tagline":"Filter uninterested messages","desc":"Message filter neglects the uninterested messages based on criteria and publishes the filtered message to another channel.","category":"Message Routing","index":25,"helps":"Ballerina enables filtering messages using basic control structures such as if and switch statements.","tags":["Message Filter","Message Channel","Message Endpoint"],"link":"https://www.enterpriseintegrationpatterns.com/patterns/messaging/Filter.html","content":[{"headerCode":"<pre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color:#D73A49\">import</span><span style=\"color:#24292E\"> ballerina/http;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">type</span><span style=\"color:#6F42C1\"> Ticket</span><span style=\"color:#D73A49\"> record</span><span style=\"color:#24292E\"> {</span><span style=\"color:#D73A49\">|</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> id;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> url;</span></span>\n<span class=\"line\"><span style=\"color:#005CC5\">    string</span><span style=\"color:#24292E\"> subject;</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    HIGH_PRIORITY</span><span style=\"color:#D73A49\">|</span><span style=\"color:#24292E\">MEDUIM_PRIORITY</span><span style=\"color:#D73A49\">|</span><span style=\"color:#24292E\">LOW_PRIORITY priority;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">|</span><span style=\"color:#24292E\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">const </span><span style=\"color:#005CC5\">HIGH_PRIORITY</span><span style=\"color:#D73A49\"> =</span><span style=\"color:#005CC5\"> 1</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">const </span><span style=\"color:#005CC5\">MEDUIM_PRIORITY</span><span style=\"color:#D73A49\"> =</span><span style=\"color:#005CC5\"> 2</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">const </span><span style=\"color:#005CC5\">LOW_PRIORITY</span><span style=\"color:#D73A49\"> =</span><span style=\"color:#005CC5\"> 3</span><span style=\"color:#24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">final</span><span style=\"color:#24292E\"> http</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">Client notificationChannel </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#D73A49\"> new</span><span style=\"color:#24292E\"> (</span><span style=\"color:#032F62\">\"http://api.notification.channel.com.balmock.io\"</span><span style=\"color:#24292E\">);</span></span>\n<span class=\"line\"></span></code></pre>","mainCode":"<pre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"><code><span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">service</span><span style=\"color:#6F42C1\"> /api/v1</span><span style=\"color:#D73A49\"> on</span><span style=\"color:#D73A49\"> new</span><span style=\"color:#24292E\"> http:Listener(</span><span style=\"color:#005CC5\">8080</span><span style=\"color:#24292E\">) {</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color:#D73A49\">    resource</span><span style=\"color:#D73A49\"> function</span><span style=\"color:#6F42C1\"> post</span><span style=\"color:#6F42C1\"> ticket</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">Ticket</span><span style=\"color:#E36209\"> ticket</span><span style=\"color:#24292E\">) </span><span style=\"color:#D73A49\">returns</span><span style=\"color:#D73A49\"> error?</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#D73A49\">        if</span><span style=\"color:#24292E\"> ticket.priority </span><span style=\"color:#D73A49\">==</span><span style=\"color:#005CC5\"> 1</span><span style=\"color:#24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">            _ </span><span style=\"color:#D73A49\">=</span><span style=\"color:#D73A49\"> check</span><span style=\"color:#24292E\"> notificationChannel</span><span style=\"color:#D73A49\">->/</span><span style=\"color:#24292E\">email</span><span style=\"color:#D73A49\">/</span><span style=\"color:#24292E\">notify.</span><span style=\"color:#6F42C1\">post</span><span style=\"color:#24292E\">(</span><span style=\"color:#E36209\">ticket</span><span style=\"color:#24292E\">, </span><span style=\"color:#E36209\">targetType</span><span style=\"color:#D73A49\"> =</span><span style=\"color:#24292E\"> http</span><span style=\"color:#D73A49\">:</span><span style=\"color:#24292E\">Response);</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">        }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">    }</span></span>\n<span class=\"line\"><span style=\"color:#24292E\">}</span></span>\n<span class=\"line\"></span></code></pre>","raw":"import ballerina/http;\n\ntype Ticket record {|\n    string id;\n    string url;\n    string subject;\n    HIGH_PRIORITY|MEDUIM_PRIORITY|LOW_PRIORITY priority;\n|};\n\nconst HIGH_PRIORITY = 1;\nconst MEDUIM_PRIORITY = 2;\nconst LOW_PRIORITY = 3;\n\nfinal http:Client notificationChannel = check new (\"http://api.notification.channel.com.balmock.io\");\n\nservice /api/v1 on new http:Listener(8080) {\n\n    resource function post ticket(Ticket ticket) returns error? {\n        if ticket.priority == 1 {\n            _ = check notificationChannel->/email/notify.post(ticket, targetType = http:Response);\n        }\n    }\n}\n","name":"message-filter.bal"}],"name":" Message Filter"},"__N_SSG":true}