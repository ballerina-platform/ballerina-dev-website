{"pageProps":{"frontmatter":{"layout":"ballerina-left-nav-release-notes","title":"Swan Lake Alpha4","permalink":"/downloads/swan-lake-release-notes/swan-lake-alpha4/","active":"swan-lake-alpha4","redirect_from":["/downloads/release-notes/swan-lake-alpha4"]},"content":"### Overview of Ballerina Swan Lake Alpha4\n\n<em>This is the fourth Alpha release in a series of planned Alpha and Beta releases leading up to the Ballerina Swan Lake GA release.</em> \n\nIt introduces the new language features planned for the Swan Lake GA release and includes improvements and bug fixes done to the compiler, runtime, standard library, and developer tooling after the Swan Lake Alpha3 release.\n\n- [Updating Ballerina](#updating-ballerina)\n- [Installing Ballerina](#installing-ballerina)\n- [Language Updates](#language-updates)\n- [Runtime Updates](#runtime-updates)\n- [Standard Library Updates](#standard-library-updates)\n- [Developer Tools Updates](#developer-tools-updates)\n- [Observability Updates](#observability-updates)\n\n### Updating Ballerina\n\nIf you are already using Ballerina, you can use the [update tool](/learn/cli-documentation/update-tool/) to directly update to Ballerina Swan Lake Alpha4 as follows. \n\nTo do this, first, execute the command below to get the update tool updated to its latest version. \n\n> `bal update`\n\nIf you are using an **update tool version below 0.8.14**, execute the `ballerina update` command to update it. Next, execute the command below to update to Swan Lake Alpha4.\n\n> `bal dist pull slalpha4`\n\n### Installing Ballerina\n\nIf you have not installed Ballerina, then download the [installers](/downloads/#swanlake) to install.\n\n### Language updates\n\n#### New features\n\n##### Relational expressions with all ordered types\n\nRelational expressions (`<`, `>`, `<=`, and `>=`) are supported with all [ordered types](https://ballerina.io/spec/lang/draft/v2020-12-17/#ordering). The static type of both operands must belong to the same ordered type.\n\n##### Inferring the argument of a dependently-typed function from the contextually-expected type\n\nWhen the default value of a `typedesc` parameter of a dependently-typed function is `<>` and an argument is not provided for the parameter when calling the function, the argument will be inferred from the contextually-expected type of the function call.\n\n```ballerina\nfunction func(typedesc<anydata> td = <>) returns td = external;\n\npublic function main() {\n    // The argument for `td` is inferred to be `int`.\n    int value = func();\n}\n```\n\n#### Improvements\n\n##### Improvements to dependently-typed lang library functions to infer the argument from the contextually-expected type\n\n- The `lang:value:ensureType` lang library function is now dependently-typed.\n\n- The `typedesc` argument of the `lang.value:cloneWithType`, `lang.value:fromJsonWithType`, `lang.value:fromJsonStringWithType`, and `lang.value:ensureType` dependently-typed lang library functions will be inferred from the contextually-expected type if it is not passed as an argument.\n\n    ```ballerina\n    import ballerina/io;\n\n    type Person record {|\n        string name;\n        int age;\n    |};\n\n    public function main() {\n        map<anydata> anydataMap = {name: \"Amy\", age: 30};\n\n        // The `typedesc` argument is inferred to be `Person`\n        // based on the contextually expected type.\n        Person|error result = anydataMap.cloneWithType();\n        io:println(result is Person); // Prints `true`.\n    }\n    ```\n\n##### Improvements to the return type of `lang.value:cloneReadOnly`\n\nChanged the return type of the `lang.value:cloneReadOnly` lang library function from the type of the value (`T`) to the intersection of the type and `readonly` (`T & readonly`).\n\n```ballerina\ntype Person record {|\n    string name;\n    int age;\n|};\n\npublic function main() {\n    Person mutablePerson = {name: \"Amy\", age: 30};\n\n    // The result of `cloneReadOnly()` can be directly assigned\n    // to a variable of type `Person & readonly`.\n    Person & readonly immutablePerson = mutablePerson.cloneReadOnly();\n}\n```\n\n##### Changes to the return types of `lang.value:fromJsonFloatString` and `lang.value:fromJsonDecimalString`\n\nChanged the return types of the `lang.value:fromJsonFloatString` and `lang.value:fromJsonDecimalString` lang library functions from `json` to `lang.value:JsonFloat` and `lang.value:JsonDecimal` respectively.\n\n#### Breaking changes\n\n- A compilation error occurs if the inferred type of an unused variable that is declared with `var` includes a subtype of the `error` type.\n- Removed the `error<*>` syntax.\n- Removed support for relational expressions with numeric values when the static types of the operands belong to different ordered types.\n- The `lang.array:indexOf` and `lang.array:lastIndexOf` lang library functions cannot be used with values that do not belong to `anydata`.\n- An object used as the iterable value in a `foreach` statement, `from` clause, or `join` clause must be a subtype of `object:Iterable`.\n- The `RawTemplate` type is distinct now.\n- The filler value of the `decimal` type is now `+0d`.\n- Changed the completion type `C` in `stream<T, C>` from `error|never` to `error?`. `stream<T>` is equivalent to `stream<T, ()>`. `stream<T>` and `stream<T, error>` are assignable to `stream<T, error?>`.\n- Annotations with the `service` attach point cannot be used with service classes.\n- Checking keywords (`check` and `checkpanic`) are allowed in a statement only if the statement is a call statement (i.e., when the expression is a function or method call).\n- Lowered the precedence of the `trap` expression.\n\n#### Bug fixes\n\nTo view bug fixes, see the [GitHub milestone for Swan Lake Alpha4](https://github.com/ballerina-platform/ballerina-lang/issues?q=is%3Aissue+is%3Aclosed+milestone%3A%22Ballerina+Swan+Lake+-+Alpha4%22+label%3AType%2FBug+label%3ATeam%2FCompilerFE).\n\n### Runtime updates\n\n#### New features\n\n##### Providing values for configurable variables via command-line arguments\n\nConfigurable values can be provided with the built-in command-line option `-C`.\n\n```bash\n-Ckey=value\n```\n\n**Key syntax:**\n\n```bash\nkey:= [[org-name .] module-name .] variable\n```\n\nCommand-line arguments are supported for configurable variables with `boolean`, `int`, `float`, `decimal`, `string`, and `xml` types.\n\n```ballerina\nconfigurable int port = ?;\n```\n\n**Example usages:**\n\n- If the configurable variable is defined in the default module or if a single Ballerina file is being used:\n\n    ```bash\n    bal run -- -Cport=9090\n    bal run program.bal -- -Cport=9090\n    java -jar executable.jar -Cport=9090 \n    ```\n\n- If the configurable variable is defined in a different module of the same organization:\n\n    ```bash\n    bal run -- -Cmodule-name.port=9090\n    java -jar executable.jar -Cmodule-name.port=9090 \n    ```\n\n- If the configurable variable is defined in a module of a different organization.\n\n    ```bash\n    bal run -- -Corg-name.module-name.port=9090 \n    java -jar executable.jar -Corg-name.module-name.port=9090 \n    ```\n\n##### Locating multiple TOML files\n\nConfigurable values can be provided in multiple TOML files using the `BAL_CONFIG_FILES` environment variable.\n\nThe file locations can be specified in the environment variable using an OS-specific separator. The precedence order will be determined by the order in which the files are specified in the environment variable. If such an environment variable is not specified, the file located in the current directory with the file name `Config.toml` will be used.\n\n##### Providing TOML content via environment variables\n\nThe configurable values can be provided using the `BAL_CONFIG_DATA` environment variable in which the content is expected to be in the TOML (v0.4) format.\n\n#### Bug fixes\n\nTo view bug fixes, see the [GitHub milestone for Swan Lake Alpha4](https://github.com/ballerina-platform/ballerina-lang/issues?q=is%3Aissue+is%3Aclosed+milestone%3A%22Ballerina+Swan+Lake+-+Alpha4%22+label%3AType%2FBug+label%3ATeam%2FjBallerina).\n\n### Standard library updates\n      \n#### Improvements\n\n##### `time` package \n\nIntroduced the following APIs to support email-typed string conversions:\n\n- Converts a given UTC to an email string.\n\n```ballerina\nimport ballerina/time; \n             \nstring emailFormattedString = time:utcToEmailString(time:utcNow());\n```\n\n- Converts a given `time:Civil` to an email string.\n\n```ballerina\nimport ballerina/time; \n       \ntime:Civil civil = check time:civilFromString(\"2021-04-12T23:20:50.520+05:30[Asia/Colombo]\");\nstring|time:Error emailDateTime = time:civilToEmailString(civil, \"GMT\");\n```\n\n- Converts a given email string to `time:Civil`.\n\n```ballerina\nimport ballerina/time; \n       \ntime:Civil|time:Error emailDateTime = time:civilFromEmailString(\"Wed, 10 Mar 2021 19:51:55 -0820\");\n```\n\n##### `io` package \n\n- Improved the print APIs to support string templates.\n\n```ballerina\nimport ballerina/io;\nstring val = \"John\";\nio:println(`Hello ${val}!!!`);\nio:print(`Hello ${val}!!!`);\n```\n\n- Changed streaming APIs to be completed from `nil` return. \n\n##### `mysql` package\n\n- Changed the previous `SSLConfig` Record to `SecureSocket` Record.\n\n```ballerina\npublic type SecureSocket record {|\n    SSLMode mode = SSL_PREFERRED;\n    crypto:KeyStore key?;\n    crypto:TrustStore cert?;\n|};\n```\n\n- Changed the SSLMode value from `SSL_VERIFY_CERT` to `SSL_VERIFY_CA`.\n\n##### `xmldata` package \n\nUpdated the API to convert a JSON to an XML to be supported by the `nil` return value.\n\n```ballerina\nimport ballerina/xmldata;\njson data = {\n    name: \"John\"\n};\nxml?|Error x = xmldata:fromJson(data);\n```\n\n##### `java.arrays` package \n\nRenamed the `java.arrays` package’s org and package names as `ballerina` and `jballerina.java.arrays`. \n\n```ballerina\nimport ballerina/jballerina.java.arrays;\nhandle secondWord = arrays:get(input, 1);\n```\n\n##### `websub` package \n\nAdded pre-built constants for WebSub common-responses.\n\n```ballerina\n   @websub:SubscriberServiceConfig {\n        target: [\"https://sample.hub\", \"https://sample.topic.one\"], \n        leaseSeconds: 36000,\n        secret: \"secretKey\"\n    } \n    service /subscriber on new websub:Listener(9090) {\n        remote function onSubscriptionValidationDenied(websub:SubscriptionDeniedError msg) \n                       returns websub:Acknowledgement? {\n            // implement subscription validation denied logic here\n            return websub:ACKNOWLEDGEMENT;\n        }\n\n        remote function onSubscriptionVerification(websub:SubscriptionVerification msg)\n                        returns websub:SubscriptionVerificationSuccess|websub:SubscriptionVerificationError {\n            // implement subscription intent verification logic here\n            return websub:SUBSCRIPTION_VERIFICATION_SUCCESS;\n        }\n\n        remote function onEventNotification(websub:ContentDistributionMessage event) \n                        returns websub:Acknowledgement|websub:SubscriptionDeletedError? {\n            // implement on event notification logic here\n            return websub:ACKNOWLEDGEMENT;\n        }\n    }\n\n```\n\n##### `kafka` package \n\n- Updated the `SecureSocket` record.\n\n- Updated the `init` methods of the `kafka:Producer`, `kafka:Consumer`, and `kafka:Listener` classes.\n\n```ballerina\nkafka:Producer kafkaProducer = check new(kafka:DEFAULT_URL, config);\nkafka:Producer kafkaProducer = check new (bootstrapServers=”localhost:9092”);\nkafka:Producer kafkaProducer = check new(”localhost:9092”);\n// Same for listener and consumer initialization\n```\n\n##### `nats` package \n\nUpdated the `init` methods of the client and listener.\n\n```ballerina\nnats:Client client = check new(url=”http://google.com:9090”, ssl=config);\nnats:Client client = check new(nats:DEFAULT_URL);\nnats:Client client = check new(”http://google.com:9090”);\n// Same for listener initialization\n```\n\n##### `stan` package \n\nUpdated the `init` methods of the client and listener.\n\n```ballerina\nstan:Client client = check new(url=”http://localhost:9090”);\nnats:Client client = check new(nats:DEFAULT_URL);\n// Same for listener initialization\n```\n\n##### `rabbitmq` package \n\nUpdated the  `init` methods of the client and listener.\n\n```ballerina\nrabbitmq:Client client = check new(host=”localhost”, port=9090);\nrabbitmq:Client client = check new(rabbitmq:DEFAULT_HOST, rabbitmq:DEFAULT_PORT);\nrabbitmq:Client client = check new(”localhost”, 9090);\n// Same for listener initialization\n```\n\n#### Security updates\n\nRemoved encrypted passwords and hashed passwords support for Basic Auth file user store authentication.\n\n#### Bug fixes\n\nTo view bug fixes, see the [GitHub milestone for Swan Lake Alpha4](https://github.com/ballerina-platform/ballerina-standard-library/issues?q=is%3Aclosed+is%3Aissue+milestone%3A%22Swan+Lake+Alpha4%22+label%3AType%2FBug).\n\n### Developer tools updates\n\n#### Bug fixes\n\nTo view bug fixes, see the GitHub milestone for Swan Lake Alpha4 of the repositories below.\n\n- [Language](https://github.com/ballerina-platform/ballerina-lang/issues?q=is%3Aissue+is%3Aclosed+milestone%3A%22Ballerina+Swan+Lake+-+Alpha4%22+label%3AType%2FBug+label%3ATeam%2FDevTools)\n- [OpenAPI](https://github.com/ballerina-platform/ballerina-openapi/issues?q=is%3Aissue+is%3Aclosed+milestone%3A%22Ballerina+Swan+Lake+-+Alpha4%22) \n\n#### Language server \n\nTo view bug fixes, see the [GitHub milestone for Swan Lake Alpha4](https://github.com/ballerina-platform/ballerina-lang/issues?q=is%3Aissue+is%3Aclosed+milestone%3A%22Ballerina+Swan+Lake+-+Alpha4%22+label%3AType%2FBug+label%3ATeam%2FLanguageServer).\n\n### Observability updates\n\n- Introduced the open-telemetry standard for Ballerina tracing instead of open-tracing\n- Updated the Jaeger extension to support open-telemetry\n\n\n\n","id":"swan-lake-alpha4"},"__N_SSG":true}