{"pageProps":{"frontmatter":{},"content":"# Specification: Ballerina Task Library\n\n_Owners_: @daneshk @kalaiyarasiganeshalingam                                      \n_Reviewers_: @daneshk  \n_Created_: 2021/12/12  \n_Updated_: 2022/02/17  \n_Edition_: Swan Lake  \n\n## Introduction\nThis is the specification for the Task standard library of [Ballerina language](https://ballerina.io/), which provides APIs to schedule a Ballerina job either once or periodically and manage the execution of those jobs.\n\nThe Task library specification has evolved and may continue to evolve in the future. The released versions of the specification can be found under the relevant GitHub tag.\n\nIf you have any feedback or suggestions about the library, start a discussion via a [GitHub issue](https://github.com/ballerina-platform/ballerina-standard-library/issues) or in the [Discord server](https://discord.gg/ballerinalang). Based on the outcome of the discussion, the specification and implementation can be updated. Community feedback is always welcome. Any accepted proposal, which affects the specification is stored under `/docs/proposals`. Proposals under discussion can be found with the label `type/proposal` in GitHub.\n\nThe conforming implementation of the specification is released and included in the distribution. Any deviation from the specification is considered a bug.\n\n## Contents\n1. [Overview](#1-overview)\n2. [Job](#2-job)\n3. [Worker Pool and Waiting Time](#3-worker-pool-and-waiting-time)\n4. [Job Scheduling](#4-job-scheduling)\n5. [Manage Scheduled Jobs](#5-manage-scheduled-jobs)\n    * 5.1. [Pause All Jobs](#51-pause-all-jobs)\n    * 5.2. [Resume All Jobs](#52-resume-all-jobs)\n    * 5.3. [Pause Job](#53-pause-job)\n    * 5.4. [Resume Job](#54-resume-job)\n    * 5.5. [Get Running Jobs](#55-get-running-jobs)\n6. [Unschedule a Particular Scheduled Job](#6-unschedule-a-particular-scheduled-job)\n\n## 1. Overview\nThis specification elaborates on the functionalities available in the Task library.\n\nThis library provides APIs based on the following category:\n- Job\n- Worker Pool and Waiting time\n- Schedule Jobs\n- Manage Job\n- UnSchedule Job\n\n## 2. Job\nThe Ballerina Job object provides the abstraction for a job instance, which execution() method will be executed by triggering the task. Hence, Users have to create a class with custom logic and pass it to schedule a job. \n```ballerina\npublic type Job object {\n\n  # Executes by the Scheduler when the scheduled trigger fires.\n  public function execute();\n};\n```\n\n## 3. Worker Pool and Waiting Time\n\nThe worker pool provides a set of threads for tasks to use when executing Jobs. If more threads are in the pool, the greater number of jobs can be run concurrently. The waiting time is the number of seconds as a decimal. The scheduler will tolerate this period before being considered as `ignored the trigger`. The following API provides to manage these configurations:\n```ballerina\npublic isolated function configureWorkerPool(int workerCount = 5, time:Seconds waitingTime = 5) returns Error?\n```\n\n## 4. Job Scheduling\n\nThe package has two scheduling systems to schedule the job:\n\n- **One-time Job Execution**\n\n  Schedule the given Ballerina job at a specified date and time. Once scheduled, it will return a `JobId` which can be used to manage the job.\n  ```ballerina\n   public isolated function scheduleOneTimeJob(Job job, time:Civil triggerTime) returns JobId|Error\n  ```\n- **Frequency-based Job Execution**\n  \n  Schedule the recurring Ballerina job according to the given duration. Once scheduled, it will return the job ID, which can be used to manage the job.\n  Users can configure the following configurations to create different triggers.\n    - Interval: The duration of the trigger (in seconds), which is used to run the job frequently\n    - maxCount: The maximum number of trigger counts\n    - startTime: The start time of the trigger is in Ballerina `time:Civil`. If it is not provided, a trigger will start immediately\n    - endTime: The end time of the trigger is in Ballerina `time:Civil`\n    - taskPolicy: The policy, which is used to handle the error and will be waiting during the trigger time\n        ```ballerina\n        public isolated function scheduleJobRecurByFrequency(Job job,  decimal interval,  int maxCount = -1, time:Civil? startTime = (), time:Civil? endTime = (), TaskPolicy taskPolicy = {}) returns JobId|Error\n        ```\n**Task Policy**\n\nThis package provides the following two policies to manage triggers:\n\n- **Error Policy**\n  \n  This policy is used to give instruction on what to do when there is an error by executing `Job` by the trigger. \n  Users can use one of the policies to handle the error.\n  - LOG_AND_TERMINATE: This is used to log that error message and unschedule that job from the scheduler.\n  - LOG_AND_CONTINUE: This is used to log that error message and continue that job.\n  - TERMINATE: This is used to unschedule that job from the scheduler without logging that message.\n  - CONTINUE: This is used to continue that job without logging that message.\n    \n- **Waiting Policy**\n\n  The policy is used to give instruction on what to do when the task is triggering while the resource is not available/enough to run this task.\n  Users can use one of the policies to execute the pending job.\n    - WAIT: The pending task will wait until getting the resources to execute that job.\n    - IGNORE: Ignore the pending task\n    - LOG_AND_IGNORE: Log and ignore the pending task\n\n## 5. Manage Scheduled Jobs\n\nThe following APIs provide by this package to manage the scheduled jobs.\n\n### 5.1. Pause All Jobs\nThe following API is used to pause all the jobs.\n```ballerina\npublic isolated function pauseAllJobs() returns Error?\n```\n### 5.2. Resume All Jobs\nThe following API is used to resume all the jobs.\n```ballerina\npublic isolated function resumeAllJobs() returns Error?\n```\n### 5.3. Pause Job\nThe following API is used to pause all the jobs.\n```ballerina\npublic isolated function pauseJob(JobId jobId) returns Error?\n```\n### 5.4. Resume Job\nThe following API is used to resume all the jobs.\n```ballerina\npublic isolated function resumeJob(JobId jobId) returns Error?\n```\n### 5.5. Get Running Jobs\nThe following API is used to get all the running jobs.\n```ballerina\npublic isolated function getRunningJobs() returns JobId[]\n```\n\n## 6. Unschedule a Particular Scheduled Job\nUnschedule the `Job`, which is associated with the given job ID. If no job is running in \nthe scheduler, the scheduler will be shut down automatically.\n```ballerina\npublic isolated function unscheduleJob(JobId jobId) returns Error?\n```","codeSnippets":"[[641412293,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> type</span><span style=\\\"color:#6F42C1\\\"> Job</span><span style=\\\"color:#D73A49\\\"> object</span><span style=\\\"color:#24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#6A737D\\\">  # Executes by the Scheduler when the scheduled trigger fires.</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">  public</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> execute</span><span style=\\\"color:#24292E\\\">();</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">};</span></span></code></pre>\"],[608508239,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> isolated</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> configureWorkerPool</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#005CC5\\\">int</span><span style=\\\"color:#E36209\\\"> workerCount</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#005CC5\\\"> 5</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#E36209\\\">time</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Seconds waitingTime </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#005CC5\\\"> 5</span><span style=\\\"color:#24292E\\\">) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> Error</span><span style=\\\"color:#D73A49\\\">?</span></span></code></pre>\"],[1048271878,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> isolated</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> scheduleOneTimeJob</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">Job</span><span style=\\\"color:#E36209\\\"> job</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#E36209\\\">time</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Civil triggerTime) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> JobId</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">Error</span></span></code></pre>\"],[-1498168151,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> isolated</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> scheduleJobRecurByFrequency</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">Job</span><span style=\\\"color:#E36209\\\"> job</span><span style=\\\"color:#24292E\\\">,  </span><span style=\\\"color:#005CC5\\\">decimal</span><span style=\\\"color:#E36209\\\"> interval</span><span style=\\\"color:#24292E\\\">,  </span><span style=\\\"color:#005CC5\\\">int</span><span style=\\\"color:#E36209\\\"> maxCount</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#D73A49\\\"> -</span><span style=\\\"color:#005CC5\\\">1</span><span style=\\\"color:#24292E\\\">, </span><span style=\\\"color:#E36209\\\">time</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Civil? </span><span style=\\\"color:#E36209\\\">startTime</span><span style=\\\"color:#D73A49\\\"> =</span><span style=\\\"color:#24292E\\\"> (), time</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Civil? endTime </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> (), TaskPolicy taskPolicy </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#24292E\\\"> {}) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> JobId</span><span style=\\\"color:#D73A49\\\">|</span><span style=\\\"color:#24292E\\\">Error</span></span></code></pre>\"],[-833028070,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> isolated</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> pauseAllJobs</span><span style=\\\"color:#24292E\\\">() </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> Error</span><span style=\\\"color:#D73A49\\\">?</span></span></code></pre>\"],[-176067455,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> isolated</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> resumeAllJobs</span><span style=\\\"color:#24292E\\\">() </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> Error</span><span style=\\\"color:#D73A49\\\">?</span></span></code></pre>\"],[574354226,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> isolated</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> pauseJob</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">JobId</span><span style=\\\"color:#E36209\\\"> jobId</span><span style=\\\"color:#24292E\\\">) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> Error</span><span style=\\\"color:#D73A49\\\">?</span></span></code></pre>\"],[-392489749,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> isolated</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> resumeJob</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">JobId</span><span style=\\\"color:#E36209\\\"> jobId</span><span style=\\\"color:#24292E\\\">) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> Error</span><span style=\\\"color:#D73A49\\\">?</span></span></code></pre>\"],[2115259349,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> isolated</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> getRunningJobs</span><span style=\\\"color:#24292E\\\">() </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> JobId[]</span></span></code></pre>\"],[-1466503032,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#D73A49\\\">public</span><span style=\\\"color:#D73A49\\\"> isolated</span><span style=\\\"color:#D73A49\\\"> function</span><span style=\\\"color:#6F42C1\\\"> unscheduleJob</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">JobId</span><span style=\\\"color:#E36209\\\"> jobId</span><span style=\\\"color:#24292E\\\">) </span><span style=\\\"color:#D73A49\\\">returns</span><span style=\\\"color:#24292E\\\"> Error</span><span style=\\\"color:#D73A49\\\">?</span></span></code></pre>\"]]"},"__N_SSG":true}