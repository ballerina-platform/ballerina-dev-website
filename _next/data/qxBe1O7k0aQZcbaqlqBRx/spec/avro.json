{"pageProps":{"frontmatter":{},"content":"# Specification: Ballerina Avro Library\r\n\r\n_Authors_: @Nuvindu \\\r\n_Reviewers_: @ThisaruGuruge \\\r\n_Created_: 2024/04/04 \\\r\n_Updated_: 2024/04/04 \\\r\n_Edition_: Swan Lake\r\n\r\n## Introduction\r\n\r\nThe Ballerina Avro module is designed to provide an easy way to convert data to bytes according to an Avro schema and to convert serialized bytes to a specific Ballerina type.\r\n\r\nThe Avro library specification has evolved and may continue to evolve in the future. The released versions of the specification can be found under the relevant GitHub tag.\r\n\r\nIf you have any feedback or suggestions about the library, start a discussion via a [GitHub issue](https://github.com/ballerina-platform/ballerina-library/issues) or in the [Discord server](https://discord.gg/ballerinalang). Based on the outcome of the discussion, the specification and implementation can be updated. Community feedback is always welcome. Any accepted proposal, which affects the specification is stored under `/docs/proposals`. Proposals under discussion can be found with the label `type/proposal` in GitHub.\r\n\r\nThe conforming implementation of the specification is released and included in the distribution. Any deviation from the specification is considered a bug.\r\n\r\n## Contents\r\n\r\n1. [Overview](#1-overview)\r\n2. [Initialize the Avro instance](#2-initialize-the-avro-instance)\r\n    * 2.1 [The `init` method](#21-the-init-method)\r\n3. [Serialize data into bytes](#3-serialize-data-into-bytes)\r\n    * 3.1 [The `toAvro` API](#31-the-toavro-api)\r\n        * 3.1.1 [API Parameters](#311-api-parameters)\r\n            * 3.1.1.1 [The `data` Parameter](#3111-the-data-parameter)\r\n                * 3.1.1.1.1 [Map Avro types to Ballerina Types](#31111-map-avro-types-to-ballerina-types)\r\n        * 3.1.2 [Return type](#312-return-type)\r\n4. [Deserialize bytes to a specific Ballerina type](#4-deserialize-bytes-to-a-specific-ballerina-type)\r\n    * 4.1 [The `fromAvro` API](#41-the-fromavro-api)\r\n        * 4.1.1 [API parameters](#411-api-parameters)\r\n            * 4.1.1.1 [The `data` parameter](#4111-the-data-parameter)\r\n            * 4.1.1.2 [The `targetType` parameter](#4112-the-targettype-parameter)\r\n        * 4.1.2 [Return type](#412-return-type)\r\n5. [The `avro:Error` type](#5-the-avroerror-type)\r\n\r\n## 1. Overview\r\n\r\nThis specification elaborates on serializing data to `byte[]`, as well as deserializing a `byte[]` to a specific Ballerina type.\r\n\r\nThe Avro module provides the following functionalities.\r\n\r\n1. Serialize data into bytes\r\n2. Deserialize bytes to a specific Ballerina type\r\n\r\n## 2. Initialize the Avro instance\r\n\r\nThe `avro:Schema` instance needs to be initialized before performing the functionalities.\r\n\r\n### 2.1 The `init` method\r\n\r\nThe `init` method can be used to initialize the `avro:Schema` instance. This method has a parameter named `schema` which accepts Avro schemas in the `string` format. The method will return an `avro:Error` in case of failure.\r\n\r\n```ballerina\r\navro:Schema schema = check new (\"avro-schema-string\");\r\n```\r\n\r\n## 3. Serialize data into bytes\r\n\r\nThis section describes the details of serializing Ballerina data into `byte` arrays.\r\n\r\n### 3.1 The `toAvro` API\r\n\r\nThe `toAvro` API can be used to serialize data into `byte[]`.\r\n\r\n```ballerina\r\nbyte[] serializedData = check schema.toAvro(\"avro-data\");\r\n```\r\n\r\n#### 3.1.1 API parameters\r\n\r\n##### 3.1.1.1 The `data` parameter\r\n\r\nThe `data` parameter accepts the following Ballerina data types that is needed to be serialized into `byte` array.\r\n\r\n###### 3.1.1.1.1 Map Avro types to Ballerina Types\r\n\r\nThe following table summarizes how Avro types are mapped to corresponding Ballerina types. These rules are applicable when serializing/deserializing Ballerina data according to an Avro schema.\r\n\r\n| Avro Type    | Ballerina Type |\r\n|--------------|----------------|\r\n| null         | nil            |\r\n| boolean      | boolean        |\r\n| int,long     | int            |\r\n| float,double | float          |\r\n| bytes        | byte[]         |\r\n| string       | string         |\r\n| record       | record         |\r\n| enum         | enum           |\r\n| array        | array          |\r\n| map          | map            |\r\n| fixed        | byte[]         |\r\n\r\n>**Note:** The Ballerina [`int`](https://ballerina.io/spec/lang/2023R1/#section_5.2.3) type can represent integers up to 64 bits in size using the two's complement representation. Therefore, it can handle both `int` (32-bit signed integer) and `long` (64-bit signed integer) Avro types.\r\n\r\n>**Note:** The Ballerina [`float`](https://ballerina.io/spec/lang/2023R1/#section_5.2.4.1) type supports the IEEE 754-2008 64-bit binary (radix 2) floating-point number standard. Therefore, it can handle both `float` (32-bit single precision IEEE 754 floating-point number) and `double` (64-bit double precision IEEE 754 floating-point number) Avro types.\r\n\r\n#### 3.1.2 Return type\r\n\r\nThe function returns a `byte[]` or a `avro:Error` based on the conversion.\r\n\r\n## 4. Deserialize bytes to a specific Ballerina type\r\n\r\nThe Avro module provides an API to deserialize a given `byte[]` to a given Ballerina type.\r\n\r\n### 4.1 The `fromAvro` API\r\n\r\nThe `fromAvro` API facilitates the deserialization of Avro `byte[]` into a given Ballerina type.\r\n\r\n```ballerina\r\nstring deserializedData = check schema.fromAvro(data);\r\n```\r\n\r\n#### 4.1.1 API parameters\r\n\r\n##### 4.1.1.1 The `data` parameter\r\n\r\nThe `data` parameter is an Avro `byte[]` that needs to be converted to a Ballerina type.\r\n\r\n##### 4.1.1.2 The `targetType` parameter\r\n\r\nThe `targetType` parameter accepts the type descriptor of the target Ballerina type.\r\n\r\n#### 4.1.2 Return type\r\n\r\nThe return type will be inferred from the user specified type on success, or a `avro:Error` in case of conversion errors.\r\n\r\n## 5. The `avro:Error` type\r\n\r\nThe `avro:Error` type represents all the errors related to the Avro module. This is a subtype of the Ballerina `error` type.\r\n","codeSnippets":"[[-1905591243,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">vro</span><span style=\\\"color:#D73A49\\\">:</span><span style=\\\"color:#24292E\\\">Schema schema </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> check</span><span style=\\\"color:#D73A49\\\"> new</span><span style=\\\"color:#24292E\\\"> (</span><span style=\\\"color:#032F62\\\">\\\"avro-schema-string\\\"</span><span style=\\\"color:#24292E\\\">);</span></span></code></pre>\"],[-967307668,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">yte[] serializedData </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> check</span><span style=\\\"color:#24292E\\\"> schema.</span><span style=\\\"color:#6F42C1\\\">toAvro</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#032F62\\\">\\\"avro-data\\\"</span><span style=\\\"color:#24292E\\\">);</span></span></code></pre>\"],[179423224,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color:#24292E\\\">tring deserializedData </span><span style=\\\"color:#D73A49\\\">=</span><span style=\\\"color:#D73A49\\\"> check</span><span style=\\\"color:#24292E\\\"> schema.</span><span style=\\\"color:#6F42C1\\\">fromAvro</span><span style=\\\"color:#24292E\\\">(</span><span style=\\\"color:#E36209\\\">data</span><span style=\\\"color:#24292E\\\">);</span></span></code></pre>\"]]"},"__N_SSG":true}