{"pageProps":{"samples":{"code":"<pre class=\"shiki github-light\" style=\"background-color: #fff\" tabindex=\"0\"><code><span class=\"line\"><span style=\"color: #D73A49\">import</span><span style=\"color: #24292E\"> ballerina/log;</span></span>\n<span class=\"line\"><span style=\"color: #D73A49\">import</span><span style=\"color: #24292E\"> ballerinax/trigger.salesforce </span><span style=\"color: #D73A49\">as</span><span style=\"color: #24292E\"> sfdcListener;</span></span>\n<span class=\"line\"><span style=\"color: #D73A49\">import</span><span style=\"color: #24292E\"> ballerinax/twilio;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D73A49\">type</span><span style=\"color: #24292E\"> </span><span style=\"color: #6F42C1\">SalesforceListenerConfig</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">record</span><span style=\"color: #24292E\"> {</span><span style=\"color: #D73A49\">|</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    </span><span style=\"color: #005CC5\">string</span><span style=\"color: #24292E\"> username;</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    </span><span style=\"color: #005CC5\">string</span><span style=\"color: #24292E\"> password;</span></span>\n<span class=\"line\"><span style=\"color: #D73A49\">|</span><span style=\"color: #24292E\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D73A49\">type</span><span style=\"color: #24292E\"> </span><span style=\"color: #6F42C1\">TwilioClientConfig</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">record</span><span style=\"color: #24292E\"> {</span><span style=\"color: #D73A49\">|</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    </span><span style=\"color: #005CC5\">string</span><span style=\"color: #24292E\"> accountSId;</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    </span><span style=\"color: #005CC5\">string</span><span style=\"color: #24292E\"> authToken;</span></span>\n<span class=\"line\"><span style=\"color: #D73A49\">|</span><span style=\"color: #24292E\">};</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D73A49\">const </span><span style=\"color: #005CC5\">string</span><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">CHANNEL_NAME</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #032F62\">&quot;/data/ContactChangeEvent&quot;</span><span style=\"color: #24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\">// Salesforce configuration parameters</span></span>\n<span class=\"line\"><span style=\"color: #D73A49\">configurable</span><span style=\"color: #24292E\"> SalesforceListenerConfig salesforceListenerConfig </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">?</span><span style=\"color: #24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #6A737D\">// Twilio configuration parameters</span></span>\n<span class=\"line\"><span style=\"color: #D73A49\">configurable</span><span style=\"color: #24292E\"> TwilioClientConfig twilioClientConfig </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">?</span><span style=\"color: #24292E\">;</span></span>\n<span class=\"line\"><span style=\"color: #D73A49\">configurable</span><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">string</span><span style=\"color: #24292E\"> fromNumber </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">?</span><span style=\"color: #24292E\">;</span></span>\n<span class=\"line\"><span style=\"color: #D73A49\">configurable</span><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">string</span><span style=\"color: #24292E\"> toNumber </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">?</span><span style=\"color: #24292E\">;</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D73A49\">listener</span><span style=\"color: #24292E\"> sfdcListener</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\">Listener sfdcEventListener </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">new</span><span style=\"color: #24292E\"> ({</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    username</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\"> salesforceListenerConfig.username,</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    password</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\"> salesforceListenerConfig.password,</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    channelName</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\"> CHANNEL_NAME</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D73A49\">final</span><span style=\"color: #24292E\"> twilio</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\">Client twilioClient </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">check</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">new</span><span style=\"color: #24292E\"> ({</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    twilioAuth</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        accountSId</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\"> twilioClientConfig.accountSId,</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        authToken</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\"> twilioClientConfig.authToken</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    }</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">});</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #D73A49\">service</span><span style=\"color: #24292E\"> sfdcListener:RecordService </span><span style=\"color: #D73A49\">on</span><span style=\"color: #24292E\"> sfdcEventListener {</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    </span><span style=\"color: #D73A49\">isolated</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">remote</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">function</span><span style=\"color: #24292E\"> </span><span style=\"color: #6F42C1\">onCreate</span><span style=\"color: #24292E\">(</span><span style=\"color: #E36209\">sfdcListener</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\">EventData payload) </span><span style=\"color: #D73A49\">returns</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">error?</span><span style=\"color: #24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        </span><span style=\"color: #005CC5\">string</span><span style=\"color: #24292E\"> firstName </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #032F62\">&quot;&quot;</span><span style=\"color: #24292E\">;</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        </span><span style=\"color: #005CC5\">string</span><span style=\"color: #24292E\"> lastName </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #032F62\">&quot;&quot;</span><span style=\"color: #24292E\">;</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        </span><span style=\"color: #005CC5\">string</span><span style=\"color: #24292E\">[] nameParts </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> re </span><span style=\"color: #032F62\">`,`</span><span style=\"color: #24292E\">.</span><span style=\"color: #6F42C1\">split</span><span style=\"color: #24292E\">(payload.changedData[</span><span style=\"color: #032F62\">&quot;Name&quot;</span><span style=\"color: #24292E\">].</span><span style=\"color: #6F42C1\">toString</span><span style=\"color: #24292E\">());</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        </span><span style=\"color: #D73A49\">if</span><span style=\"color: #24292E\"> nameParts.</span><span style=\"color: #6F42C1\">length</span><span style=\"color: #24292E\">() </span><span style=\"color: #D73A49\">&gt;=</span><span style=\"color: #24292E\"> </span><span style=\"color: #005CC5\">2</span><span style=\"color: #24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">            firstName </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> re </span><span style=\"color: #032F62\">`=`</span><span style=\"color: #24292E\">.</span><span style=\"color: #6F42C1\">split</span><span style=\"color: #24292E\">(</span><span style=\"color: #E36209\">nameParts</span><span style=\"color: #24292E\">[</span><span style=\"color: #005CC5\">0</span><span style=\"color: #24292E\">])[</span><span style=\"color: #005CC5\">1</span><span style=\"color: #24292E\">];</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">            lastName </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> re </span><span style=\"color: #032F62\">`=`</span><span style=\"color: #24292E\">.</span><span style=\"color: #6F42C1\">split</span><span style=\"color: #24292E\">(</span><span style=\"color: #E36209\">re</span><span style=\"color: #24292E\"> </span><span style=\"color: #032F62\">`</span><span style=\"color: #005CC5\">\\}</span><span style=\"color: #032F62\">`</span><span style=\"color: #24292E\">.</span><span style=\"color: #6F42C1\">replace</span><span style=\"color: #24292E\">(</span><span style=\"color: #E36209\">nameParts</span><span style=\"color: #24292E\">[</span><span style=\"color: #005CC5\">1</span><span style=\"color: #24292E\">], </span><span style=\"color: #032F62\">&quot;&quot;</span><span style=\"color: #24292E\">))[</span><span style=\"color: #005CC5\">1</span><span style=\"color: #24292E\">];</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        } </span><span style=\"color: #D73A49\">else</span><span style=\"color: #24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">            lastName </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> re </span><span style=\"color: #032F62\">`=`</span><span style=\"color: #24292E\">.</span><span style=\"color: #6F42C1\">split</span><span style=\"color: #24292E\">(</span><span style=\"color: #E36209\">re</span><span style=\"color: #24292E\"> </span><span style=\"color: #032F62\">`</span><span style=\"color: #005CC5\">\\}</span><span style=\"color: #032F62\">`</span><span style=\"color: #24292E\">.</span><span style=\"color: #6F42C1\">replace</span><span style=\"color: #24292E\">(</span><span style=\"color: #E36209\">nameParts</span><span style=\"color: #24292E\">[</span><span style=\"color: #005CC5\">0</span><span style=\"color: #24292E\">], </span><span style=\"color: #032F62\">&quot;&quot;</span><span style=\"color: #24292E\">))[</span><span style=\"color: #005CC5\">1</span><span style=\"color: #24292E\">];</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        }</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        twilio</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\">SmsResponse response </span><span style=\"color: #D73A49\">=</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">check</span><span style=\"color: #24292E\"> twilioClient</span><span style=\"color: #D73A49\">-&gt;</span><span style=\"color: #6F42C1\">sendSms</span><span style=\"color: #24292E\">(</span><span style=\"color: #E36209\">fromNumber</span><span style=\"color: #24292E\">, </span><span style=\"color: #E36209\">toNumber</span><span style=\"color: #24292E\">,</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">            </span><span style=\"color: #005CC5\">string</span><span style=\"color: #24292E\"> </span><span style=\"color: #032F62\">`New contact is created! | Name: ${</span><span style=\"color: #24292E\">firstName</span><span style=\"color: #032F62\">} ${</span><span style=\"color: #24292E\">lastName</span><span style=\"color: #032F62\">} | Created Date: </span></span>\n<span class=\"line\"><span style=\"color: #032F62\">            ${</span><span style=\"color: #032F62\">(</span><span style=\"color: #D73A49\">check</span><span style=\"color: #032F62\"> </span><span style=\"color: #24292E\">payload</span><span style=\"color: #032F62\">.</span><span style=\"color: #24292E\">changedData</span><span style=\"color: #032F62\">.</span><span style=\"color: #24292E\">CreatedDate</span><span style=\"color: #032F62\">).</span><span style=\"color: #6F42C1\">toString</span><span style=\"color: #032F62\">()</span><span style=\"color: #032F62\">}`</span><span style=\"color: #24292E\">);</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        log</span><span style=\"color: #D73A49\">:</span><span style=\"color: #6F42C1\">printInfo</span><span style=\"color: #24292E\">(</span><span style=\"color: #032F62\">&quot;SMS(SID: &quot;</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">+</span><span style=\"color: #24292E\"> response.sid </span><span style=\"color: #D73A49\">+</span><span style=\"color: #24292E\"> </span><span style=\"color: #032F62\">&quot;) sent successfully&quot;</span><span style=\"color: #24292E\">);</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #24292E\">    </span><span style=\"color: #D73A49\">isolated</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">remote</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">function</span><span style=\"color: #24292E\"> </span><span style=\"color: #6F42C1\">onUpdate</span><span style=\"color: #24292E\">(</span><span style=\"color: #E36209\">sfdcListener</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\">EventData payload) </span><span style=\"color: #D73A49\">returns</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">error?</span><span style=\"color: #24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        </span><span style=\"color: #D73A49\">return</span><span style=\"color: #24292E\">;</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #24292E\">    </span><span style=\"color: #D73A49\">isolated</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">remote</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">function</span><span style=\"color: #24292E\"> </span><span style=\"color: #6F42C1\">onDelete</span><span style=\"color: #24292E\">(</span><span style=\"color: #E36209\">sfdcListener</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\">EventData payload) </span><span style=\"color: #D73A49\">returns</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">error?</span><span style=\"color: #24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        </span><span style=\"color: #D73A49\">return</span><span style=\"color: #24292E\">;</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    }</span></span>\n<span class=\"line\"></span>\n<span class=\"line\"><span style=\"color: #24292E\">    </span><span style=\"color: #D73A49\">isolated</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">remote</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">function</span><span style=\"color: #24292E\"> </span><span style=\"color: #6F42C1\">onRestore</span><span style=\"color: #24292E\">(</span><span style=\"color: #E36209\">sfdcListener</span><span style=\"color: #D73A49\">:</span><span style=\"color: #24292E\">EventData payload) </span><span style=\"color: #D73A49\">returns</span><span style=\"color: #24292E\"> </span><span style=\"color: #D73A49\">error?</span><span style=\"color: #24292E\"> {</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">        </span><span style=\"color: #D73A49\">return</span><span style=\"color: #24292E\">;</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">    }</span></span>\n<span class=\"line\"><span style=\"color: #24292E\">}</span></span></code></pre>"},"content":"\nimport ballerina/log;\nimport ballerinax/trigger.salesforce as sfdcListener;\nimport ballerinax/twilio;\n\ntype SalesforceListenerConfig record {|\n    string username;\n    string password;\n|};\n\ntype TwilioClientConfig record {|\n    string accountSId;\n    string authToken;\n|};\n\nconst string CHANNEL_NAME = \"/data/ContactChangeEvent\";\n\n// Salesforce configuration parameters\nconfigurable SalesforceListenerConfig salesforceListenerConfig = ?;\n\n// Twilio configuration parameters\nconfigurable TwilioClientConfig twilioClientConfig = ?;\nconfigurable string fromNumber = ?;\nconfigurable string toNumber = ?;\n\nlistener sfdcListener:Listener sfdcEventListener = new ({\n    username: salesforceListenerConfig.username,\n    password: salesforceListenerConfig.password,\n    channelName: CHANNEL_NAME\n});\n\nfinal twilio:Client twilioClient = check new ({\n    twilioAuth: {\n        accountSId: twilioClientConfig.accountSId,\n        authToken: twilioClientConfig.authToken\n    }\n});\n\nservice sfdcListener:RecordService on sfdcEventListener {\n    isolated remote function onCreate(sfdcListener:EventData payload) returns error? {\n        string firstName = \"\";\n        string lastName = \"\";\n        string[] nameParts = re `,`.split(payload.changedData[\"Name\"].toString());\n        if nameParts.length() >= 2 {\n            firstName = re `=`.split(nameParts[0])[1];\n            lastName = re `=`.split(re `\\}`.replace(nameParts[1], \"\"))[1];\n        } else {\n            lastName = re `=`.split(re `\\}`.replace(nameParts[0], \"\"))[1];\n        }\n        twilio:SmsResponse response = check twilioClient->sendSms(fromNumber, toNumber,\n            string `New contact is created! | Name: ${firstName} ${lastName} | Created Date: \n            ${(check payload.changedData.CreatedDate).toString()}`);\n        log:printInfo(\"SMS(SID: \" + response.sid + \") sent successfully\");\n    }\n\n    isolated remote function onUpdate(sfdcListener:EventData payload) returns error? {\n        return;\n    }\n\n    isolated remote function onDelete(sfdcListener:EventData payload) returns error? {\n        return;\n    }\n\n    isolated remote function onRestore(sfdcListener:EventData payload) returns error? {\n        return;\n    }\n}\n"},"__N_SSG":true}