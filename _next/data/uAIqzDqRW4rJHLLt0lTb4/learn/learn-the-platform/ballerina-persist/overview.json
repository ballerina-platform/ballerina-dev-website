{"pageProps":{"frontmatter":{"layout":"ballerina-persist-documentation-left-nav-pages-swanlake","title":"Bal persist overview","description":"The section gives an overview of the `bal persist` feature.","keywords":"ballerina, programming language, ballerina packages, persist, persist model, persist cli, persist client api","permalink":"/learn/ballerina-persist/persist-overview/","active":"persist_overview","intro":"The `bal persist` feature allows you to store data in different data stores and retrieve them when needed. A data store can be a database, an in-memory cache, or a file system. The bal persist feature currently supports In-memory table, MySQL database, and Google Sheets as data stores. The important point is you can use the same syntax to access data in all these data stores. So you don't need to learn different syntaxes to access data in different data stores.","redirect_from":["/learn/ballerina-persist/persist-overview/"]},"content":"This feature has three main sections: Persist Model, Persist CLI and Persist Client API. The Persist Model is used to define the data model. The Persist CLI is used to generate the client API for the data model. The Persist Client API is used to access the data in the data store.\n\n## Persist Model\n\nThe Persist Model is used to define the data model. The data model is defined in a Ballerina source file inside the persist directory in the project root directory. The data model is defined using the Ballerina record type. The following example shows how to define a data model for a table named `Employee` with the fields `id`, `name`, `age` and `salary`.\n\n```ballerina\ntype Employee record {\n    readonly int id;\n    string name;\n    int age;\n    float salary;\n}\n```\n\nThe `readonly` keyword is used to define a field as a primary key. You need to have at least one primary key field in the Entity record. The primary key field is used to uniquely identify a record in the table. The primary key field is used to generate the `get`, `update`, and `delete` operations in the client API. You can define multiple primary key fields in the Entity record.\n\nLearn about how to define relationships between entity records and more about the persist model in the [Persist Model](/learn/persist-model/) section.\n\n> Note: The Ballerina VSCode plugin provides validation and code actions for the persist model. So you can easily create the persist model using the Ballerina VSCode plugin.\n\n## Persist CLI\n\nThe `bal persist` CLI is used to generate the client API for the data model. Based on the data store, additional configurable file and setup scripts are generated. For example, if you are using MySQL as the data store, the `persist_db_config.bal` file, and the `script.sql` script are generated. The `persist_db_config.bal` file is used to configure the MySQL database connection. The `script.sql` file is used to create the table in the MySQL database. The client API is generated in the `generated` directory in the project root directory.\n\nThe `bal persist` has two main built-in CLI commands: `persist init` and `persist generate`. The `persist init` command is used to initialize bal persist in the Ballerina project. The `persist generate` command is used to generate the client API for the data model. Additionally, there is an experimental `persist migrate` command to generate the SQL scripts for changing the table structure in the database when the data model is changed.\n\nLearn more about `bal persist` CLI in the [Persist CLI](/learn/persist-cli/) section.\n\n## Persist Client API\n\nThe Persist Client API is used to access the data in the data store. The client API is generated using the Persist CLI and it is located in the `generated` directory in the project root directory. The client API consists of a Ballerina client object with resource for each entity record modeled in the Ballerina project. For each client resource, there are resource methods to perform CRUD operations on the data store.\n\nFor example, if you have an `Employee` entity record in the Ballerina project, you can perform CRUD operations on the `Employee` table in the data store using the client object, as follows.\n\n```ballerina\n// Create a new employee record\nEmployeeInsert employee = {id: 1, name: \"John\", age: 30, salary: 3000.0};\nint[]|error employeeId = sClient->/employees.post([employee]);\n\n// Get the employee record with id 1\nEmployee|error employee = sClient->/employees/1;\n\n// Update the employee record with id 1\nEmployee|error updated = sClient->/employees/1.put({salary: 4000.0});\n\n// Delete the employee record with id 1\nEmployee|error deleted = sClient->/employees/1.delete();\n\n// Get all the employee records\nstream<Employee, error?> employees = sClient->/employees;\n```\n\nLearn more about persist client APIs in the [Persist Client API](/learn/persist-client-api/) section.\n\nIf you want to get started with a practical introduction and learn about `bal persist`, head over to the [Quick Start Guide](quick-tour.md) section.","id":"overview","sub":"ballerina-persist","third":"","slug":"ballerina-persist/overview","codes":"[[-345316219,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color: #fff\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color: #D73A49\\\">type</span><span style=\\\"color: #24292E\\\"> </span><span style=\\\"color: #6F42C1\\\">Employee</span><span style=\\\"color: #24292E\\\"> </span><span style=\\\"color: #D73A49\\\">record</span><span style=\\\"color: #24292E\\\"> {</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #24292E\\\">    </span><span style=\\\"color: #D73A49\\\">readonly</span><span style=\\\"color: #24292E\\\"> </span><span style=\\\"color: #005CC5\\\">int</span><span style=\\\"color: #24292E\\\"> id;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #24292E\\\">    </span><span style=\\\"color: #005CC5\\\">string</span><span style=\\\"color: #24292E\\\"> name;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #24292E\\\">    </span><span style=\\\"color: #005CC5\\\">int</span><span style=\\\"color: #24292E\\\"> age;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #24292E\\\">    </span><span style=\\\"color: #005CC5\\\">float</span><span style=\\\"color: #24292E\\\"> salary;</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #24292E\\\">}</span></span></code></pre>\"],[-1675855202,\"<pre class=\\\"shiki github-light\\\" style=\\\"background-color: #fff\\\" tabindex=\\\"0\\\"><code><span class=\\\"line\\\"><span style=\\\"color: #6A737D\\\">// Create a new employee record</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #24292E\\\">EmployeeInsert employee </span><span style=\\\"color: #D73A49\\\">=</span><span style=\\\"color: #24292E\\\"> {id</span><span style=\\\"color: #D73A49\\\">:</span><span style=\\\"color: #24292E\\\"> </span><span style=\\\"color: #005CC5\\\">1</span><span style=\\\"color: #24292E\\\">, name</span><span style=\\\"color: #D73A49\\\">:</span><span style=\\\"color: #24292E\\\"> </span><span style=\\\"color: #032F62\\\">&quot;John&quot;</span><span style=\\\"color: #24292E\\\">, age</span><span style=\\\"color: #D73A49\\\">:</span><span style=\\\"color: #24292E\\\"> </span><span style=\\\"color: #005CC5\\\">30</span><span style=\\\"color: #24292E\\\">, salary</span><span style=\\\"color: #D73A49\\\">:</span><span style=\\\"color: #24292E\\\"> </span><span style=\\\"color: #005CC5\\\">3000.0</span><span style=\\\"color: #24292E\\\">};</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #005CC5\\\">int</span><span style=\\\"color: #24292E\\\">[]</span><span style=\\\"color: #D73A49\\\">|error</span><span style=\\\"color: #24292E\\\"> employeeId </span><span style=\\\"color: #D73A49\\\">=</span><span style=\\\"color: #24292E\\\"> sClient</span><span style=\\\"color: #D73A49\\\">-&gt;/</span><span style=\\\"color: #24292E\\\">employees.</span><span style=\\\"color: #6F42C1\\\">post</span><span style=\\\"color: #24292E\\\">([employee]);</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #6A737D\\\">// Get the employee record with id 1</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #24292E\\\">Employee</span><span style=\\\"color: #D73A49\\\">|error</span><span style=\\\"color: #24292E\\\"> employee </span><span style=\\\"color: #D73A49\\\">=</span><span style=\\\"color: #24292E\\\"> sClient</span><span style=\\\"color: #D73A49\\\">-&gt;/</span><span style=\\\"color: #24292E\\\">employees</span><span style=\\\"color: #D73A49\\\">/</span><span style=\\\"color: #005CC5\\\">1</span><span style=\\\"color: #24292E\\\">;</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #6A737D\\\">// Update the employee record with id 1</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #24292E\\\">Employee</span><span style=\\\"color: #D73A49\\\">|error</span><span style=\\\"color: #24292E\\\"> updated </span><span style=\\\"color: #D73A49\\\">=</span><span style=\\\"color: #24292E\\\"> sClient</span><span style=\\\"color: #D73A49\\\">-&gt;/</span><span style=\\\"color: #24292E\\\">employees</span><span style=\\\"color: #D73A49\\\">/</span><span style=\\\"color: #005CC5\\\">1</span><span style=\\\"color: #24292E\\\">.</span><span style=\\\"color: #6F42C1\\\">put</span><span style=\\\"color: #24292E\\\">({salary</span><span style=\\\"color: #D73A49\\\">:</span><span style=\\\"color: #24292E\\\"> </span><span style=\\\"color: #005CC5\\\">4000.0</span><span style=\\\"color: #24292E\\\">});</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #6A737D\\\">// Delete the employee record with id 1</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #24292E\\\">Employee</span><span style=\\\"color: #D73A49\\\">|error</span><span style=\\\"color: #24292E\\\"> deleted </span><span style=\\\"color: #D73A49\\\">=</span><span style=\\\"color: #24292E\\\"> sClient</span><span style=\\\"color: #D73A49\\\">-&gt;/</span><span style=\\\"color: #24292E\\\">employees</span><span style=\\\"color: #D73A49\\\">/</span><span style=\\\"color: #005CC5\\\">1</span><span style=\\\"color: #24292E\\\">.</span><span style=\\\"color: #6F42C1\\\">delete</span><span style=\\\"color: #24292E\\\">();</span></span>\\n<span class=\\\"line\\\"></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #6A737D\\\">// Get all the employee records</span></span>\\n<span class=\\\"line\\\"><span style=\\\"color: #D73A49\\\">stream&lt;</span><span style=\\\"color: #24292E\\\">Employee, </span><span style=\\\"color: #D73A49\\\">error?&gt;</span><span style=\\\"color: #24292E\\\"> employees </span><span style=\\\"color: #D73A49\\\">=</span><span style=\\\"color: #24292E\\\"> sClient</span><span style=\\\"color: #D73A49\\\">-&gt;/</span><span style=\\\"color: #24292E\\\">employees;</span></span></code></pre>\"]]"},"__N_SSG":true}