<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="description" content="Capture and process database changes in real-time using Ballerina CDC connectors."/><meta name="keywords" content="ballerina, cdc, change data capture, database, streaming, API"/><title>Build a Change Data Capture (CDC) service in Ballerina - The Ballerina programming language</title><meta property="og:type" content="article"/><meta property="og:title" content="Build a Change Data Capture (CDC) service in Ballerina - The Ballerina programming language"/><meta property="og:description" content="Capture and process database changes in real-time using Ballerina CDC connectors."/><meta property="og:image" content="https://ballerina.io/images/ballerina-generic-social-media-image-2023.png"/><meta property="og:description" content="Capture and process database changes in real-time using Ballerina CDC connectors."/><meta property="og:image" content="https://ballerina.io/images/ballerina-generic-social-media-image-2023.png"/><meta name="twitter:title" content="Build a Change Data Capture (CDC) service in Ballerina - The Ballerina programming language"/><meta property="twitter:description" content="Capture and process database changes in real-time using Ballerina CDC connectors."/><meta property="twitter:text:description" content="Capture and process database changes in real-time using Ballerina CDC connectors."/><meta name="twitter:site" content="@ballerinalang"/><meta name="twitter:creator" content="@ballerinalang"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://ballerina.io/images/ballerina-generic-social-media-image-2023.png"/><meta property="twitter:image" content="https://ballerina.io/images/ballerina-generic-social-media-image-2023.png"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.setAttributeNode(d.createAttribute('data-ot-ignore'));j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PSL2TX4');</script><script type="text/javascript" crossorigin="true" src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"></script><script src="https://cookie-cdn.cookiepro.com/scripttemplates/otSDKStub.js" type="text/javascript" charSet="UTF-8" data-domain-script="630ad396-5fd5-4745-92ae-2765dc8841ee" defer=""></script><meta name="next-head-count" content="22"/><meta charSet="utf-8"/><meta name="author" content="WSO2 LLC"/><meta http-equiv="X-Frame-Options" content="SAMEORIGIN"/><meta http-equiv="Content-Security-Policy" content="frame-ancestors &#x27;none&#x27;;"/><link rel="shortcut icon" href="/images/favicon.ico"/><link rel="stylesheet" href="/css/roboto.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="/css/ballerina-search-button.css"/><link rel="stylesheet" href="/css/ballerina-search-modal.css"/><link rel="stylesheet" href="/css/ballerina-search-variables.css"/><link rel="stylesheet" href="/css/ballerina-search-style.css"/><link rel="preload" href="/_next/static/css/9bb35c8110b0fa38.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9bb35c8110b0fa38.css" data-n-g=""/><link rel="preload" href="/_next/static/css/f53751c7316b8bee.css" as="style"/><link rel="stylesheet" href="/_next/static/css/f53751c7316b8bee.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9ee6b616f8ba237c.js" defer=""></script><script src="/_next/static/chunks/framework-79bce4a3a540b080.js" defer=""></script><script src="/_next/static/chunks/main-0ea70f422df5d19e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ba2391f08766dae9.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-07afe3a69e1ba759.js" defer=""></script><script src="/_next/static/chunks/7621-d6bcd83f463fef72.js" defer=""></script><script src="/_next/static/chunks/1058-de0b031bc614d462.js" defer=""></script><script src="/_next/static/chunks/8130-4f833ffdbe1dba0f.js" defer=""></script><script src="/_next/static/chunks/6084-4e54ad5efcb8d3b5.js" defer=""></script><script src="/_next/static/chunks/5530-11a262420fdd225c.js" defer=""></script><script src="/_next/static/chunks/6686-fc13fcae106ae808.js" defer=""></script><script src="/_next/static/chunks/9684-074b9a695fa68133.js" defer=""></script><script src="/_next/static/chunks/5607-3aea9a3f6aab5467.js" defer=""></script><script src="/_next/static/chunks/3066-532e3a00a68674d9.js" defer=""></script><script src="/_next/static/chunks/9817-0ca5a0867234cccf.js" defer=""></script><script src="/_next/static/chunks/2659-19793be73574112a.js" defer=""></script><script src="/_next/static/chunks/5907-9f3e6b733f7fdae1.js" defer=""></script><script src="/_next/static/chunks/3403-6413de2ec6992239.js" defer=""></script><script src="/_next/static/chunks/pages/learn/resources/%5B...slug%5D-9b72df7c9b8491ba.js" defer=""></script><script src="/_next/static/6Bzrp9DXb6FB8ofNSgRhm/_buildManifest.js" defer=""></script><script src="/_next/static/6Bzrp9DXb6FB8ofNSgRhm/_ssgManifest.js" defer=""></script><script src="/_next/static/6Bzrp9DXb6FB8ofNSgRhm/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSL2TX4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next" data-reactroot=""><div class="main-wrapper vstack gap-0"><div class="wrap-page-content container-fluid"><div class="row"><div class="leftNav d-none d-sm-block col-xxl-2 col-sm-3"><div class="LeftNav_leftNavAccordian__i9BmP accordion accordion-flush"><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="why-ballerina" class="LeftNav_mainDir__aO30Y accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Why Ballerina</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_accordionBody__mzk_B accordion-body"><ul class="LeftNav_firstTier__KPVX9"><div class="accordion"><li><a id="cloud-native" href="/why-ballerina/cloud-native">Cloud native</a></li><li><a id="flexibly-typed" href="/why-ballerina/flexibly-typed">Flexibly typed</a></li><li><a id="data-oriented" href="/why-ballerina/data-oriented">Data oriented</a></li><li><a id="graphical" href="/why-ballerina/graphical">Graphical</a></li><li><a id="concurrent" href="/why-ballerina/concurrent">Concurrent</a></li><li><a id="reliable-maintainable" href="/why-ballerina/reliable-maintainable">Reliable, maintainable</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="integration" class="LeftNav_mainDir__aO30Y accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Get started with integration</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_accordionBody__mzk_B accordion-body"><ul class="LeftNav_firstTier__KPVX9"><div class="accordion"><li><a id="get-started" href="/learn/get-started">Get started</a></li><li><a id="pre-built-integrations" href="/learn/pre-built-integrations" target="_blank" rel="noreferrer">Pre-built integrations</a></li><li><a id="patterns" href="/learn/enterprise-integration-patterns" target="_blank" rel="noreferrer">Enterprise Integration Patterns (EIP)</a></li><li><a id="integration-tutorials" href="/learn/integration-tutorials" target="_blank" rel="noreferrer">Integration tutorials</a></li><li><a id="supported-data-formats" href="/learn/supported-data-formats">Supported data formats</a></li><li><a id="supported-network-protocols" href="/learn/supported-network-protocols">Supported network integration protocols</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="integration-tools" class="LeftNav_mainDir__aO30Y accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Integration tools</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_accordionBody__mzk_B accordion-body"><ul class="LeftNav_firstTier__KPVX9"><div class="accordion"><li><a id="openapi-tool" href="/learn/openapi-tool">OpenAPI tool</a></li><li><a id="graphql-tool" href="/learn/graphql-tool">GraphQL tool</a></li><li><a id="asyncapi-tool" href="/learn/asyncapi-tool">AsyncAPI tool</a></li><li><a id="grpc-tool" href="/learn/grpc-tool">gRPC tool</a></li><li><a id="health-tool" href="/learn/health-tool">Health tool (FHIR/HL7)</a></li><li><a id="edi-tool" href="/learn/edi-tool">EDI tool</a></li><li><a id="wsdl-tool" href="/learn/wsdl-tool">WSDL tool</a></li><li><a id="xsd-tool" href="/learn/xsd-tool">XSD tool</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="references" class="LeftNav_mainDir__aO30Y accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">References</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_accordionBody__mzk_B accordion-body"><ul class="LeftNav_firstTier__KPVX9"><div class="accordion"><li><a id="by-example" href="/learn/by-example" target="_blank" rel="noreferrer">Ballerina by Example</a></li><li><a id="api-docs" href="https://lib.ballerina.io/" target="_blank" rel="noreferrer">Ballerina API Docs</a></li><li><a id="ballerina-specifications" href="/learn/ballerina-specifications">Ballerina specifications</a></li><li><a id="vcsode" href="https://wso2.com/ballerina/vscode/docs/" target="_blank" rel="noreferrer">Visual Studio Code extension</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="development-tutorials" class="LeftNav_mainDir__aO30Y accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Development tutorials</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_accordionBody__mzk_B accordion-body"><ul class="LeftNav_firstTier__KPVX9"><div class="accordion"><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="build-and-run" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Build and run</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="cli-commands" href="/learn/cli-commands">CLI commands</a></li><li><a id="update-tool" href="/learn/update-tool">Update tool</a></li><li><a id="ballerina-shell" href="/learn/ballerina-shell">Ballerina Shell</a></li><li><a id="cicd" href="/learn/cicd">Configure CI/CD for Ballerina projects</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="source-code-dependencies" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Source code &amp; dependencies</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="organize-ballerina-code" href="/learn/organize-ballerina-code">Organize Ballerina code</a></li><li><a id="package-references" href="/learn/package-references">Package references</a></li><li><a id="manage-dependencies" href="/learn/manage-dependencies">Manage dependencies</a></li><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="style-guide" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Style guide</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="coding-conventions" href="/learn/style-guide/coding-conventions">Coding conventions</a></li><li><a id="top-level-definitions" href="/learn/style-guide/top-level-definitions">Top-level definitions</a></li><li><a id="operators-keywords-and-types" href="/learn/style-guide/operators-keywords-and-types">Operators, keywords, and types</a></li><li><a id="statements" href="/learn/style-guide/statements">Statements</a></li><li><a id="expressions" href="/learn/style-guide/expressions">Expressions</a></li><li><a id="annotations-documentation-and-comments" href="/learn/style-guide/annotations-documentation-and-comments">Annotations, documentation and comments</a></li></div></ul></div></div></div><li><a id="customize-formatting" href="/learn/customize-formatting">Customize formatting</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="test-document-the-code" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Test, debug &amp; document the code</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="test-ballerina-code" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Test Ballerina code</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="test-a-simple-function" href="/learn/test-ballerina-code/test-a-simple-function">Test a simple function</a></li><li><a id="write-tests" href="/learn/test-ballerina-code/write-tests">Write tests</a></li><li><a id="structure-tests" href="/learn/test-ballerina-code/structure-tests">Structure tests</a></li><li><a id="configure-tests" href="/learn/test-ballerina-code/configure-tests">Configure tests</a></li><li><a id="code-coverage-and-reporting" href="/learn/test-ballerina-code/code-coverage-and-reporting">Code coverage and reporting</a></li><li><a id="define-data-driven-tests" href="/learn/test-ballerina-code/define-data-driven-tests">Define data-driven tests</a></li><li><a id="define-test-groups" href="/learn/test-ballerina-code/define-test-groups">Define test groups</a></li><li><a id="test-services-and-clients" href="/learn/test-ballerina-code/test-services-and-clients">Test services and clients</a></li><li><a id="mocking" href="/learn/test-ballerina-code/mocking">Mocking</a></li><li><a id="execute-tests" href="/learn/test-ballerina-code/execute-tests">Execute tests</a></li><li><a id="execute-tests-in-parallel" href="/learn/test-ballerina-code/execute-tests-in-parallel/">Execute tests in parallel</a></li></div></ul></div></div></div><li><a id="debug-ballerina-programs" href="/learn/debug-ballerina-programs">Debug Ballerina programs</a></li><li><a id="generate-code-documentation" href="/learn/generate-code-documentation">Generate code documentation</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="configurability" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Configurability</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="configure-a-sample-ballerina-service" href="/learn/configure-a-sample-ballerina-service">Configure a sample Ballerina service</a></li><li><a id="provide-values-to-configurable-variables" href="/learn/provide-values-to-configurable-variables">Provide values to configurable variables</a></li><li><a id="configure-values" href="/learn/configure-values">Configure values </a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="deployment-guide" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Deployment guidelines</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="deployment-guidelines-overview" href="/learn/deployment-guidelines-overview">Deployment guidelines overview</a></li><li><a id="monolithic-deployment" href="/learn/monolithic-deployment">Monolithic deployment</a></li><li><a id="containerized-deployment" href="/learn/containerized-deployment">Containerized deployment</a></li><li><a id="serverless-deployment" href="/learn/serverless-deployment">Serverless deployment </a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="ballerina-persist" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Bal persist</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="bal-persist-overview" href="/learn/bal-persist-overview">Bal persist overview</a></li><li><a id="persist-model" href="/learn/persist-model">Data model</a></li><li><a id="persist-cli-tool" href="/learn/persist-cli-tool">CLI tool</a></li><li><a id="persist-client-api" href="/learn/persist-client-api">Type-safe client API</a></li><li><a id="persist-introspection" href="/learn/persist-introspection">Introspection</a></li><li><a id="supported-data-stores" href="/learn/supported-data-stores">Supported data stores</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="observability" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Observability</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="overview-of-ballerina-observability" href="/learn/overview-of-ballerina-observability">Overview of Ballerina observability</a></li><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="supported-observability-tools-and-platforms" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Supported observability tools and platforms</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="prometheus" href="/learn/supported-observability-tools-and-platforms/prometheus">Prometheus</a></li><li><a id="jaeger" href="/learn/supported-observability-tools-and-platforms/jaeger">Jaeger</a></li><li><a id="zipkin" href="/learn/supported-observability-tools-and-platforms/zipkin">Zipkin</a></li><li><a id="datadog" href="/learn/supported-observability-tools-and-platforms/datadog">Datadog</a></li><li><a id="new-relic" href="/learn/supported-observability-tools-and-platforms/new-relic">New Relic</a></li><li><a id="elastic-stack" href="/learn/supported-observability-tools-and-platforms/elastic-stack">Elastic Stack</a></li></div></ul></div></div></div></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="java-interoperability" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Java interoperability</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="call-java-code-from-ballerina" href="/learn/call-java-code-from-ballerina">Call Java code from Ballerina</a></li><li><a id="ballerina-ffi" href="/learn/ballerina-ffi">Ballerina FFI</a></li><li><a id="the-bindgen-tool" href="/learn/the-bindgen-tool">The Bindgen tool</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="build-a-graalvm-executable" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Build a GraalVM executable</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="graalvm-executable-overview" href="/learn/graalvm-executable-overview">GraalVM executable overview</a></li><li><a id="build-the-executable-in-a-container" href="/learn/build-the-executable-in-a-container">Build the executable in a container</a></li><li><a id="build-the-executable-locally" href="/learn/build-the-executable-locally/">Build the executable locally</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="ballerina-central" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Reuse code with Ballerina Central</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="publish-packages-to-ballerina-central" href="/learn/publish-packages-to-ballerina-central">Publish packages to Ballerina Central</a></li><li><a id="configure-a-network-proxy" href="/learn/configure-a-network-proxy">Configure a network proxy</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="troubleshoot-the-runtime" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Troubleshoot the runtime</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="strand-dump-tool" href="/learn/strand-dump-tool">Strand dump tool</a></li><li><a id="ballerina-profiler" href="/learn/ballerina-profiler">Ballerina Profiler</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="additional-tools" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Additional tools</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="scan-tool" href="/learn/scan-tool">Scan tool</a></li><li><a id="consolidate-packages-tool" href="/learn/consolidate-packages-tool">Consolidate-packages tool</a></li></div></ul></div></div></div></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="resources" class="LeftNav_mainDir__aO30Y accordion-header"><button type="button" aria-expanded="true" class="accordion-button">Resources</button></h2><div class="accordion-collapse collapse show"><div class="LeftNav_accordionBody__mzk_B accordion-body"><ul class="LeftNav_firstTier__KPVX9"><div class="accordion"><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="featured-scenarios" class="accordion-header"><button type="button" aria-expanded="true" class="accordion-button">Featured scenarios</button></h2><div class="accordion-collapse collapse show"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="write-a-restful-api-with-ballerina" href="/learn/write-a-restful-api-with-ballerina">Write a RESTful API with Ballerina</a></li><li><a id="write-a-grpc-service-with-ballerina" href="/learn/write-a-grpc-service-with-ballerina">Write a gRPC service with Ballerina</a></li><li><a id="write-a-graphql-api-with-ballerina" href="/learn/write-a-graphql-api-with-ballerina">Write a GraphQL API with Ballerina</a></li><li><a id="work-with-data-using-queries-in-ballerina" href="/learn/work-with-data-using-queries-in-ballerina">Work with data using queries in Ballerina</a></li><li><a id="build-a-data-service-in-ballerina" href="/learn/build-a-data-service-in-ballerina">Build a data service in Ballerina </a></li><li><a id="build-a-change-data-capture-service-in-ballerina" class="LeftNav_active__7vmPU" href="/learn/build-a-change-data-capture-service-in-ballerina">Build a Change Data Capture (CDC) service in Ballerina</a></li><li><a id="work-with-llms-using-natural-expressions" href="/learn/work-with-llms-using-natural-expressions">Work with Large Language Models (LLMs) using natural expressions</a></li><li><a id="deploy-ballerina-on-kubernetes" href="/learn/deploy-ballerina-on-kubernetes">Deploy Ballerina on Kubernetes</a></li><li><a id="manage-data-persistence-with-bal-persist" href="/learn/manage-data-persistence-with-bal-persist">Manage data persistence with bal persist</a></li><li><a id="create-your-first-connector-with-ballerina" href="/learn/create-your-first-connector-with-ballerina">Create your first connector with Ballerina</a></li></div></ul></div></div></div><div class="LeftNav_acItem__wMNuO accordion-item"><h2 item-id="learn-the-language" class="accordion-header"><button type="button" aria-expanded="false" class="accordion-button collapsed">Learn the language</button></h2><div class="accordion-collapse collapse"><div class="LeftNav_acBody__r7jSH accordion-body"><ul class="LeftNav_secondTier__nZWOX"><div class="accordion"><li><a id="language-basics" href="/learn/language-basics">Language basics</a></li><li><a id="network-interaction" href="/learn/network-interaction">Network interaction</a></li><li><a id="data" href="/learn/data">Data</a></li><li><a id="concurrency" href="/learn/concurrency">Concurrency </a></li><li><a id="advanced-general-purpose-language-features" href="/learn/advanced-general-purpose-language-features">Advanced, general-purpose language features</a></li></div></ul></div></div></div></div></ul></div></div></div></div></div><div class="d-block d-sm-none col-12"><button type="button" class="learnMob btn btn-primary">Learn</button></div><div class="mdContent col-xxl-7 col-sm-7 col-12"><div class="container"><div class="topRow"><div class="col-11"><h1>Build a Change Data Capture (CDC) service in Ballerina</h1></div><div class="gitIcon col-1"><a href="https://github.com/ballerina-platform/ballerina-dev-website/blob/master/swan-lake/resources/featured-scenarios/build-a-change-data-capture-service-in-ballerina.md" target="_blank" rel="noreferrer" title="Edit in GitHub"></a></div></div><p class="intro">In this guide, you’ll learn how to build a Change Data Capture (CDC) service using Ballerina to implement real-time fraud detection. The service monitors changes to a MySQL database and flags high-value transactions that exceed a defined threshold.</p><h2 id="prerequisites" data-section="prerequisites" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Prerequisites</h2>
<p>To follow along with this tutorial, ensure you have:</p>
<ul>
<li>
<p><a href="https://ballerina.io/downloads/" target="_blank" rel="nofollow noopener noreferrer">Ballerina 2201.12.0 (Swan Lake)</a> or later</p>
</li>
<li>
<p>A text editor</p>
<blockquote>
<p><strong>Tip:</strong> Preferably <a href="https://code.visualstudio.com/" target="_blank" rel="nofollow noopener noreferrer">Visual Studio Code</a> with the <a href="https://marketplace.visualstudio.com/items?itemName=WSO2.ballerina" target="_blank" rel="nofollow noopener noreferrer">Ballerina extension</a></p>
</blockquote>
</li>
<li>
<p>A terminal or command-line interface</p>
</li>
<li>
<p>MySQL 8.0 or later</p>
</li>
</ul>
<h2 id="set-up-a-mysql-server-instance" data-section="set-up-a-mysql-server-instance" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Set up a MySQL server instance</h2>
<p>You can use one of the following methods to set up MySQL:</p>
<ol>
<li><strong>Install MySQL locally</strong> from the <a href="https://dev.mysql.com/doc/mysql-getting-started/en/#mysql-getting-started-installing" target="_blank" rel="nofollow noopener noreferrer">official MySQL site</a></li>
<li><strong>Use a server stack</strong> like <a href="https://www.apachefriends.org/" target="_blank" rel="nofollow noopener noreferrer">XAMPP</a> or <a href="https://wampserver.aviatechno.net/" target="_blank" rel="nofollow noopener noreferrer">WampServer</a></li>
<li><strong>Run MySQL in Docker</strong> using <a href="https://dev.mysql.com/doc/mysql-installation-excerpt/8.0/en/docker-mysql-getting-started.html" target="_blank" rel="nofollow noopener noreferrer">these official instructions</a></li>
<li><strong>Use a cloud-hosted instance</strong> from <a href="https://cloud.google.com/sql" target="_blank" rel="nofollow noopener noreferrer">Google Cloud SQL</a>, <a href="https://aws.amazon.com/rds/mysql/" target="_blank" rel="nofollow noopener noreferrer">Amazon RDS</a>, or <a href="https://azure.microsoft.com/en-us/services/mysql/" target="_blank" rel="nofollow noopener noreferrer">Azure Database for MySQL</a></li>
</ol>
<blockquote>
<p><strong>Tip:</strong> Keep your MySQL connection details (host, port, username, and password) handy.</p>
</blockquote>
<h2 id="set-up-the-mysql-database" data-section="set-up-the-mysql-database" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Set up the MySQL database</h2>
<h3 id="enable-cdc-in-mysql" data-section="enable-cdc-in-mysql" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Enable CDC in MySQL</h3>
<p>CDC relies on <a href="https://dev.mysql.com/doc/refman/8.4/en/binary-log.html" target="_blank" rel="nofollow noopener noreferrer">MySQL’s binary logging</a> feature, which is enabled by default in MySQL 8.0+ unless explicitly disabled.</p>
<h4 id="verify-binary-logging" data-section="verify-binary-logging" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Verify binary logging</h4>
<p>Run the following SQL to confirm:</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#24292E">SHOW VARIABLES </span><span style="color:#D73A49">LIKE</span><span style="color:#032F62"> 'log_bin'</span><span style="color:#24292E">;</span></span></code></pre></div></div></pre>
<p>If <code>log_bin</code> is <code>ON</code>, you&#x27;re good to go.</p>
<h4 id="ensure-proper-cdc-settings" data-section="ensure-proper-cdc-settings" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Ensure proper CDC settings</h4>
<p>Also, verify the following:</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#24292E">SHOW VARIABLES </span><span style="color:#D73A49">LIKE</span><span style="color:#032F62"> 'binlog_format'</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">SHOW VARIABLES </span><span style="color:#D73A49">LIKE</span><span style="color:#032F62"> 'binlog_row_image'</span><span style="color:#24292E">;</span></span></code></pre></div></div></pre>
<p>If needed, update your <code>my.cnf</code> or <code>my.ini</code> file:</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span>[mysqld]</span></span>
<span class="line"><span>server-id=223344</span></span>
<span class="line"><span>log-bin=mysql-bin</span></span>
<span class="line"><span>binlog-format=ROW</span></span>
<span class="line"><span>binlog-row-image=FULL</span></span></code></pre></div></div></pre>
<p>Then restart MySQL to apply the changes.</p>
<h3 id="create-necessary-tables" data-section="create-necessary-tables" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Create necessary tables</h3>
<p>Log in to your MySQL server and execute:</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">CREATE</span><span style="color:#D73A49"> DATABASE</span><span style="color:#6F42C1"> IF</span><span style="color:#D73A49"> NOT</span><span style="color:#D73A49"> EXISTS</span><span style="color:#24292E"> finance_db;</span></span>
<span class="line"><span style="color:#D73A49">USE</span><span style="color:#24292E"> finance_db;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">CREATE</span><span style="color:#D73A49"> TABLE</span><span style="color:#6F42C1"> transactions</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#24292E">    tx_id </span><span style="color:#D73A49">INT</span><span style="color:#24292E"> AUTO_INCREMENT </span><span style="color:#D73A49">PRIMARY KEY</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    user_id </span><span style="color:#D73A49">INT</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    amount </span><span style="color:#D73A49">DECIMAL</span><span style="color:#24292E">(</span><span style="color:#005CC5">10</span><span style="color:#24292E">,</span><span style="color:#005CC5">2</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#D73A49">    status</span><span style="color:#D73A49"> VARCHAR</span><span style="color:#24292E">(</span><span style="color:#005CC5">50</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#24292E">    created_at </span><span style="color:#D73A49">DATETIME</span></span>
<span class="line"><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">INSERT INTO</span><span style="color:#24292E"> transactions (user_id, amount, </span><span style="color:#D73A49">status</span><span style="color:#24292E">, created_at) </span><span style="color:#D73A49">VALUES</span></span>
<span class="line"><span style="color:#24292E">(</span><span style="color:#005CC5">10</span><span style="color:#24292E">, </span><span style="color:#005CC5">9000</span><span style="color:#24292E">.</span><span style="color:#005CC5">00</span><span style="color:#24292E">, </span><span style="color:#032F62">'COMPLETED'</span><span style="color:#24292E">, </span><span style="color:#032F62">'2025-04-01 08:00:00'</span><span style="color:#24292E">),</span></span>
<span class="line"><span style="color:#24292E">(</span><span style="color:#005CC5">11</span><span style="color:#24292E">, </span><span style="color:#005CC5">12000</span><span style="color:#24292E">.</span><span style="color:#005CC5">00</span><span style="color:#24292E">, </span><span style="color:#032F62">'COMPLETED'</span><span style="color:#24292E">, </span><span style="color:#032F62">'2025-04-01 08:10:00'</span><span style="color:#24292E">), </span><span style="color:#6A737D">-- this triggers fraud logic</span></span>
<span class="line"><span style="color:#24292E">(</span><span style="color:#005CC5">12</span><span style="color:#24292E">, </span><span style="color:#005CC5">4500</span><span style="color:#24292E">.</span><span style="color:#005CC5">00</span><span style="color:#24292E">, </span><span style="color:#032F62">'PENDING'</span><span style="color:#24292E">, </span><span style="color:#032F62">'2025-04-01 08:30:00'</span><span style="color:#24292E">);</span></span></code></pre></div></div></pre>
<h2 id="create-a-ballerina-service-package" data-section="create-a-ballerina-service-package" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Create a Ballerina service package</h2>
<p>Ballerina uses packages to group code. You need to create a Ballerina package and write the business logic.</p>
<blockquote>
<p><strong>Info:</strong> For more information on Ballerina packages, see <a href="https://ballerina.io/learn/organize-ballerina-code/" target="_blank" rel="nofollow noopener noreferrer">Organize Ballerina code</a>.</p>
</blockquote>
<p>In the terminal, run the following to create a new Ballerina package:</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#ffffff;tab-index:0"><code>$ bal new fraud_detection
</code></pre></div></div></pre>
<p>This creates:</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"></div><div><pre class="shiki github-light" style="background-color:#ffffff;tab-index:0"><code>fraud_detection/
├── Ballerina.toml
└── main.bal
</code></pre></div></div></pre>
<blockquote>
<p><strong>Tip:</strong> Delete the auto-generated <code>main.bal</code> — we’ll create our own.</p>
</blockquote>
<h2 id="define-the-transaction-record" data-section="define-the-transaction-record" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Define the <code>Transaction</code> record</h2>
<p>In Ballerina, records represent structured data. Define one that matches the <code>transactions</code> table:</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">type</span><span style="color:#6F42C1"> Transactions</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    int</span><span style="color:#24292E"> tx_id;</span></span>
<span class="line"><span style="color:#005CC5">    int</span><span style="color:#24292E"> user_id;</span></span>
<span class="line"><span style="color:#005CC5">    float</span><span style="color:#24292E"> amount;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> status;</span></span>
<span class="line"><span style="color:#005CC5">    int</span><span style="color:#24292E"> created_at;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span></code></pre></div></div></pre>
<h2 id="import-required-modules" data-section="import-required-modules" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Import required modules</h2>
<p>Add the following imports to your Ballerina program:</p>
<ul>
<li><code>ballerinax/cdc</code>: Core module that provides APIs to capture and process database change events.</li>
<li><code>ballerinax/mysql</code>: Provides MySQL-specific listener and types for CDC.</li>
<li><code>ballerinax/mysql.cdc.driver as _</code>: Debezium-based driver for MySQL CDC.</li>
</ul>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/cdc;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/mysql;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/mysql.cdc.driver </span><span style="color:#D73A49">as</span><span style="color:#24292E"> _;</span></span></code></pre></div></div></pre>
<h2 id="add-cdc-listener-and-base-service" data-section="add-cdc-listener-and-base-service" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Add CDC listener and base service</h2>
<p>Set up the CDC listener using the <a href="https://central.ballerina.io/ballerinax/mysql/latest#CdcListener" target="_blank" rel="nofollow noopener noreferrer"><code>mysql:CdcListener</code></a> and <a href="https://central.ballerina.io/ballerinax/cdc/latest#Service" target="_blank" rel="nofollow noopener noreferrer"><code>cdc:Service</code></a>:</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/cdc;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/mysql;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/mysql.cdc.driver </span><span style="color:#D73A49">as</span><span style="color:#24292E"> _;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> username </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> password </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">listener</span><span style="color:#24292E"> mysql</span><span style="color:#D73A49">:</span><span style="color:#24292E">CdcListener financeDBListener </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#E36209">    database</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        username,</span></span>
<span class="line"><span style="color:#24292E">        password,</span></span>
<span class="line"><span style="color:#24292E">        includedDatabases</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "finance_db"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">        includedTables</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "finance_db.transactions"</span></span>
<span class="line"><span style="color:#24292E">    },</span></span>
<span class="line"><span style="color:#E36209">    options</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        snapshotMode</span><span style="color:#D73A49">:</span><span style="color:#24292E"> cdc:NO_DATA,</span></span>
<span class="line"><span style="color:#24292E">        skippedOperations</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span><span style="color:#6F42C1">cdc</span><span style="color:#24292E">:TRUNCATE, </span><span style="color:#6F42C1">cdc</span><span style="color:#24292E">:UPDATE, </span><span style="color:#6F42C1">cdc</span><span style="color:#24292E">:DELETE]</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">);</span></span></code></pre></div></div></pre>
<blockquote>
<p><strong>Tip:</strong> Use <a href="https://ballerina.io/learn/configure-a-sample-ballerina-service/" target="_blank" rel="nofollow noopener noreferrer">Ballerina configurable variables</a> to manage credentials securely.</p>
</blockquote>
<p><em>Define the CDC Service</em></p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">service</span><span style="color:#24292E"> cdc:Service </span><span style="color:#D73A49">on</span><span style="color:#24292E"> financeDBListener {</span></span>
<span class="line"><span style="color:#D73A49">    isolated</span><span style="color:#D73A49"> remote</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> onCreate</span><span style="color:#24292E">(</span><span style="color:#E36209">Transactions</span><span style="color:#E36209"> trx</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        log</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">printInfo</span><span style="color:#24292E">(</span><span style="color:#032F62">`Transaction with id: ${</span><span style="color:#24292E">trx</span><span style="color:#032F62">.</span><span style="color:#24292E">tx_id</span><span style="color:#032F62">}`</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">        if</span><span style="color:#24292E"> trx.amount </span><span style="color:#D73A49">></span><span style="color:#005CC5"> 10000.0</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">            log</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">printWarn</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#032F62">                `⚠️ Fraud alert: High-value transaction detected: </span></span>
<span class="line"><span style="color:#032F62">                Id: ${</span><span style="color:#24292E">trx</span><span style="color:#032F62">.</span><span style="color:#24292E">tx_id</span><span style="color:#032F62">}, </span></span>
<span class="line"><span style="color:#032F62">                User Id: ${</span><span style="color:#24292E">trx</span><span style="color:#032F62">.</span><span style="color:#24292E">user_id</span><span style="color:#032F62">}, </span></span>
<span class="line"><span style="color:#032F62">                Amount: $${</span><span style="color:#24292E">trx</span><span style="color:#032F62">.</span><span style="color:#24292E">amount</span><span style="color:#032F62">}`</span></span>
<span class="line"><span style="color:#24292E">            );</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">    isolated</span><span style="color:#D73A49"> remote</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> onError</span><span style="color:#24292E">(</span><span style="color:#E36209">cdc</span><span style="color:#D73A49">:</span><span style="color:#24292E">Error e) {</span></span>
<span class="line"><span style="color:#24292E">        log</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">printError</span><span style="color:#24292E">(</span><span style="color:#032F62">"CDC error occurred"</span><span style="color:#24292E">, </span><span style="color:#E36209">e</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></div></pre>
<blockquote>
<p><strong>Note:</strong> We&#x27;re only handling <code>onCreate</code> here, but the service can also support <code>onRead</code>, <code>onUpdate</code>, and <code>onDelete</code>.</p>
</blockquote>
<h2 id="the-complete-code" data-section="the-complete-code" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>The complete code</h2>
<p>Here’s the complete <code>main.bal</code>:</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/log;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/cdc;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/mysql;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/mysql.cdc.driver </span><span style="color:#D73A49">as</span><span style="color:#24292E"> _;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> username </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> password </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">type</span><span style="color:#6F42C1"> Transactions</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    int</span><span style="color:#24292E"> tx_id;</span></span>
<span class="line"><span style="color:#005CC5">    int</span><span style="color:#24292E"> user_id;</span></span>
<span class="line"><span style="color:#005CC5">    float</span><span style="color:#24292E"> amount;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> status;</span></span>
<span class="line"><span style="color:#005CC5">    int</span><span style="color:#24292E"> created_at;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">listener</span><span style="color:#24292E"> mysql</span><span style="color:#D73A49">:</span><span style="color:#24292E">CdcListener financeDBListener </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span></span>
<span class="line"><span style="color:#E36209">    database</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        username,</span></span>
<span class="line"><span style="color:#24292E">        password,</span></span>
<span class="line"><span style="color:#24292E">        includedDatabases</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "finance_db"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">        includedTables</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "finance_db.transactions"</span></span>
<span class="line"><span style="color:#24292E">    },</span></span>
<span class="line"><span style="color:#E36209">    options</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        snapshotMode</span><span style="color:#D73A49">:</span><span style="color:#24292E"> cdc:NO_DATA,</span></span>
<span class="line"><span style="color:#24292E">        skippedOperations</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span><span style="color:#6F42C1">cdc</span><span style="color:#24292E">:TRUNCATE, </span><span style="color:#6F42C1">cdc</span><span style="color:#24292E">:UPDATE, </span><span style="color:#6F42C1">cdc</span><span style="color:#24292E">:DELETE]</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">service</span><span style="color:#24292E"> cdc:Service </span><span style="color:#D73A49">on</span><span style="color:#24292E"> financeDBListener {</span></span>
<span class="line"><span style="color:#D73A49">    isolated</span><span style="color:#D73A49"> remote</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> onCreate</span><span style="color:#24292E">(</span><span style="color:#E36209">Transactions</span><span style="color:#E36209"> trx</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        log</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">printInfo</span><span style="color:#24292E">(</span><span style="color:#032F62">`Transaction with id: ${</span><span style="color:#24292E">trx</span><span style="color:#032F62">.</span><span style="color:#24292E">tx_id</span><span style="color:#032F62">}`</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">        if</span><span style="color:#24292E"> trx.amount </span><span style="color:#D73A49">></span><span style="color:#005CC5"> 10000.0</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">            log</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">printWarn</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#032F62">                `⚠️ Fraud alert: High-value transaction detected: </span></span>
<span class="line"><span style="color:#032F62">                Id: ${</span><span style="color:#24292E">trx</span><span style="color:#032F62">.</span><span style="color:#24292E">tx_id</span><span style="color:#032F62">}, </span></span>
<span class="line"><span style="color:#032F62">                User Id: ${</span><span style="color:#24292E">trx</span><span style="color:#032F62">.</span><span style="color:#24292E">user_id</span><span style="color:#032F62">}, </span></span>
<span class="line"><span style="color:#032F62">                Amount: $${</span><span style="color:#24292E">trx</span><span style="color:#032F62">.</span><span style="color:#24292E">amount</span><span style="color:#032F62">}`</span></span>
<span class="line"><span style="color:#24292E">            );</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">    isolated</span><span style="color:#D73A49"> remote</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> onError</span><span style="color:#24292E">(</span><span style="color:#E36209">cdc</span><span style="color:#D73A49">:</span><span style="color:#24292E">Error e) {</span></span>
<span class="line"><span style="color:#24292E">        log</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">printError</span><span style="color:#24292E">(</span><span style="color:#032F62">"CDC error occurred"</span><span style="color:#24292E">, </span><span style="color:#E36209">e</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></div></pre>
<h2 id="run-the-service" data-section="run-the-service" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Run the service</h2>
<h3 id="add-the-credentials" data-section="add-the-credentials" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Add the credentials</h3>
<p>In the package directory, create a new file named <code>Config.toml</code> and specify the configurations below to connect to the MySQL database.</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#24292E">username=</span><span style="color:#032F62">"root"</span></span>
<span class="line"><span style="color:#24292E">password=</span><span style="color:#032F62">"rootPassword"</span></span></code></pre></div></div></pre>
<h3 id="execute-the-bal-run-command" data-section="execute-the-bal-run-command" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Execute the <code>bal run</code> command</h3>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#ffffff;tab-index:0"><code>$ bal run
</code></pre></div></div></pre>
<p>You should see the listener start up and await changes.</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"></div><div><pre class="shiki github-light" style="background-color:#ffffff;tab-index:0"><code>Compiling source
        foo/fraud_detection:0.1.0

Running executable
</code></pre></div></div></pre>
<h2 id="try-it-out" data-section="try-it-out" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Try it out</h2>
<p>Run the following SQL to simulate transactions:</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" style="float:right" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">USE</span><span style="color:#24292E"> finance_db;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">INSERT INTO</span><span style="color:#24292E"> transactions (user_id, amount, </span><span style="color:#D73A49">status</span><span style="color:#24292E">, created_at) </span><span style="color:#D73A49">VALUES</span></span>
<span class="line"><span style="color:#24292E">(</span><span style="color:#005CC5">11</span><span style="color:#24292E">, </span><span style="color:#005CC5">2000</span><span style="color:#24292E">.</span><span style="color:#005CC5">00</span><span style="color:#24292E">, </span><span style="color:#032F62">'COMPLETED'</span><span style="color:#24292E">, </span><span style="color:#032F62">'2025-04-01 08:10:00'</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">INSERT INTO</span><span style="color:#24292E"> transactions (user_id, amount, </span><span style="color:#D73A49">status</span><span style="color:#24292E">, created_at) </span><span style="color:#D73A49">VALUES</span></span>
<span class="line"><span style="color:#24292E">(</span><span style="color:#005CC5">11</span><span style="color:#24292E">, </span><span style="color:#005CC5">12000</span><span style="color:#24292E">.</span><span style="color:#005CC5">00</span><span style="color:#24292E">, </span><span style="color:#032F62">'COMPLETED'</span><span style="color:#24292E">, </span><span style="color:#032F62">'2025-04-01 08:10:00'</span><span style="color:#24292E">);</span></span></code></pre></div></div></pre>
<p>Expected output:</p>
<pre><div style="background:#eeeeee;padding:10px 10px 0px 0px;border-radius:5px;margin-top:10px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"></div><div><pre class="shiki github-light" style="background-color:#ffffff;tab-index:0"><code>time=2025-05-28T22:49:59.231+05:30 level=INFO module=wso2/fraud_detection message=&quot;Transaction with id: 5&quot;
time=2025-05-28T22:49:59.245+05:30 level=WARN module=wso2/fraud_detection message=&quot;⚠️ Fraud alert: High-value transaction detected: Id: 5, User Id: 11, Amount: $12000.0&quot;
</code></pre></div></div></pre>
<h2 id="learn-more" data-section="learn-more" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Learn more</h2>
<p>To learn more about CDC service in Ballerina, see the following.</p>
<ul>
<li><a href="https://central.ballerina.io/ballerinax/cdc/latest" target="_blank" rel="nofollow noopener noreferrer">CDC module docs</a></li>
<li><a href="https://central.ballerina.io/ballerinax/mysql/latest#CdcListener" target="_blank" rel="nofollow noopener noreferrer">MySQL CDC Listener</a></li>
<li><a href="https://ballerina.io/learn/by-example/#change-data-capture" target="_blank" rel="nofollow noopener noreferrer">CDC Examples</a></li>
</ul><div class="mt-5 mb-5 row"><div class="col-sm-6"></div><div class="col-sm-6"></div></div></div></div><div class="pageToc d-none d-sm-block col-xxl-3 col-sm-2"></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{"layout":"build-a-change-data-capture-service-left-nav-pages-swanlake","title":"Build a Change Data Capture (CDC) service in Ballerina","description":"Capture and process database changes in real-time using Ballerina CDC connectors.","keywords":"ballerina, cdc, change data capture, database, streaming, API","permalink":"/learn/build-a-change-data-capture-service-in-ballerina/","active":"build-a-change-data-capture-service","intro":"In this guide, you’ll learn how to build a Change Data Capture (CDC) service using Ballerina to implement real-time fraud detection. The service monitors changes to a MySQL database and flags high-value transactions that exceed a defined threshold."},"content":"\n## Prerequisites\n\nTo follow along with this tutorial, ensure you have:\n\n* [Ballerina 2201.12.0 (Swan Lake)](https://ballerina.io/downloads/) or later\n* A text editor  \n\n  \u003e **Tip:** Preferably [Visual Studio Code](https://code.visualstudio.com/) with the [Ballerina extension](https://marketplace.visualstudio.com/items?itemName=WSO2.ballerina)\n* A terminal or command-line interface\n* MySQL 8.0 or later\n\n## Set up a MySQL server instance\n\nYou can use one of the following methods to set up MySQL:\n\n1. **Install MySQL locally** from the [official MySQL site](https://dev.mysql.com/doc/mysql-getting-started/en/#mysql-getting-started-installing)\n2. **Use a server stack** like [XAMPP](https://www.apachefriends.org/) or [WampServer](https://wampserver.aviatechno.net/)\n3. **Run MySQL in Docker** using [these official instructions](https://dev.mysql.com/doc/mysql-installation-excerpt/8.0/en/docker-mysql-getting-started.html)\n4. **Use a cloud-hosted instance** from [Google Cloud SQL](https://cloud.google.com/sql), [Amazon RDS](https://aws.amazon.com/rds/mysql/), or [Azure Database for MySQL](https://azure.microsoft.com/en-us/services/mysql/)\n\n\u003e **Tip:** Keep your MySQL connection details (host, port, username, and password) handy.\n\n## Set up the MySQL database\n\n### Enable CDC in MySQL\n\nCDC relies on [MySQL’s binary logging](https://dev.mysql.com/doc/refman/8.4/en/binary-log.html) feature, which is enabled by default in MySQL 8.0+ unless explicitly disabled.\n\n#### Verify binary logging\n\nRun the following SQL to confirm:\n\n```sql\nSHOW VARIABLES LIKE 'log_bin';\n```\n\nIf `log_bin` is `ON`, you're good to go.\n\n#### Ensure proper CDC settings\n\nAlso, verify the following:\n\n```sql\nSHOW VARIABLES LIKE 'binlog_format';\nSHOW VARIABLES LIKE 'binlog_row_image';\n```\n\nIf needed, update your `my.cnf` or `my.ini` file:\n\n```ini\n[mysqld]\nserver-id=223344\nlog-bin=mysql-bin\nbinlog-format=ROW\nbinlog-row-image=FULL\n```\n\nThen restart MySQL to apply the changes.\n\n### Create necessary tables\n\nLog in to your MySQL server and execute:\n\n```sql\nCREATE DATABASE IF NOT EXISTS finance_db;\nUSE finance_db;\n\nCREATE TABLE transactions (\n    tx_id INT AUTO_INCREMENT PRIMARY KEY,\n    user_id INT,\n    amount DECIMAL(10,2),\n    status VARCHAR(50),\n    created_at DATETIME\n);\n\nINSERT INTO transactions (user_id, amount, status, created_at) VALUES\n(10, 9000.00, 'COMPLETED', '2025-04-01 08:00:00'),\n(11, 12000.00, 'COMPLETED', '2025-04-01 08:10:00'), -- this triggers fraud logic\n(12, 4500.00, 'PENDING', '2025-04-01 08:30:00');\n```\n\n## Create a Ballerina service package\n\nBallerina uses packages to group code. You need to create a Ballerina package and write the business logic.\n\n\u003e **Info:** For more information on Ballerina packages, see [Organize Ballerina code](https://ballerina.io/learn/organize-ballerina-code/).\n\nIn the terminal, run the following to create a new Ballerina package:\n\n```\n$ bal new fraud_detection\n```\n\nThis creates:\n\n```\nfraud_detection/\n├── Ballerina.toml\n└── main.bal\n```\n\n\u003e **Tip:** Delete the auto-generated `main.bal` — we’ll create our own.\n\n## Define the `Transaction` record\n\nIn Ballerina, records represent structured data. Define one that matches the `transactions` table:\n\n```ballerina\ntype Transactions record {|\n    int tx_id;\n    int user_id;\n    float amount;\n    string status;\n    int created_at;\n|};\n```\n\n## Import required modules\n\nAdd the following imports to your Ballerina program:\n\n- `ballerinax/cdc`: Core module that provides APIs to capture and process database change events.\n- `ballerinax/mysql`: Provides MySQL-specific listener and types for CDC.\n- `ballerinax/mysql.cdc.driver as _`: Debezium-based driver for MySQL CDC.\n\n```ballerina\nimport ballerinax/cdc;\nimport ballerinax/mysql;\nimport ballerinax/mysql.cdc.driver as _;\n```\n\n## Add CDC listener and base service\n\nSet up the CDC listener using the [`mysql:CdcListener`](https://central.ballerina.io/ballerinax/mysql/latest#CdcListener) and [`cdc:Service`](https://central.ballerina.io/ballerinax/cdc/latest#Service):\n\n```ballerina\nimport ballerinax/cdc;\nimport ballerinax/mysql;\nimport ballerinax/mysql.cdc.driver as _;\n\nconfigurable string username = ?;\nconfigurable string password = ?;\n\nlistener mysql:CdcListener financeDBListener = new (\n    database = {\n        username,\n        password,\n        includedDatabases: \"finance_db\",\n        includedTables: \"finance_db.transactions\"\n    },\n    options = {\n        snapshotMode: cdc:NO_DATA,\n        skippedOperations: [cdc:TRUNCATE, cdc:UPDATE, cdc:DELETE]\n    }\n);\n```\n\n\u003e **Tip:** Use [Ballerina configurable variables](https://ballerina.io/learn/configure-a-sample-ballerina-service/) to manage credentials securely.\n\n*Define the CDC Service*\n\n```ballerina\nservice cdc:Service on financeDBListener {\n    isolated remote function onCreate(Transactions trx) returns error? {\n        log:printInfo(`Transaction with id: ${trx.tx_id}`);\n        if trx.amount \u003e 10000.0 {\n            log:printWarn(\n                `⚠️ Fraud alert: High-value transaction detected: \n                Id: ${trx.tx_id}, \n                User Id: ${trx.user_id}, \n                Amount: $${trx.amount}`\n            );\n        }\n    }\n\n    isolated remote function onError(cdc:Error e) {\n        log:printError(\"CDC error occurred\", e);\n    }\n}\n```\n\n\u003e **Note:** We're only handling `onCreate` here, but the service can also support `onRead`, `onUpdate`, and `onDelete`.\n\n## The complete code\n\nHere’s the complete `main.bal`:\n\n```ballerina\nimport ballerina/log;\nimport ballerinax/cdc;\nimport ballerinax/mysql;\nimport ballerinax/mysql.cdc.driver as _;\n\nconfigurable string username = ?;\nconfigurable string password = ?;\n\ntype Transactions record {|\n    int tx_id;\n    int user_id;\n    float amount;\n    string status;\n    int created_at;\n|};\n\nlistener mysql:CdcListener financeDBListener = new (\n    database = {\n        username,\n        password,\n        includedDatabases: \"finance_db\",\n        includedTables: \"finance_db.transactions\"\n    },\n    options = {\n        snapshotMode: cdc:NO_DATA,\n        skippedOperations: [cdc:TRUNCATE, cdc:UPDATE, cdc:DELETE]\n    }\n);\n\nservice cdc:Service on financeDBListener {\n    isolated remote function onCreate(Transactions trx) returns error? {\n        log:printInfo(`Transaction with id: ${trx.tx_id}`);\n        if trx.amount \u003e 10000.0 {\n            log:printWarn(\n                `⚠️ Fraud alert: High-value transaction detected: \n                Id: ${trx.tx_id}, \n                User Id: ${trx.user_id}, \n                Amount: $${trx.amount}`\n            );\n        }\n    }\n\n    isolated remote function onError(cdc:Error e) {\n        log:printError(\"CDC error occurred\", e);\n    }\n}\n```\n\n## Run the service\n\n### Add the credentials\n\nIn the package directory, create a new file named `Config.toml` and specify the configurations below to connect to the MySQL database.\n\n```toml\nusername=\"root\"\npassword=\"rootPassword\"\n```\n\n### Execute the `bal run` command\n\n```\n$ bal run\n```\n\nYou should see the listener start up and await changes.\n```\nCompiling source\n        foo/fraud_detection:0.1.0\n\nRunning executable\n```\n\n## Try it out\n\nRun the following SQL to simulate transactions:\n\n```sql\nUSE finance_db;\n\nINSERT INTO transactions (user_id, amount, status, created_at) VALUES\n(11, 2000.00, 'COMPLETED', '2025-04-01 08:10:00');\n\nINSERT INTO transactions (user_id, amount, status, created_at) VALUES\n(11, 12000.00, 'COMPLETED', '2025-04-01 08:10:00');\n```\n\nExpected output:\n\n```\ntime=2025-05-28T22:49:59.231+05:30 level=INFO module=wso2/fraud_detection message=\"Transaction with id: 5\"\ntime=2025-05-28T22:49:59.245+05:30 level=WARN module=wso2/fraud_detection message=\"⚠️ Fraud alert: High-value transaction detected: Id: 5, User Id: 11, Amount: $12000.0\"\n```\n\n## Learn more\n\nTo learn more about CDC service in Ballerina, see the following.\n\n* [CDC module docs](https://central.ballerina.io/ballerinax/cdc/latest)\n* [MySQL CDC Listener](https://central.ballerina.io/ballerinax/mysql/latest#CdcListener)\n* [CDC Examples](https://ballerina.io/learn/by-example/#change-data-capture)\n","id":"build-a-change-data-capture-service-in-ballerina","sub":"featured-scenarios","third":"","slug":"featured-scenarios/build-a-change-data-capture-service-in-ballerina","codes":"[[324597558,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eSHOW VARIABLES \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eLIKE\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e 'log_bin'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[1648848907,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eSHOW VARIABLES \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eLIKE\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e 'binlog_format'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eSHOW VARIABLES \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eLIKE\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e 'binlog_row_image'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[551879033,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan\u003e[mysqld]\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan\u003eserver-id=223344\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan\u003elog-bin=mysql-bin\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan\u003ebinlog-format=ROW\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan\u003ebinlog-row-image=FULL\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[468515752,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eCREATE\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e DATABASE\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e IF\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e NOT\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e EXISTS\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e finance_db;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eUSE\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e finance_db;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eCREATE\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e TABLE\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e transactions\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e (\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    tx_id \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eINT\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e AUTO_INCREMENT \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ePRIMARY KEY\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    user_id \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eINT\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    amount \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eDECIMAL\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e10\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e2\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e),\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    status\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e VARCHAR\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e50\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e),\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    created_at \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eDATETIME\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eINSERT INTO\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e transactions (user_id, amount, \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003estatus\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, created_at) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eVALUES\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e10\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e9000\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e00\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e'COMPLETED'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e'2025-04-01 08:00:00'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e),\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e11\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e12000\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e00\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e'COMPLETED'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e'2025-04-01 08:10:00'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e), \u003c/span\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e-- this triggers fraud logic\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e12\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e4500\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e00\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e'PENDING'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e'2025-04-01 08:30:00'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[-1254634845,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003etype\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e Transactions\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e record\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    int\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e tx_id;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    int\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e user_id;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    float\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e amount;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e status;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    int\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e created_at;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[1231173846,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerinax/cdc;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerinax/mysql;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerinax/mysql.cdc.driver \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eas\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e _;\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[-245923791,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerinax/cdc;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerinax/mysql;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerinax/mysql.cdc.driver \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eas\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e _;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003econfigurable\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e username \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e ?\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003econfigurable\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e password \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e ?\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003elistener\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e mysql\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eCdcListener financeDBListener \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e (\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e    database\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e =\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        username,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        password,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        includedDatabases\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"finance_db\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        includedTables\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"finance_db.transactions\\\"\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    },\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e    options\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e =\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        snapshotMode\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e cdc:NO_DATA,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        skippedOperations\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e [\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003ecdc\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e:TRUNCATE, \u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003ecdc\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e:UPDATE, \u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003ecdc\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e:DELETE]\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[1858553738,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eservice\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e cdc:Service \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eon\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e financeDBListener {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    isolated\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e remote\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e onCreate\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eTransactions\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e trx\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e error?\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        log\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eprintInfo\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e`Transaction with id: ${\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etrx\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etx_id\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e}`\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        if\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e trx.amount \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e\u003e\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e 10000.0\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e            log\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eprintWarn\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e                `⚠️ Fraud alert: High-value transaction detected: \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e                Id: ${\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etrx\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etx_id\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e}, \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e                User Id: ${\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etrx\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003euser_id\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e}, \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e                Amount: $${\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etrx\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eamount\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e}`\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e            );\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    isolated\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e remote\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e onError\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003ecdc\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eError e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        log\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eprintError\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"CDC error occurred\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003ee\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[1418876369,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/log;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerinax/cdc;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerinax/mysql;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerinax/mysql.cdc.driver \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eas\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e _;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003econfigurable\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e username \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e ?\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003econfigurable\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e password \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e ?\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003etype\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e Transactions\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e record\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    int\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e tx_id;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    int\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e user_id;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    float\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e amount;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e status;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    int\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e created_at;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003elistener\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e mysql\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eCdcListener financeDBListener \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e (\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e    database\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e =\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        username,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        password,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        includedDatabases\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"finance_db\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        includedTables\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"finance_db.transactions\\\"\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    },\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e    options\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e =\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        snapshotMode\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e cdc:NO_DATA,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        skippedOperations\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e [\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003ecdc\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e:TRUNCATE, \u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003ecdc\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e:UPDATE, \u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003ecdc\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e:DELETE]\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eservice\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e cdc:Service \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eon\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e financeDBListener {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    isolated\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e remote\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e onCreate\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eTransactions\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e trx\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e error?\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        log\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eprintInfo\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e`Transaction with id: ${\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etrx\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etx_id\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e}`\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        if\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e trx.amount \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e\u003e\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e 10000.0\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e            log\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eprintWarn\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e                `⚠️ Fraud alert: High-value transaction detected: \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e                Id: ${\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etrx\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etx_id\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e}, \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e                User Id: ${\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etrx\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003euser_id\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e}, \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e                Amount: $${\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003etrx\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eamount\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e}`\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e            );\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    isolated\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e remote\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e onError\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003ecdc\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eError e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        log\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eprintError\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"CDC error occurred\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003ee\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[926587392,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eusername=\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"root\\\"\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003epassword=\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"rootPassword\\\"\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[1479489880,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eUSE\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e finance_db;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eINSERT INTO\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e transactions (user_id, amount, \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003estatus\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, created_at) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eVALUES\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e11\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e2000\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e00\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e'COMPLETED'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e'2025-04-01 08:10:00'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eINSERT INTO\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e transactions (user_id, amount, \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003estatus\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, created_at) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eVALUES\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e11\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e12000\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e00\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e'COMPLETED'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e'2025-04-01 08:10:00'\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"]]"},"__N_SSG":true},"page":"/learn/resources/[...slug]","query":{"slug":["featured-scenarios","build-a-change-data-capture-service-in-ballerina"]},"buildId":"6Bzrp9DXb6FB8ofNSgRhm","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>