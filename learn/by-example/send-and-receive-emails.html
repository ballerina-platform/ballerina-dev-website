---
layout: ballerina-example-page
title: Send and Receive Emails
description: Ballerina by Example is a hands-on introduction to Ballerina using annotated example programs. Check out the first example or browse the full list below.
permalink: /swan-lake/learn/by-example/send-and-receive-emails
redirect_from:
  - /vswan-lake/learn/by-example/send-and-receive-emails
  - /vswan-lake/learn/by-example/send-and-receive-emails.html
---
<div class="row cBallerina-io-Gray-row">
        <div class="container cBallerinaBySampleContainer">
            <div class="FullCode">
                <div class="highlight"><pre><span class="kn">import</span> <span class="nx">ballerina</span><span class="o">/</span><span class="nx">email</span><span class="p">;</span>
<span class="kn">import</span> <span class="nx">ballerina</span><span class="o">/</span><span class="nx">io</span><span class="p">;</span>

<span class="nx">public</span> <span class="kd">function</span> <span class="nx">main</span><span class="p">()</span> <span class="nx">returns</span> <span class="nx">error</span><span class="err">?</span> <span class="p">{</span>
    <span class="c1">// Creates an SMTP client with the connection parameters, host, username,</span>
    <span class="c1">// and password. The default port number `465` is used over SSL with these</span>
    <span class="c1">// configurations. `SmtpConfig` can be configured and passed to this</span>
    <span class="c1">// client if the port or security is to be customized.</span>
    <span class="nx">email</span><span class="p">:</span><span class="nx">SmtpClient</span> <span class="nx">smtpClient</span> <span class="p">=</span> <span class="nx">check</span> <span class="nx">new</span> <span class="p">(</span><span class="s">&quot;smtp.email.com&quot;</span><span class="p">,</span>
        <span class="s">&quot;sender@email.com&quot;</span> <span class="p">,</span> <span class="s">&quot;pass123&quot;</span><span class="p">);</span>

    <span class="c1">// Define the email that is required to be sent.</span>
    <span class="nx">email</span><span class="p">:</span><span class="nx">Message</span> <span class="nx">email</span> <span class="p">=</span> <span class="p">{</span>
        <span class="c1">// &quot;TO&quot;, &quot;CC&quot;, and &quot;BCC&quot; address lists are added as follows.</span>
        <span class="c1">// Only the &quot;TO&quot; address list is mandatory out of these three.</span>
        <span class="nx">to</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;receiver1@email.com&quot;</span><span class="p">,</span> <span class="s">&quot;receiver2@email.com&quot;</span><span class="p">],</span>
        <span class="nx">cc</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;receiver3@email.com&quot;</span><span class="p">,</span> <span class="s">&quot;receiver4@email.com&quot;</span><span class="p">],</span>
        <span class="nx">bcc</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;receiver5@email.com&quot;</span><span class="p">],</span>
        <span class="c1">// Subject of the email is added as follows. This field is mandatory.</span>
        <span class="nx">subject</span><span class="p">:</span> <span class="s">&quot;Sample Email&quot;</span><span class="p">,</span>
        <span class="c1">// Body content of the email is added as follows.</span>
        <span class="c1">// This field is mandatory.</span>
        <span class="nx">body</span><span class="p">:</span> <span class="s">&quot;This is a sample email.&quot;</span><span class="p">,</span>
        <span class="c1">// Email author&#39;s address is added as follows. This field is mandatory.</span>
        <span class="err">&#39;</span><span class="nx">from</span><span class="p">:</span> <span class="s">&quot;author@email.com&quot;</span><span class="p">,</span>
        <span class="c1">// Email sender service address is added as follows.</span>
        <span class="c1">// This field is optional. `Sender` is same as the `&#39;from` when the</span>
        <span class="c1">// email author himself sends the email.</span>
        <span class="nx">sender</span><span class="p">:</span> <span class="s">&quot;sender@email.com&quot;</span><span class="p">,</span>
        <span class="c1">// List of recipients when replying to the email is added as follows.</span>
        <span class="c1">// This field is optional. These addresses are required when the emails</span>
        <span class="c1">// are to be replied to some other address(es) other than the sender or</span>
        <span class="c1">// the author.</span>
        <span class="nx">replyTo</span><span class="p">:</span> <span class="p">[</span><span class="s">&quot;replyTo1@email.com&quot;</span><span class="p">,</span> <span class="s">&quot;replyTo2@email.com&quot;</span><span class="p">]</span>
    <span class="p">};</span>

    <span class="c1">// Send the email message with the client. The `sendEmail` method can be used</span>
    <span class="c1">// instead, if the email is required to be sent with mandatory and optional</span>
    <span class="c1">// parameters instead of configuring an `email:Message` record.</span>
    <span class="nx">check</span> <span class="nx">smtpClient</span><span class="o">-&gt;</span><span class="nx">sendEmailMessage</span><span class="p">(</span><span class="nx">email</span><span class="p">);</span>

    <span class="c1">// Create the client with the connection parameters, host, username, and</span>
    <span class="c1">// password. An error is returned in a failure. The default port number</span>
    <span class="c1">// `995` is used over SSL with these configurations.</span>
    <span class="nx">email</span><span class="p">:</span><span class="nx">PopClient</span> <span class="nx">popClient</span> <span class="p">=</span> <span class="nx">check</span> <span class="nx">new</span> <span class="p">(</span><span class="s">&quot;pop.email.com&quot;</span><span class="p">,</span> <span class="s">&quot;reader@email.com&quot;</span><span class="p">,</span>
        <span class="s">&quot;pass456&quot;</span><span class="p">);</span>

    <span class="c1">// Read the first unseen email received by the POP3 server. `()` is</span>
    <span class="c1">// returned when there are no new unseen emails. In error cases, an</span>
    <span class="c1">// error is returned.</span>
    <span class="nx">email</span><span class="p">:</span><span class="nx">Message</span><span class="err">?</span> <span class="nx">emailResponse</span> <span class="p">=</span> <span class="nx">check</span> <span class="nx">popClient</span><span class="o">-&gt;</span><span class="nx">receiveEmailMessage</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">emailResponse</span> <span class="nx">is</span> <span class="nx">email</span><span class="p">:</span><span class="nx">Message</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;POP client received an email.&quot;</span><span class="p">);</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Email Subject: &quot;</span><span class="p">,</span> <span class="nx">emailResponse</span><span class="p">.</span><span class="nx">subject</span><span class="p">);</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Email Body: &quot;</span><span class="p">,</span> <span class="nx">emailResponse</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
    <span class="c1">// When no emails are available in the server, `()` is returned.</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;There are no emails in the INBOX.&quot;</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// Create the client with the connection parameters, host, username, and</span>
    <span class="c1">// password. An error is received in a failure. The default port number</span>
    <span class="c1">// `993` is used over SSL with these configurations.</span>
    <span class="nx">email</span><span class="p">:</span><span class="nx">ImapClient</span> <span class="nx">imapClient</span> <span class="p">=</span> <span class="nx">check</span> <span class="nx">new</span> <span class="p">(</span><span class="s">&quot;imap.email.com&quot;</span><span class="p">,</span>
        <span class="s">&quot;reader@email.com&quot;</span><span class="p">,</span> <span class="s">&quot;pass456&quot;</span><span class="p">);</span>

    <span class="c1">// Read the first unseen email received by the IMAP4 server. `()` is</span>
    <span class="c1">// returned when there are no new unseen emails. In error cases, an</span>
    <span class="c1">// error is returned.</span>
    <span class="nx">emailResponse</span> <span class="p">=</span> <span class="nx">check</span> <span class="nx">imapClient</span><span class="o">-&gt;</span><span class="nx">receiveEmailMessage</span><span class="p">();</span>

    <span class="k">if</span> <span class="p">(</span><span class="nx">emailResponse</span> <span class="nx">is</span> <span class="nx">email</span><span class="p">:</span><span class="nx">Message</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;IMAP client received an email.&quot;</span><span class="p">);</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Email Subject: &quot;</span><span class="p">,</span> <span class="nx">emailResponse</span><span class="p">.</span><span class="nx">subject</span><span class="p">);</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Email Body: &quot;</span><span class="p">,</span> <span class="nx">emailResponse</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
    <span class="c1">// When no emails are available in the server, `()` is returned.</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>

        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;There are no emails in the INBOX.&quot;</span><span class="p">);</span>
    <span class="p">}</span>

<span class="p">}</span>

<span class="c1">// Create the listener with the connection parameters and the protocol-related</span>
<span class="c1">// configuration. The polling interval specifies the time duration between each poll</span>
<span class="c1">// performed by the listener in milliseconds.</span>
<span class="nx">listener</span> <span class="nx">email</span><span class="p">:</span><span class="nx">PopListener</span> <span class="nx">emailListener</span> <span class="p">=</span> <span class="nx">check</span> <span class="nx">new</span> <span class="p">({</span>
    <span class="nx">host</span><span class="p">:</span> <span class="s">&quot;pop.email.com&quot;</span><span class="p">,</span>
    <span class="nx">username</span><span class="p">:</span> <span class="s">&quot;reader@email.com&quot;</span><span class="p">,</span>
    <span class="nx">password</span><span class="p">:</span> <span class="s">&quot;pass456&quot;</span><span class="p">,</span>
    <span class="nx">pollingIntervalInMillis</span><span class="p">:</span> <span class="mi">2000</span><span class="p">,</span>
    <span class="nx">port</span><span class="p">:</span> <span class="mi">995</span>
<span class="p">});</span>

<span class="c1">// One or many services can listen to the email listener for the periodically-polled</span>
<span class="c1">// emails.</span>
<span class="kd">service</span> <span class="s">&quot;emailObserver&quot;</span> <span class="nx">on</span> <span class="nx">emailListener</span> <span class="p">{</span>

    <span class="c1">// When an email is successfully received, the `onEmailMessage` method is called.</span>
    <span class="nx">remote</span> <span class="kd">function</span> <span class="nx">onEmailMessage</span><span class="p">(</span><span class="nx">email</span><span class="p">:</span><span class="nx">Message</span> <span class="nx">emailMessage</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;POP Listener received an email.&quot;</span><span class="p">);</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Email Subject: &quot;</span><span class="p">,</span> <span class="nx">emailMessage</span><span class="p">.</span><span class="nx">subject</span><span class="p">);</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Email Body: &quot;</span><span class="p">,</span> <span class="nx">emailMessage</span><span class="p">.</span><span class="nx">body</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// When an error occurs during the email poll operations, the `onError` method is called.</span>
    <span class="nx">remote</span> <span class="kd">function</span> <span class="nx">onError</span><span class="p">(</span><span class="nx">email</span><span class="p">:</span><span class="nx">Error</span> <span class="nx">emailError</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">io</span><span class="p">:</span><span class="nb">println</span><span class="p">(</span><span class="s">&quot;Error while polling for the emails: &quot;</span>
            <span class="o">+</span> <span class="nx">emailError</span><span class="p">.</span><span class="kt">message</span><span class="p">());</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>

            </div>

            <div class="col-xs-12 col-sm-12 col-md-12">
                <table class="cTopInfoContainer cTopControlsContainer">
                    <tr>
                        <td class="cLeftTD">
                            <h2>Send and Receive Emails</h2>
                            <p><p>The Email Connector is used to send (with SMTP) and receive (with POP3 or
 IMAP4) emails using the SSL or STARTTLS protocols. This sample includes
 sending and receiving emails with default configurations over SSL using
 default ports.<br/><br/>
 For more information on the underlying module,
 see the <a href="https://ballerina.io/swan-lake/learn/api-docs/ballerina/#/ballerina/email/latest/email/">Email module</a>.</p>
</p>

                        </td>
                        <td class="cRightTD">
                            <div class="cTopButtonContainer">
                                
                                <div class="cButtonInfoContainer">
                                    <a class="prev" href="secured-client-with-oauth2-direct-token-type.html">
                                        <span>< PREVIOUS</span>
                                        <p>Secured Client with OAuth2 Direct Token Type</p>
                                    </a>
                                </div>
                                 
                            </div>
                        </td>
                    </tr>
                </table>
            </div>
            <div class="example" id="send-and-receive-emails">
                <div class="col-xs-12 col-sm-12 col-md-12 cBBETable-container cCodeLeft">
                    <table class="cTopControlsContainer">
                        <tr>
                            <td class="cLeftTD">
                                <div class="cBBE-links">
                                    <ul>
                                        <li>
                                            <a class="copy"><img src="/img/copy-icon.svg" /></a>
                                        </li>
                                        <li>
                                            <a target="_blank" href="https://github.com/ballerina-platform/ballerina-distribution/tree/master/examples/send-and-receive-emails/"><img src="/img/github-logo-green.svg" /></a>
                                        </li>
                                        
                                    </ul>
                                </div>
                            </td>
                            <td></td>
                        </tr>
                    </table>

                    <table class="cTopBorder-table">
                        <tr>
                            <td class="cCodeTD"></td>
                            <td class="cDescTD"></td>
                        </tr>
                    </table>

                    
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        
                            
                        

                    <div>

                        <table class="cBBE-body">
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>import ballerina/email;
import ballerina/io;
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>public function main() returns error? {
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    email:SmtpClient smtpClient = check new (&quot;smtp.email.com&quot;,
        &quot;sender@email.com&quot; , &quot;pass123&quot;);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Creates an SMTP client with the connection parameters, host, username,
 and password. The default port number <code>465</code> is used over SSL with these
 configurations. <code>SmtpConfig</code> can be configured and passed to this
 client if the port or security is to be customized.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    email:Message email = {
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Define the email that is required to be sent.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>        to: [&quot;receiver1@email.com&quot;, &quot;receiver2@email.com&quot;],
        cc: [&quot;receiver3@email.com&quot;, &quot;receiver4@email.com&quot;],
        bcc: [&quot;receiver5@email.com&quot;],
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>&ldquo;TO&rdquo;, &ldquo;CC&rdquo;, and &ldquo;BCC&rdquo; address lists are added as follows.
 Only the &ldquo;TO&rdquo; address list is mandatory out of these three.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>        subject: &quot;Sample Email&quot;,
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Subject of the email is added as follows. This field is mandatory.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>        body: &quot;This is a sample email.&quot;,
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Body content of the email is added as follows.
 This field is mandatory.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>        &#39;from: &quot;author@email.com&quot;,
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Email author&rsquo;s address is added as follows. This field is mandatory.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>        sender: &quot;sender@email.com&quot;,
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Email sender service address is added as follows.
 This field is optional. <code>Sender</code> is same as the <code>'from</code> when the
 email author himself sends the email.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>        replyTo: [&quot;replyTo1@email.com&quot;, &quot;replyTo2@email.com&quot;]
    };
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>List of recipients when replying to the email is added as follows.
 This field is optional. These addresses are required when the emails
 are to be replied to some other address(es) other than the sender or
 the author.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    check smtpClient-&gt;sendEmailMessage(email);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Send the email message with the client. The <code>sendEmail</code> method can be used
 instead, if the email is required to be sent with mandatory and optional
 parameters instead of configuring an <code>email:Message</code> record.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    email:PopClient popClient = check new (&quot;pop.email.com&quot;, &quot;reader@email.com&quot;,
        &quot;pass456&quot;);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Create the client with the connection parameters, host, username, and
 password. An error is returned in a failure. The default port number
 <code>995</code> is used over SSL with these configurations.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    email:Message? emailResponse = check popClient-&gt;receiveEmailMessage();
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Read the first unseen email received by the POP3 server. <code>()</code> is
 returned when there are no new unseen emails. In error cases, an
 error is returned.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    if (emailResponse is email:Message) {
        io:println(&quot;POP client received an email.&quot;);
        io:println(&quot;Email Subject: &quot;, emailResponse.subject);
        io:println(&quot;Email Body: &quot;, emailResponse.body);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    } else {
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>When no emails are available in the server, <code>()</code> is returned.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>        io:println(&quot;There are no emails in the INBOX.&quot;);
    }
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    email:ImapClient imapClient = check new (&quot;imap.email.com&quot;,
        &quot;reader@email.com&quot;, &quot;pass456&quot;);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Create the client with the connection parameters, host, username, and
 password. An error is received in a failure. The default port number
 <code>993</code> is used over SSL with these configurations.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    emailResponse = check imapClient-&gt;receiveEmailMessage();
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Read the first unseen email received by the IMAP4 server. <code>()</code> is
 returned when there are no new unseen emails. In error cases, an
 error is returned.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    if (emailResponse is email:Message) {
        io:println(&quot;IMAP client received an email.&quot;);
        io:println(&quot;Email Subject: &quot;, emailResponse.subject);
        io:println(&quot;Email Body: &quot;, emailResponse.body);
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    } else {
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>When no emails are available in the server, <code>()</code> is returned.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>        io:println(&quot;There are no emails in the INBOX.&quot;);
    }
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>}
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>listener email:PopListener emailListener = check new ({
    host: &quot;pop.email.com&quot;,
    username: &quot;reader@email.com&quot;,
    password: &quot;pass456&quot;,
    pollingIntervalInMillis: 2000,
    port: 995
});
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>Create the listener with the connection parameters and the protocol-related
 configuration. The polling interval specifies the time duration between each poll
 performed by the listener in milliseconds.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>service &quot;emailObserver&quot; on emailListener {
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>One or many services can listen to the email listener for the periodically-polled
 emails.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    remote function onEmailMessage(email:Message emailMessage) {
        io:println(&quot;POP Listener received an email.&quot;);
        io:println(&quot;Email Subject: &quot;, emailMessage.subject);
        io:println(&quot;Email Body: &quot;, emailMessage.body);
    }
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>When an email is successfully received, the <code>onEmailMessage</code> method is called.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR hover-enable">

                                <td class="code leading">
                                    <div class="highlight"><pre><code class=language-ballerina>    remote function onError(email:Error emailError) {
        io:println(&quot;Error while polling for the emails: &quot;
            + emailError.message());
    }
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                    <div class="cCodeDesription">
                                        <div>
                                            <p>When an error occurs during the email poll operations, the <code>onError</code> method is called.</p>

                                        </div>
                                    </div>
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR">

                                <td class="code">
                                    <div class="highlight"><pre><code class=language-ballerina>}
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                        </table>
                    </div>
                    
                        
                            
                                
                            
                        
                            
                                
                            
                        

                    <div>

                        <table class="cBBE-body">
                            
                            <tr class="cTR cOutputTr">

                                <td class="code leading cOutput">
                                    <div class="highlight"><pre><code class=shell-session># To run this sample, navigate to the directory that contains the
# `.bal` file, and execute the `bal run` command below.
bal run email.bal
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                            <tr class="cTR cOutputTr">

                                <td class="code cOutput">
                                    <div class="highlight"><pre><code class=shell-session># Check the inbox to view the sent emails.
# Subject and the content body of the received emails would be printed.
# Subject and the content body of the listened emails will be printed for each
# of the polled emails.
</code></pre></div>

                                </td>
                                <td class="docs">
                                    
                                </td>
                            </tr>
                            
                        </table>
                    </div>
                    


                    <table class="cBottomBorder-table">
                        <tr>
                            <td class="cCodeTD"></td>
                            <td class="cDescTD"></td>
                        </tr>
                    </table>
                </div>
            </div>
        </div>
    </div>

     <script>
            $(document).ready(function() {

                // hljs.initHighlightingOnLoad();

                $(".switch").click(function() {
                    $(".cCodeRight").toggleClass('cShow');
                    $(".cCodeLeft").toggleClass('cHide');
                });

                // register "copy to clipboard" event to elements with "copy" class
                var clipboard = new ClipboardJS('.copy', {
                    text: function(trigger) {
                        return $('.FullCode').find('pre').text();
                    }
                });

                // Register events show hide tooltip on click event
                clipboard.on('success', function(e) {
                    setTooltip(e.trigger, 'Copied!');
                    hideTooltip(e.trigger);
                });

                clipboard.on('error', function(e) {
                    setTooltip(e.trigger, 'Failed!');
                    hideTooltip(e.trigger);
                });

                $('.copy').tooltip({
                    trigger: 'click',
                    placement: 'bottom'
                });
                $("a.copy").unbind("click");
            });

            function setTooltip(btn, message) {
                $(btn).attr('data-original-title', message)
                    .tooltip('show');
            }

            function hideTooltip(btn) {
                setTimeout(function() {
                    $(btn).tooltip('hide').removeAttr('data-original-title');
                }, 1000);
            }
        </script>
