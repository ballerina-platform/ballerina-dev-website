<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="The document message transfers data from one application to another. The focus is on the data and reliability, not on the timing of the transfer."/><meta name="author" content="WSO2 LLC"/><meta name="keywords" content="ballerina, learn, documentation, docs, programming language"/><link rel="shortcut icon" href="/img/favicon.ico"/><title>EIP:  Document Message - The Ballerina programming language</title><meta property="og:type" content="article"/><meta property="og:title" content="EIP:  Document Message - The Ballerina programming language"/><meta property="og:description" content="The document message transfers data from one application to another. The focus is on the data and reliability, not on the timing of the transfer."/><meta property="og:title" content="EIP:  Document Message - The Ballerina programming language"/><meta property="og:image" content="https://ballerina.io/images/ballerina-swan-lake-eip-sm-banner.png"/><meta property="og:description" itemProp="image" content="The document message transfers data from one application to another. The focus is on the data and reliability, not on the timing of the transfer."/><meta name="twitter:site" content="@ballerinalang"/><meta name="twitter:creator" content="@ballerinalang"/><meta name="twitter:title" content="EIP:  Document Message - The Ballerina programming language"/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:description" content="The document message transfers data from one application to another. The focus is on the data and reliability, not on the timing of the transfer."/><meta name="twitter:image" content="https://ballerina.io/images/ballerina-swan-lake-eip-sm-banner.png"/><meta property="twitter:text:description" content="The document message transfers data from one application to another. The focus is on the data and reliability, not on the timing of the transfer."/><meta property="twitter:image" content="https://ballerina.io/images/ballerina-swan-lake-eip-sm-banner.png"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.setAttributeNode(d.createAttribute('data-ot-ignore'));j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PSL2TX4');</script><script type="text/javascript" crossorigin="true" src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"></script><script src="https://cookie-cdn.cookiepro.com/scripttemplates/otSDKStub.js" type="text/javascript" charSet="UTF-8" data-domain-script="630ad396-5fd5-4745-92ae-2765dc8841ee" defer=""></script><meta name="next-head-count" content="25"/><meta charSet="utf-8"/><meta name="author" content="WSO2 LLC"/><meta http-equiv="X-Frame-Options" content="SAMEORIGIN"/><meta http-equiv="Content-Security-Policy" content="frame-ancestors &#x27;none&#x27;;"/><link rel="shortcut icon" href="/images/favicon.ico"/><link rel="stylesheet" href="/css/roboto.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="/css/ballerina-search-button.css"/><link rel="stylesheet" href="/css/ballerina-search-modal.css"/><link rel="stylesheet" href="/css/ballerina-search-variables.css"/><link rel="stylesheet" href="/css/ballerina-search-style.css"/><link rel="preload" href="/_next/static/css/9bb35c8110b0fa38.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9bb35c8110b0fa38.css" data-n-g=""/><link rel="preload" href="/_next/static/css/b7d35c896f9865c2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/b7d35c896f9865c2.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-3651830a9b5ea2d2.js" defer=""></script><script src="/_next/static/chunks/framework-79bce4a3a540b080.js" defer=""></script><script src="/_next/static/chunks/main-0ea70f422df5d19e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ba2391f08766dae9.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-07afe3a69e1ba759.js" defer=""></script><script src="/_next/static/chunks/7621-d6bcd83f463fef72.js" defer=""></script><script src="/_next/static/chunks/6084-4e54ad5efcb8d3b5.js" defer=""></script><script src="/_next/static/chunks/51-100af16a0950a491.js" defer=""></script><script src="/_next/static/chunks/pages/learn/enterprise-integration-patterns/%5Bpattern%5D-2b9678b6262b59dd.js" defer=""></script><script src="/_next/static/2PJP8szgu-Ykbq-x_vIbc/_buildManifest.js" defer=""></script><script src="/_next/static/2PJP8szgu-Ykbq-x_vIbc/_ssgManifest.js" defer=""></script><script src="/_next/static/2PJP8szgu-Ykbq-x_vIbc/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSL2TX4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next" data-reactroot=""><div class="main-wrapper other vstack gap-0"><div class="wrap-page-content" style="padding-bottom:0"><div class="community-wrap-row row"><div class="col-sm-12"><div class="pageContentRow llanding pb-0 row"><div class="col-12"><div class="container"><div class="row"><div class="patternContent col-12"><div class="backToLanding" href="/learn/enterprise-integration-patterns/"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="#3ad1ca" class="bi bi-box-arrow-left ms-0" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0v2z"></path><path fill-rule="evenodd" d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"></path></svg><p class="m-0 p-0">Back to EIP</p></div></div></div></div></div></div><div class="pageHeader pageContentRow llanding row"><div class="col-12"><div class="container"><h1> Document Message</h1></div></div></div><div class="pageContentRow llanding row"><div class="col-12"><div class="container"><div class="row"><div class="patternContent col-12"><table class="Patterns_table__b7PHn"><tr><td>Pattern</td><td>The document message transfers data from one application to another. The focus is on the data and reliability, not on the timing of the transfer.<!-- --> <a href="https://www.enterpriseintegrationpatterns.com/patterns/messaging/DocumentMessage.html" style="color:#20b6b0"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M432,320H400a16,16,0,0,0-16,16V448H64V128H208a16,16,0,0,0,16-16V80a16,16,0,0,0-16-16H48A48,48,0,0,0,0,112V464a48,48,0,0,0,48,48H400a48,48,0,0,0,48-48V336A16,16,0,0,0,432,320ZM488,0h-128c-21.37,0-32.05,25.91-17,41l35.73,35.73L135,320.37a24,24,0,0,0,0,34L157.67,377a24,24,0,0,0,34,0L435.28,133.32,471,169c15,15,41,4.5,41-17V24A24,24,0,0,0,488,0Z"></path></svg></a></td></tr><tr><td>How Ballerina helps</td><td><p>Ballerina supports sending and receiving data in multiple formats such as JSON and XML over different protocols such as HTTP, GRPC, Kafka, etc. Depending on the protocol, Ballerina provides different reliability mechanisms. As an example, the Ballerina HTTP client supports retries, load balancing, and circuit breaking.</p></td></tr></table><div class="Patterns_tags__V1YUk"><span class="Patterns_tag__oMtq4 badge bg-primary">Document Message</span><span class="Patterns_tag__oMtq4 badge bg-primary">Message Channel</span><span class="Patterns_tag__oMtq4 badge bg-primary">Message Endpoint</span><span class="Patterns_tag__oMtq4 badge bg-primary">Point-to-Point Channel</span><span class="Patterns_tag__oMtq4 badge bg-primary">Request-Reply</span></div></div></div></div></div></div><div class="pageContentRow llanding row"><div class="col-12"><div class="container"><div><div class="CodeView_code__h13cx"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="CodeView_copyToClipboard__sqFoK" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg><div style="display:none"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/http;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/mime;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">type</span><span style="color:#6F42C1"> CsvRequest</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> org;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> filename;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">type</span><span style="color:#6F42C1"> ZohoResponse</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> status;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> code;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> message;</span></span>
<span class="line"><span style="color:#D73A49">    record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">        string</span><span style="color:#24292E"> file_id;</span></span>
<span class="line"><span style="color:#005CC5">        string</span><span style="color:#24292E"> created_time;</span></span>
<span class="line"><span style="color:#D73A49">    |</span><span style="color:#24292E">} details;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">final</span><span style="color:#24292E"> http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client zohoClient </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#032F62">"http://content.zohoapis.com.balmock.io"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6A737D">    // Retry 3 times with 1 second interval for error codes 404, 408, and 500.</span></span>
<span class="line"><span style="color:#E36209">    retryConfig</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> {count</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> 3</span><span style="color:#24292E">, interval</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> 1</span><span style="color:#24292E">, statusCodes</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span><span style="color:#005CC5">404</span><span style="color:#24292E">, </span><span style="color:#005CC5">408</span><span style="color:#24292E">, </span><span style="color:#005CC5">500</span><span style="color:#24292E">]}</span></span>
<span class="line"><span style="color:#24292E">);</span></span>
<span class="line"></span></code></pre></div><div class="CodeView_collapse__l9WX_">â‹¯</div><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#D73A49">service</span><span style="color:#6F42C1"> /crm</span><span style="color:#D73A49"> on</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> http:Listener(</span><span style="color:#005CC5">8080</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">    resource</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> post</span><span style="color:#6F42C1"> bulkUploadLeads</span><span style="color:#24292E">(</span><span style="color:#E36209">CsvRequest</span><span style="color:#E36209"> csvRequest</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#24292E"> ZohoResponse</span><span style="color:#D73A49">|error</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Request request </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">        request.</span><span style="color:#6F42C1">addHeader</span><span style="color:#24292E">(</span><span style="color:#032F62">"X-CRM_ORG"</span><span style="color:#24292E">, csvRequest.org);</span></span>
<span class="line"><span style="color:#24292E">        request.</span><span style="color:#6F42C1">addHeader</span><span style="color:#24292E">(</span><span style="color:#032F62">"feature"</span><span style="color:#24292E">, </span><span style="color:#032F62">"bulk-write"</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">        request.</span><span style="color:#6F42C1">setFileAsPayload</span><span style="color:#24292E">(</span><span style="color:#032F62">"./ftpincoming/"</span><span style="color:#D73A49"> +</span><span style="color:#24292E"> csvRequest.filename, </span><span style="color:#E36209">contentType</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> mime</span><span style="color:#D73A49">:</span><span style="color:#24292E">MULTIPART_FORM_DATA);</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#24292E"> zohoClient</span><span style="color:#D73A49">->/</span><span style="color:#24292E">crm</span><span style="color:#D73A49">/</span><span style="color:#24292E">v5</span><span style="color:#D73A49">/</span><span style="color:#24292E">upload.</span><span style="color:#6F42C1">post</span><span style="color:#24292E">(</span><span style="color:#E36209">request</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"></span></code></pre></div></div></div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"tagline":"Transfer data to another application","desc":"The document message transfers data from one application to another. The focus is on the data and reliability, not on the timing of the transfer.","category":"Message Construction","index":16,"helps":"Ballerina supports sending and receiving data in multiple formats such as JSON and XML over different protocols such as HTTP, GRPC, Kafka, etc. Depending on the protocol, Ballerina provides different reliability mechanisms. As an example, the Ballerina HTTP client supports retries, load balancing, and circuit breaking.","tags":["Document Message","Message Channel","Message Endpoint","Point-to-Point Channel","Request-Reply"],"link":"https://www.enterpriseintegrationpatterns.com/patterns/messaging/DocumentMessage.html","content":[{"headerCode":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ballerina/http;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ballerina/mime;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e CsvRequest\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e record\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e org;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e filename;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e ZohoResponse\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e record\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e status;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e code;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e message;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    record\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e        string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e file_id;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e        string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e created_time;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    |\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e} details;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efinal\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e http\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eClient zohoClient \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"http://content.zohoapis.com.balmock.io\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6A737D\"\u003e    // Retry 3 times with 1 second interval for error codes 404, 408, and 500.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E36209\"\u003e    retryConfig\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {count\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 3\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, interval\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 1\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, statusCodes\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e404\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e408\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e500\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e]}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","mainCode":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eservice\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e /crm\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e on\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e http:Listener(\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e8080\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    resource\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e post\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e bulkUploadLeads\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eCsvRequest\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003e csvRequest\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ZohoResponse\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|error\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        http\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eRequest request \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        request.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eaddHeader\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"X-CRM_ORG\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, csvRequest.org);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        request.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eaddHeader\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"feature\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"bulk-write\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        request.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003esetFileAsPayload\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"./ftpincoming/\"\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e +\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e csvRequest.filename, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003econtentType\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e mime\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eMULTIPART_FORM_DATA);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e zohoClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003ecrm\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003ev5\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eupload.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003epost\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003erequest\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e","raw":"import ballerina/http;\nimport ballerina/mime;\n\ntype CsvRequest record {|\n    string org;\n    string filename;\n|};\n\ntype ZohoResponse record {|\n    string status;\n    string code;\n    string message;\n    record {|\n        string file_id;\n        string created_time;\n    |} details;\n|};\n\nfinal http:Client zohoClient = check new (\"http://content.zohoapis.com.balmock.io\",\n    // Retry 3 times with 1 second interval for error codes 404, 408, and 500.\n    retryConfig = {count: 3, interval: 1, statusCodes: [404, 408, 500]}\n);\n\nservice /crm on new http:Listener(8080) {\n    resource function post bulkUploadLeads(CsvRequest csvRequest) returns ZohoResponse|error {\n        http:Request request = new;\n        request.addHeader(\"X-CRM_ORG\", csvRequest.org);\n        request.addHeader(\"feature\", \"bulk-write\");\n        request.setFileAsPayload(\"./ftpincoming/\" + csvRequest.filename, contentType = mime:MULTIPART_FORM_DATA);\n        return zohoClient-\u003e/crm/v5/upload.post(request);\n    }\n}\n","name":"document-message.bal"}],"name":" Document Message"},"__N_SSG":true},"page":"/learn/enterprise-integration-patterns/[pattern]","query":{"pattern":"document-message"},"buildId":"2PJP8szgu-Ykbq-x_vIbc","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>