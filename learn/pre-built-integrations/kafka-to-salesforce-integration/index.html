<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Update price book in Salesforce for each new message in Kafka"/><meta name="author" content="WSO2 LLC"/><meta name="keywords" content="ballerina, learn, documentation, docs, programming language"/><link rel="shortcut icon" href="/img/favicon.ico"/><title>Kafka to Salesforce integration - The Ballerina programming language</title><meta property="og:type" content="article"/><meta property="og:title" content="Kafka to Salesforce integration - The Ballerina programming language"/><meta property="og:description" content="Update price book in Salesforce for each new message in Kafka"/><meta property="og:title" content="Kafka to Salesforce integration - The Ballerina programming language"/><meta property="og:image" content="https://ballerina.io/images/ballerina-swan-lake-pre-built-integrations-sm-banner.png"/><meta property="og:description" itemProp="image" content="Update price book in Salesforce for each new message in Kafka"/><meta name="twitter:site" content="@ballerinalang"/><meta name="twitter:creator" content="@ballerinalang"/><meta name="twitter:title" content="Kafka to Salesforce integration - The Ballerina programming language"/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:description" content="Update price book in Salesforce for each new message in Kafka"/><meta name="twitter:image" content="https://ballerina.io/images/ballerina-swan-lake-pre-built-integrations-sm-banner.png"/><meta property="twitter:text:description" content="Update price book in Salesforce for each new message in Kafka"/><meta property="twitter:image" content="https://ballerina.io/images/ballerina-swan-lake-pre-built-integrations-sm-banner.png"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.setAttributeNode(d.createAttribute('data-ot-ignore'));j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PSL2TX4');</script><script type="text/javascript" crossorigin="true" src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"></script><script src="https://cookie-cdn.cookiepro.com/scripttemplates/otSDKStub.js" type="text/javascript" charSet="UTF-8" data-domain-script="630ad396-5fd5-4745-92ae-2765dc8841ee" defer=""></script><meta name="next-head-count" content="25"/><meta charSet="utf-8"/><meta name="author" content="WSO2 LLC"/><meta http-equiv="X-Frame-Options" content="SAMEORIGIN"/><meta http-equiv="Content-Security-Policy" content="frame-ancestors &#x27;none&#x27;;"/><link rel="shortcut icon" href="/images/favicon.ico"/><link rel="stylesheet" href="/css/roboto.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="/css/ballerina-search-button.css"/><link rel="stylesheet" href="/css/ballerina-search-modal.css"/><link rel="stylesheet" href="/css/ballerina-search-variables.css"/><link rel="stylesheet" href="/css/ballerina-search-style.css"/><link rel="preload" href="/_next/static/css/9bb35c8110b0fa38.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9bb35c8110b0fa38.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9ee6b616f8ba237c.js" defer=""></script><script src="/_next/static/chunks/framework-79bce4a3a540b080.js" defer=""></script><script src="/_next/static/chunks/main-0ea70f422df5d19e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ba2391f08766dae9.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-07afe3a69e1ba759.js" defer=""></script><script src="/_next/static/chunks/7621-d6bcd83f463fef72.js" defer=""></script><script src="/_next/static/chunks/8130-4f833ffdbe1dba0f.js" defer=""></script><script src="/_next/static/chunks/6242-7c6681de385c0d0b.js" defer=""></script><script src="/_next/static/chunks/1726-d958e891b50f9478.js" defer=""></script><script src="/_next/static/chunks/1205-52fd92c16c512500.js" defer=""></script><script src="/_next/static/chunks/pages/learn/integration/pre-built-integrations/kafka-to-salesforce-integration-a2cfa4cc257a0a78.js" defer=""></script><script src="/_next/static/OozPSa46wQy5M-VZfL4R9/_buildManifest.js" defer=""></script><script src="/_next/static/OozPSa46wQy5M-VZfL4R9/_ssgManifest.js" defer=""></script><script src="/_next/static/OozPSa46wQy5M-VZfL4R9/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSL2TX4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next" data-reactroot=""><div class="main-wrapper other vstack gap-0"><div class="wrap-page-content" style="padding-bottom:0"><div class="community-wrap-row row"><div class="col-sm-12"><div class="pageContentRow llanding pb-0 row"><div class="col-12"><div class="container"><div class="row"><div class="patternContent col-12"><div class="backToLanding" href="/learn/pre-built-integrations/"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="#3ad1ca" class="bi bi-box-arrow-left ms-0" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0v2z"></path><path fill-rule="evenodd" d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"></path></svg><p class="m-0 p-0">Back to pre-built integrations</p></div></div></div></div></div></div><div class="pageHeader pageContentRow llanding row"><div class="col-12"><div class="container"><h1>Kafka to Salesforce integration</h1></div></div></div><div class="pageContentRow llanding row"><div class="col-12"><div class="container"><div class="row"><div style="font-size:18px" class="col-lg-6 col-12"><p>In enterprises, business data like inventory levels, order statuses, or product prices change constantly, and multiple entities require access to these updates. Utilizing messaging systems like Kafka enables the real-time consumption of this information by multiple parties. Keeping Salesforce updated with frequently changing information such as current pricing is vital for the sales staff. Ballerina&#x27;s connectors and streaming capabilities facilitate this integration, allowing seamless connections between Salesforce and streaming data sources. It ensures that transformed and filtered data is constantly pushed to Salesforce, keeping all relevant information current and accessible.</p><p>The example below demonstrates how to update Salesforce price books in real-time based on the prices published to a Kafka topic.</p></div><div class="text-center mdContent col-lg-6 col-12"><img src="/images/pre-built/flow_diagrams/kafka-to-salesforce-integration.png" alt="Sequence Diagram"/></div></div></div></div></div><div class="pageContentRow llanding row"><div class="col-12"><div class="container"><ul class="mb-3 preBuilt nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><button type="button" id="react-aria1162923952-2-tab-code" role="tab" data-rr-ui-event-key="code" aria-controls="react-aria1162923952-2-tabpane-code" aria-selected="true" class="nav-link active">Code</button></li></ul><div class="tab-content"><div role="tabpanel" id="react-aria1162923952-2-tabpane-code" aria-labelledby="react-aria1162923952-2-tab-code" class="fade tab-pane active show"><div style="background:#eeeeee;padding:10px;border-radius:5px;margin-top:20px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><a href="https://github.com/ballerina-guides/integration-samples/tree/main/kafka_salesforce_integration" target="_blank" rel="noreferrer" title="Open on GitHub" style="margin-top:-5px"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" style="color:black;margin-right:10px" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/kafka;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/salesforce </span><span style="color:#D73A49">as</span><span style="color:#24292E"> sf;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> salesforceAccessToken </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> salesforceBaseUrl </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> salesforcePriceBookId </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> type</span><span style="color:#6F42C1"> ProductPrice</span><span style="color:#D73A49"> readonly</span><span style="color:#D73A49"> &#x26;</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> name;</span></span>
<span class="line"><span style="color:#005CC5">    float</span><span style="color:#24292E"> unitPrice;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> type</span><span style="color:#6F42C1"> ProductPriceUpdate</span><span style="color:#D73A49"> readonly</span><span style="color:#D73A49"> &#x26;</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    float</span><span style="color:#24292E"> UnitPrice;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">listener</span><span style="color:#24292E"> kafka</span><span style="color:#D73A49">:</span><span style="color:#24292E">Listener orderListener </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#E36209">kafka</span><span style="color:#D73A49">:</span><span style="color:#24292E">DEFAULT_URL, {</span></span>
<span class="line"><span style="color:#24292E">    groupId</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "order-group-id"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    topics</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "product_price_updates"</span></span>
<span class="line"><span style="color:#24292E">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">final</span><span style="color:#24292E"> sf</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client sfdcClient </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> ({</span></span>
<span class="line"><span style="color:#24292E">    baseUrl</span><span style="color:#D73A49">:</span><span style="color:#24292E"> salesforceBaseUrl,</span></span>
<span class="line"><span style="color:#24292E">    auth</span><span style="color:#D73A49">:</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        token</span><span style="color:#D73A49">:</span><span style="color:#24292E"> salesforceAccessToken</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">service</span><span style="color:#D73A49"> on</span><span style="color:#24292E"> orderListener {</span></span>
<span class="line"><span style="color:#D73A49">    isolated</span><span style="color:#D73A49"> remote</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> onConsumerRecord</span><span style="color:#24292E">(</span><span style="color:#E36209">ProductPrice</span><span style="color:#24292E">[] </span><span style="color:#E36209">prices</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">        foreach </span><span style="color:#24292E">ProductPrice {name, unitPrice} </span><span style="color:#D73A49">in</span><span style="color:#24292E"> prices {</span></span>
<span class="line"><span style="color:#D73A49">            stream&#x3C;record</span><span style="color:#24292E"> {}, </span><span style="color:#D73A49">error?></span><span style="color:#24292E"> retrievedStream </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> sfdcClient</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">query</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#005CC5">                string</span><span style="color:#032F62"> `SELECT Id FROM PricebookEntry </span></span>
<span class="line"><span style="color:#032F62">                    WHERE Pricebook2Id = '${</span><span style="color:#24292E">salesforcePriceBookId</span><span style="color:#032F62">}' AND </span></span>
<span class="line"><span style="color:#032F62">                    Name = '${</span><span style="color:#24292E">name</span><span style="color:#032F62">}'`</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">            record</span><span style="color:#24292E"> {}[] retrieved </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> from</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {} entry </span><span style="color:#D73A49">in</span><span style="color:#24292E"> retrievedStream</span></span>
<span class="line"><span style="color:#D73A49">                select</span><span style="color:#24292E"> entry;</span></span>
<span class="line"><span style="color:#005CC5">            anydata</span><span style="color:#24292E"> pricebookEntryId </span><span style="color:#D73A49">=</span><span style="color:#24292E"> retrieved[</span><span style="color:#005CC5">0</span><span style="color:#24292E">][</span><span style="color:#032F62">"Id"</span><span style="color:#24292E">];</span></span>
<span class="line"><span style="color:#D73A49">            if</span><span style="color:#24292E"> pricebookEntryId </span><span style="color:#D73A49">is</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">                ProductPriceUpdate updatedPrice </span><span style="color:#D73A49">=</span><span style="color:#24292E"> {UnitPrice</span><span style="color:#D73A49">:</span><span style="color:#24292E"> unitPrice};</span></span>
<span class="line"><span style="color:#D73A49">                check</span><span style="color:#24292E"> sfdcClient</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">update</span><span style="color:#24292E">(</span><span style="color:#032F62">"PricebookEntry"</span><span style="color:#24292E">, </span><span style="color:#E36209">pricebookEntryId</span><span style="color:#24292E">, </span><span style="color:#E36209">updatedPrice</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">            }</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></div></div></div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"samples":{"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ballerinax/kafka;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ballerinax/salesforce \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003eas\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e sf;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e salesforceAccessToken \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e ?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e salesforceBaseUrl \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e ?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e salesforcePriceBookId \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e ?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003epublic\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e type\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e ProductPrice\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e readonly\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e \u0026#x26;\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e record\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e name;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    float\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e unitPrice;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003epublic\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e type\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e ProductPriceUpdate\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e readonly\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e \u0026#x26;\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e record\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    float\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e UnitPrice;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003elistener\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e kafka\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eListener orderListener \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003ekafka\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eDEFAULT_URL, {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    groupId\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"order-group-id\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    topics\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"product_price_updates\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e});\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efinal\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e sf\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eClient sfdcClient \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ({\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    baseUrl\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e salesforceBaseUrl,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    auth\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        token\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e salesforceAccessToken\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e});\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eservice\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e on\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e orderListener {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    isolated\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e remote\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e onConsumerRecord\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eProductPrice\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e[] \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eprices\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        foreach \u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eProductPrice {name, unitPrice} \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e prices {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e            stream\u0026#x3C;record\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {}, \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003eerror?\u003e\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e retrievedStream \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e sfdcClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003equery\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e                string\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e `SELECT Id FROM PricebookEntry \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#032F62\"\u003e                    WHERE Pricebook2Id = '${\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003esalesforcePriceBookId\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e}' AND \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#032F62\"\u003e                    Name = '${\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003ename\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e}'`\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e            record\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {}[] retrieved \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e from\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e record\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {} entry \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e retrievedStream\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e                select\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e entry;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e            anydata\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e pricebookEntryId \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e retrieved[\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e][\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"Id\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e            if\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e pricebookEntryId \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003eis\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                ProductPriceUpdate updatedPrice \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {UnitPrice\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e unitPrice};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e                check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e sfdcClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eupdate\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"PricebookEntry\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003epricebookEntryId\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eupdatedPrice\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e"},"content":"\nimport ballerinax/kafka;\nimport ballerinax/salesforce as sf;\n\nconfigurable string salesforceAccessToken = ?;\nconfigurable string salesforceBaseUrl = ?;\nconfigurable string salesforcePriceBookId = ?;\n\npublic type ProductPrice readonly \u0026 record {|\n    string name;\n    float unitPrice;\n|};\n\npublic type ProductPriceUpdate readonly \u0026 record {|\n    float UnitPrice;\n|};\n\nlistener kafka:Listener orderListener = new (kafka:DEFAULT_URL, {\n    groupId: \"order-group-id\",\n    topics: \"product_price_updates\"\n});\n\nfinal sf:Client sfdcClient = check new ({\n    baseUrl: salesforceBaseUrl,\n    auth: {\n        token: salesforceAccessToken\n    }\n});\n\nservice on orderListener {\n    isolated remote function onConsumerRecord(ProductPrice[] prices) returns error? {\n        foreach ProductPrice {name, unitPrice} in prices {\n            stream\u003crecord {}, error?\u003e retrievedStream = check sfdcClient-\u003equery(\n                string `SELECT Id FROM PricebookEntry \n                    WHERE Pricebook2Id = '${salesforcePriceBookId}' AND \n                    Name = '${name}'`);\n            record {}[] retrieved = check from record {} entry in retrievedStream\n                select entry;\n            anydata pricebookEntryId = retrieved[0][\"Id\"];\n            if pricebookEntryId is string {\n                ProductPriceUpdate updatedPrice = {UnitPrice: unitPrice};\n                check sfdcClient-\u003eupdate(\"PricebookEntry\", pricebookEntryId, updatedPrice);\n            }\n        }\n    }\n}\n"},"__N_SSG":true},"page":"/learn/integration/pre-built-integrations/kafka-to-salesforce-integration","query":{},"buildId":"OozPSa46wQy5M-VZfL4R9","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>