<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Send a welcome email using Microsoft Outlook to new Shopify customers"/><meta name="author" content="WSO2 LLC"/><meta name="keywords" content="ballerina, learn, documentation, docs, programming language"/><link rel="shortcut icon" href="/img/favicon.ico"/><title>Shopify to Outlook integration - The Ballerina programming language</title><meta property="og:type" content="article"/><meta property="og:title" content="Shopify to Outlook integration - The Ballerina programming language"/><meta property="og:description" content="Send a welcome email using Microsoft Outlook to new Shopify customers"/><meta property="og:title" content="Shopify to Outlook integration - The Ballerina programming language"/><meta property="og:image" content="https://ballerina.io/images/ballerina-swan-lake-pre-built-integrations-sm-banner.png"/><meta property="og:description" itemProp="image" content="Send a welcome email using Microsoft Outlook to new Shopify customers"/><meta name="twitter:site" content="@ballerinalang"/><meta name="twitter:creator" content="@ballerinalang"/><meta name="twitter:title" content="Shopify to Outlook integration - The Ballerina programming language"/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:description" content="Send a welcome email using Microsoft Outlook to new Shopify customers"/><meta name="twitter:image" content="https://ballerina.io/images/ballerina-swan-lake-pre-built-integrations-sm-banner.png"/><meta property="twitter:text:description" content="Send a welcome email using Microsoft Outlook to new Shopify customers"/><meta property="twitter:image" content="https://ballerina.io/images/ballerina-swan-lake-pre-built-integrations-sm-banner.png"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.setAttributeNode(d.createAttribute('data-ot-ignore'));j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PSL2TX4');</script><script type="text/javascript" crossorigin="true" src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"></script><script src="https://cookie-cdn.cookiepro.com/scripttemplates/otSDKStub.js" type="text/javascript" charSet="UTF-8" data-domain-script="630ad396-5fd5-4745-92ae-2765dc8841ee" defer=""></script><meta name="next-head-count" content="25"/><meta charSet="utf-8"/><meta name="author" content="WSO2 LLC"/><meta http-equiv="X-Frame-Options" content="SAMEORIGIN"/><meta http-equiv="Content-Security-Policy" content="frame-ancestors &#x27;none&#x27;;"/><link rel="shortcut icon" href="/images/favicon.ico"/><link rel="stylesheet" href="/css/roboto.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="/css/ballerina-search-button.css"/><link rel="stylesheet" href="/css/ballerina-search-modal.css"/><link rel="stylesheet" href="/css/ballerina-search-variables.css"/><link rel="stylesheet" href="/css/ballerina-search-style.css"/><link rel="preload" href="/_next/static/css/9bb35c8110b0fa38.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9bb35c8110b0fa38.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9ee6b616f8ba237c.js" defer=""></script><script src="/_next/static/chunks/framework-79bce4a3a540b080.js" defer=""></script><script src="/_next/static/chunks/main-0ea70f422df5d19e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ba2391f08766dae9.js" defer=""></script><script src="/_next/static/chunks/1bfc9850-07afe3a69e1ba759.js" defer=""></script><script src="/_next/static/chunks/7621-d6bcd83f463fef72.js" defer=""></script><script src="/_next/static/chunks/8130-4f833ffdbe1dba0f.js" defer=""></script><script src="/_next/static/chunks/6242-7c6681de385c0d0b.js" defer=""></script><script src="/_next/static/chunks/1726-d958e891b50f9478.js" defer=""></script><script src="/_next/static/chunks/1205-52fd92c16c512500.js" defer=""></script><script src="/_next/static/chunks/pages/learn/integration/pre-built-integrations/shopify-to-outlook-integration-e9a7579728a96893.js" defer=""></script><script src="/_next/static/Xv-Reh5BOmB4ouxMMl_Ai/_buildManifest.js" defer=""></script><script src="/_next/static/Xv-Reh5BOmB4ouxMMl_Ai/_ssgManifest.js" defer=""></script><script src="/_next/static/Xv-Reh5BOmB4ouxMMl_Ai/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSL2TX4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next" data-reactroot=""><div class="main-wrapper other vstack gap-0"><div class="wrap-page-content" style="padding-bottom:0"><div class="community-wrap-row row"><div class="col-sm-12"><div class="pageContentRow llanding pb-0 row"><div class="col-12"><div class="container"><div class="row"><div class="patternContent col-12"><div class="backToLanding" href="/learn/pre-built-integrations/"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="#3ad1ca" class="bi bi-box-arrow-left ms-0" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M6 12.5a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-9a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v2a.5.5 0 0 1-1 0v-2A1.5 1.5 0 0 1 6.5 2h8A1.5 1.5 0 0 1 16 3.5v9a1.5 1.5 0 0 1-1.5 1.5h-8A1.5 1.5 0 0 1 5 12.5v-2a.5.5 0 0 1 1 0v2z"></path><path fill-rule="evenodd" d="M.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L1.707 7.5H10.5a.5.5 0 0 1 0 1H1.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"></path></svg><p class="m-0 p-0">Back to pre-built integrations</p></div></div></div></div></div></div><div class="pageHeader pageContentRow llanding row"><div class="col-12"><div class="container"><h1>Shopify to Outlook integration</h1></div></div></div><div class="pageContentRow llanding row"><div class="col-12"><div class="container"><div class="row"><div style="font-size:18px" class="col-lg-6 col-12"><p>In modern e-commerce, customer interactions are pivotal. Effective email communication enables businesses to offer targeted support, updates, and recommendations. By integrating Shopify with email platforms, companies can automate essential communications like order confirmations and shipping updates while also personalizing product suggestions.</p><p>The example below demonstrates how to integrate Shopify and Outlook to send automatic welcome emails to new customers.</p></div><div class="text-center mdContent col-lg-6 col-12"><img src="/images/pre-built/flow_diagrams/shopify-to-outlook-integration.png" alt="Flow Diagram"/></div></div></div></div></div><div class="pageContentRow llanding row"><div class="col-12"><div class="container"><ul class="mb-3 preBuilt nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><button type="button" id="react-aria9923911857-5-tab-code" role="tab" data-rr-ui-event-key="code" aria-controls="react-aria9923911857-5-tabpane-code" aria-selected="true" class="nav-link active">Code</button></li><li class="nav-item" role="presentation"><button type="button" id="react-aria9923911857-5-tab-diagram" role="tab" data-rr-ui-event-key="diagram" aria-controls="react-aria9923911857-5-tabpane-diagram" aria-selected="false" tabindex="-1" class="nav-link">Diagram</button></li></ul><div class="tab-content"><div role="tabpanel" id="react-aria9923911857-5-tabpane-code" aria-labelledby="react-aria9923911857-5-tab-code" class="fade tab-pane active show"><div style="background:#eeeeee;padding:10px;border-radius:5px;margin-top:20px;background-color:#eeeeee !important"><div style="display:flex;justify-content:end"><a href="https://github.com/ballerina-guides/integration-samples/tree/main/shopify-new-customers-to-outlook-mail" target="_blank" rel="noreferrer" title="Open on GitHub" style="margin-top:-5px"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" style="color:black;margin-right:10px" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><title>Copy</title><path d="M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z"></path></svg></div><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/http;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/log;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/time;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/microsoft.onedrive;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/microsoft.outlook.mail;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerinax/shopify.admin </span><span style="color:#D73A49">as</span><span style="color:#24292E"> shopify;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> shopifyServiceUrl </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> xShopifyAccessToken </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> outlookAccessToken </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> oneDriveAccessToken </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> flyerFilePath </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> main</span><span style="color:#24292E">() </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    shopify</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client shopify </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> ({xShopifyAccessToken</span><span style="color:#D73A49">:</span><span style="color:#24292E"> xShopifyAccessToken}, </span><span style="color:#E36209">shopifyServiceUrl</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    mail</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client outlook </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> ({ auth</span><span style="color:#D73A49">:</span><span style="color:#24292E"> { token: outlookAccessToken }});</span></span>
<span class="line"><span style="color:#24292E">    onedrive</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client onedrive </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> ({auth</span><span style="color:#D73A49">:</span><span style="color:#24292E"> { token: oneDriveAccessToken}});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> dateOriginTime </span><span style="color:#D73A49">=</span><span style="color:#24292E"> time</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">utcToString</span><span style="color:#24292E">(</span><span style="color:#E36209">time</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">utcAddSeconds</span><span style="color:#24292E">(</span><span style="color:#E36209">time</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">utcNow</span><span style="color:#24292E">(), </span><span style="color:#D73A49">-</span><span style="color:#005CC5">300.0</span><span style="color:#24292E">));</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> currentTime </span><span style="color:#D73A49">=</span><span style="color:#24292E"> time</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">utcToString</span><span style="color:#24292E">(</span><span style="color:#E36209">time</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">utcNow</span><span style="color:#24292E">());</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">    shopify</span><span style="color:#D73A49">:</span><span style="color:#24292E">CustomerList customerList </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> shopify</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">getCustomers</span><span style="color:#24292E">(</span><span style="color:#E36209">createdAtMin</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> dateOriginTime, </span><span style="color:#E36209">createdAtMax</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> currentTime);</span></span>
<span class="line"><span style="color:#24292E">    shopify</span><span style="color:#D73A49">:</span><span style="color:#24292E">Customer[] customers </span><span style="color:#D73A49">=</span><span style="color:#24292E"> customerList?.customers </span><span style="color:#D73A49">?:</span><span style="color:#24292E"> [];</span></span>
<span class="line"><span style="color:#24292E">    mail</span><span style="color:#D73A49">:</span><span style="color:#24292E">Recipient[] recepients </span><span style="color:#D73A49">=</span><span style="color:#24292E"> [];</span></span>
<span class="line"><span style="color:#D73A49">    foreach </span><span style="color:#24292E">shopify</span><span style="color:#D73A49">:</span><span style="color:#24292E">Customer customer </span><span style="color:#D73A49">in</span><span style="color:#24292E"> customers {</span></span>
<span class="line"><span style="color:#24292E">        recepients.</span><span style="color:#6F42C1">push</span><span style="color:#24292E">({</span></span>
<span class="line"><span style="color:#24292E">            emailAddress</span><span style="color:#D73A49">:</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">                address</span><span style="color:#D73A49">:</span><span style="color:#24292E"> customer?.email </span><span style="color:#D73A49">?:</span><span style="color:#032F62"> ""</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">                name</span><span style="color:#D73A49">:</span><span style="color:#24292E"> customer?.first_name </span><span style="color:#D73A49">?:</span><span style="color:#032F62"> ""</span></span>
<span class="line"><span style="color:#24292E">            }</span></span>
<span class="line"><span style="color:#24292E">        });</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">    onedrive</span><span style="color:#D73A49">:</span><span style="color:#24292E">File fileContents </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> onedrive</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">downloadFileByPath</span><span style="color:#24292E">(</span><span style="color:#E36209">flyerFilePath</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#005CC5">    byte</span><span style="color:#24292E">[] byteContent </span><span style="color:#D73A49">=</span><span style="color:#24292E"> fileContents.content </span><span style="color:#D73A49">?:</span><span style="color:#24292E"> [];</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">    if</span><span style="color:#24292E"> customers.</span><span style="color:#6F42C1">length</span><span style="color:#24292E">() </span><span style="color:#D73A49">></span><span style="color:#005CC5"> 0</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        mail</span><span style="color:#D73A49">:</span><span style="color:#24292E">FileAttachment attachment </span><span style="color:#D73A49">=</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">            contentBytes</span><span style="color:#D73A49">:</span><span style="color:#24292E"> byteContent.</span><span style="color:#6F42C1">toBase64</span><span style="color:#24292E">(),</span></span>
<span class="line"><span style="color:#24292E">            contentType</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "image/png"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">            name</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "flyer.png"</span></span>
<span class="line"><span style="color:#24292E">        };</span></span>
<span class="line"><span style="color:#24292E">        mail</span><span style="color:#D73A49">:</span><span style="color:#24292E">MessageContent messageContent </span><span style="color:#D73A49">=</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">            message</span><span style="color:#D73A49">:</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">                subject</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "Welcome to Our Store"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">                importance</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "normal"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">                body</span><span style="color:#D73A49">:</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#032F62">                    "contentType"</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "HTML"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#032F62">                    "content"</span><span style="color:#D73A49">:</span><span style="color:#24292E"> string </span><span style="color:#032F62">`&#x3C;p> Hi There, &#x3C;br/></span></span>
<span class="line"><span style="color:#032F62">                        &#x3C;h2> Welcome to Our Store &#x3C;/h2> &#x3C;br/></span></span>
<span class="line"><span style="color:#032F62">                        &#x3C;strong> What happens next? &#x3C;strong> &#x3C;br/></span></span>
<span class="line"><span style="color:#032F62">                        Keep an eye on your inbox as we’ll be sending you the best tips for [product/service]. &#x3C;br/></span></span>
<span class="line"><span style="color:#032F62">                        Want to get more out of Our Store? &#x3C;br/> visit our store at Shopify &#x3C;/p>`</span><span style="color:#24292E"> </span></span>
<span class="line"><span style="color:#24292E">                },</span></span>
<span class="line"><span style="color:#24292E">                toRecipients</span><span style="color:#D73A49">:</span><span style="color:#24292E"> recepients,</span></span>
<span class="line"><span style="color:#24292E">                attachments</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [attachment]</span></span>
<span class="line"><span style="color:#24292E">            },</span></span>
<span class="line"><span style="color:#24292E">            saveToSentItems</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> true</span></span>
<span class="line"><span style="color:#24292E">        };</span></span>
<span class="line"><span style="color:#24292E">        http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Response response </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> outlook</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">sendMessage</span><span style="color:#24292E">(</span><span style="color:#E36209">messageContent</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">        if</span><span style="color:#24292E"> response.statusCode </span><span style="color:#D73A49">==</span><span style="color:#24292E"> http</span><span style="color:#D73A49">:</span><span style="color:#24292E">STATUS_ACCEPTED {</span></span>
<span class="line"><span style="color:#24292E">            log</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">printInfo</span><span style="color:#24292E">(</span><span style="color:#005CC5">string</span><span style="color:#032F62"> `Welcome emails sent successfully!`</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">        } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">            return</span><span style="color:#D73A49"> error</span><span style="color:#24292E">(</span><span style="color:#032F62">"Failed to send the email from Outlook"</span><span style="color:#24292E">, </span><span style="color:#E36209">statusCode</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> response.statusCode);</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></div></div><div role="tabpanel" id="react-aria9923911857-5-tabpane-diagram" aria-labelledby="react-aria9923911857-5-tab-diagram" class="fade tab-pane"><div class="text-center mdContent col-lg-6 col-12"><img src="/images/pre-built/sequence-diagrams/shopify-to-outlook-integration.png" alt="Sequence Diagram"/></div></div></div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"samples":{"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ballerina/http;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ballerina/log;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ballerina/time;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ballerinax/microsoft.onedrive;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ballerinax/microsoft.outlook.mail;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eimport\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ballerinax/shopify.admin \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003eas\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e shopify;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e shopifyServiceUrl \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e ?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e xShopifyAccessToken \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e ?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e outlookAccessToken \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e ?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e oneDriveAccessToken \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e ?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e flyerFilePath \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e ?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003epublic\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e main\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e() \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    shopify\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eClient shopify \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ({xShopifyAccessToken\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e xShopifyAccessToken}, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eshopifyServiceUrl\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    mail\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eClient outlook \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ({ auth\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e { token: outlookAccessToken }});\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    onedrive\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eClient onedrive \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ({auth\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e { token: oneDriveAccessToken}});\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e dateOriginTime \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e time\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eutcToString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003etime\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eutcAddSeconds\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003etime\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eutcNow\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(), \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e300.0\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e));\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e currentTime \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e time\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eutcToString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003etime\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eutcNow\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e());\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    shopify\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eCustomerList customerList \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e shopify\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003egetCustomers\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003ecreatedAtMin\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e dateOriginTime, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003ecreatedAtMax\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e currentTime);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    shopify\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eCustomer[] customers \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customerList?.customers \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e?:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    mail\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eRecipient[] recepients \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    foreach \u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eshopify\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eCustomer customer \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customers {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        recepients.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003epush\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e({\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            emailAddress\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                address\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customer?.email \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e?:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                name\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customer?.first_name \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e?:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        });\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    onedrive\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eFile fileContents \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e onedrive\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003edownloadFileByPath\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eflyerFilePath\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    byte\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e[] byteContent \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e fileContents.content \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e?:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customers.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003elength\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e() \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 0\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        mail\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eFileAttachment attachment \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            contentBytes\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e byteContent.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003etoBase64\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(),\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            contentType\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"image/png\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            name\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"flyer.png\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        mail\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eMessageContent messageContent \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            message\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                subject\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"Welcome to Our Store\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                importance\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"normal\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                body\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#032F62\"\u003e                    \"contentType\"\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"HTML\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#032F62\"\u003e                    \"content\"\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e string \u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e`\u0026#x3C;p\u003e Hi There, \u0026#x3C;br/\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#032F62\"\u003e                        \u0026#x3C;h2\u003e Welcome to Our Store \u0026#x3C;/h2\u003e \u0026#x3C;br/\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#032F62\"\u003e                        \u0026#x3C;strong\u003e What happens next? \u0026#x3C;strong\u003e \u0026#x3C;br/\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#032F62\"\u003e                        Keep an eye on your inbox as we’ll be sending you the best tips for [product/service]. \u0026#x3C;br/\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#032F62\"\u003e                        Want to get more out of Our Store? \u0026#x3C;br/\u003e visit our store at Shopify \u0026#x3C;/p\u003e`\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                },\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                toRecipients\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e recepients,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                attachments\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [attachment]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            },\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            saveToSentItems\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e true\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        http\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eResponse response \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e outlook\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003esendMessage\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003emessageContent\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e response.statusCode \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e http\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eSTATUS_ACCEPTED {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            log\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eprintInfo\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e `Welcome emails sent successfully!`\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        } \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e            return\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"Failed to send the email from Outlook\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003estatusCode\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e response.statusCode);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e"},"content":"\nimport ballerina/http;\nimport ballerina/log;\nimport ballerina/time;\nimport ballerinax/microsoft.onedrive;\nimport ballerinax/microsoft.outlook.mail;\nimport ballerinax/shopify.admin as shopify;\n\nconfigurable string shopifyServiceUrl = ?;\nconfigurable string xShopifyAccessToken = ?;\n\nconfigurable string outlookAccessToken = ?;\n\nconfigurable string oneDriveAccessToken = ?;\nconfigurable string flyerFilePath = ?;\n\npublic function main() returns error? {\n    shopify:Client shopify = check new ({xShopifyAccessToken: xShopifyAccessToken}, shopifyServiceUrl);\n    mail:Client outlook = check new ({ auth: { token: outlookAccessToken }});\n    onedrive:Client onedrive = check new ({auth: { token: oneDriveAccessToken}});\n\n    string dateOriginTime = time:utcToString(time:utcAddSeconds(time:utcNow(), -300.0));\n    string currentTime = time:utcToString(time:utcNow());\n\n    shopify:CustomerList customerList = check shopify-\u003egetCustomers(createdAtMin = dateOriginTime, createdAtMax = currentTime);\n    shopify:Customer[] customers = customerList?.customers ?: [];\n    mail:Recipient[] recepients = [];\n    foreach shopify:Customer customer in customers {\n        recepients.push({\n            emailAddress: {\n                address: customer?.email ?: \"\",\n                name: customer?.first_name ?: \"\"\n            }\n        });\n    }\n\n    onedrive:File fileContents = check onedrive-\u003edownloadFileByPath(flyerFilePath);\n    byte[] byteContent = fileContents.content ?: [];\n\n    if customers.length() \u003e 0 {\n        mail:FileAttachment attachment = {\n            contentBytes: byteContent.toBase64(),\n            contentType: \"image/png\",\n            name: \"flyer.png\"\n        };\n        mail:MessageContent messageContent = {\n            message: {\n                subject: \"Welcome to Our Store\",\n                importance: \"normal\",\n                body: {\n                    \"contentType\": \"HTML\",\n                    \"content\": string `\u003cp\u003e Hi There, \u003cbr/\u003e\n                        \u003ch2\u003e Welcome to Our Store \u003c/h2\u003e \u003cbr/\u003e\n                        \u003cstrong\u003e What happens next? \u003cstrong\u003e \u003cbr/\u003e\n                        Keep an eye on your inbox as we’ll be sending you the best tips for [product/service]. \u003cbr/\u003e\n                        Want to get more out of Our Store? \u003cbr/\u003e visit our store at Shopify \u003c/p\u003e` \n                },\n                toRecipients: recepients,\n                attachments: [attachment]\n            },\n            saveToSentItems: true\n        };\n        http:Response response = check outlook-\u003esendMessage(messageContent);\n        if response.statusCode == http:STATUS_ACCEPTED {\n            log:printInfo(string `Welcome emails sent successfully!`);\n        } else {\n            return error(\"Failed to send the email from Outlook\", statusCode = response.statusCode);\n        }\n    }\n}\n  \n"},"__N_SSG":true},"page":"/learn/integration/pre-built-integrations/shopify-to-outlook-integration","query":{},"buildId":"Xv-Reh5BOmB4ouxMMl_Ai","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>