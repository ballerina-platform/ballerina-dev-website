<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="description" content="Specification: Ballerina Auth Library"/><meta name="keywords"/><title>Specification: Ballerina Auth Library - The Ballerina programming language</title><meta property="og:type" content="article"/><meta property="og:title" content="Specification: Ballerina Auth Library - The Ballerina programming language"/><meta property="og:description" content="Specification: Ballerina Auth Library"/><meta property="og:description" content="Specification: Ballerina Auth Library"/><meta name="twitter:title" content="Specification: Ballerina Auth Library - The Ballerina programming language"/><meta property="twitter:description" content="Specification: Ballerina Auth Library"/><meta property="twitter:text:description" content="Specification: Ballerina Auth Library"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:image" content="https://ballerina.io/images/ballerina-generic-social-media-image-2023.png"/><meta property="og:image" content="https://ballerina.io/images/ballerina-generic-social-media-image-2023.png"/><meta name="twitter:site" content="@ballerinalang"/><meta name="twitter:creator" content="@ballerinalang"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:image" content="https://ballerina.io/images/ballerina-generic-social-media-image-2023.png"/><meta property="twitter:image" content="https://ballerina.io/images/ballerina-generic-social-media-image-2023.png"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.setAttributeNode(d.createAttribute('data-ot-ignore'));j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PSL2TX4');</script><script type="text/javascript" crossorigin="true" src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"></script><script src="https://cookie-cdn.cookiepro.com/scripttemplates/otSDKStub.js" type="text/javascript" charSet="UTF-8" data-domain-script="630ad396-5fd5-4745-92ae-2765dc8841ee" defer=""></script><meta name="next-head-count" content="22"/><meta charSet="utf-8"/><meta name="author" content="WSO2 LLC"/><meta http-equiv="X-Frame-Options" content="SAMEORIGIN"/><meta http-equiv="Content-Security-Policy" content="frame-ancestors &#x27;none&#x27;;"/><link rel="shortcut icon" href="/images/favicon.ico"/><link rel="stylesheet" href="/css/roboto.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="/css/ballerina-search-button.css"/><link rel="stylesheet" href="/css/ballerina-search-modal.css"/><link rel="stylesheet" href="/css/ballerina-search-variables.css"/><link rel="stylesheet" href="/css/ballerina-search-style.css"/><link rel="preload" href="/_next/static/css/9bb35c8110b0fa38.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9bb35c8110b0fa38.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-163a486a43645075.js" defer=""></script><script src="/_next/static/chunks/framework-79bce4a3a540b080.js" defer=""></script><script src="/_next/static/chunks/main-0ea70f422df5d19e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ba2391f08766dae9.js" defer=""></script><script src="/_next/static/chunks/7621-d6bcd83f463fef72.js" defer=""></script><script src="/_next/static/chunks/1058-de0b031bc614d462.js" defer=""></script><script src="/_next/static/chunks/6084-4e54ad5efcb8d3b5.js" defer=""></script><script src="/_next/static/chunks/5530-11a262420fdd225c.js" defer=""></script><script src="/_next/static/chunks/pages/spec/%5Bslug%5D-8f6d3ef3b598acd4.js" defer=""></script><script src="/_next/static/AraISIDs-pp-rOmbtdfJx/_buildManifest.js" defer=""></script><script src="/_next/static/AraISIDs-pp-rOmbtdfJx/_ssgManifest.js" defer=""></script><script src="/_next/static/AraISIDs-pp-rOmbtdfJx/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSL2TX4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next" data-reactroot=""><div class="main-wrapper spec vstack gap-0"><div class="wrap-page-content container"><div class="row"><div class="mdContent col-12"><div class="container"><div class="topRowSpec row"><div class="col-12"></div></div><div class="specContent row"><div class="stdLib"><h1>Specification: Ballerina Auth Library</h1>
<p><em>Owners</em>: @ldclakmal @shafreenAnfar<br/>
<em>Reviewers</em>: @shafreenAnfar<br/>
<em>Created</em>: 2021/10/01<br/>
<em>Updated</em>: 2022/02/17<br/>
<em>Edition</em>: Swan Lake</p>
<h2 id="introduction" level="2">Introduction</h2>
<p>This is the specification for the Auth standard library of <a href="https://ballerina.io/">Ballerina language</a>, which is used for authorization of listeners and clients (HTTP, gRPC, GraphQL, WebSocket, WebSub, etc.).</p>
<p>The Auth library specification has evolved and may continue to evolve in the future. The released versions of the specification can be found under the relevant GitHub tag.</p>
<p>If you have any feedback or suggestions about the library, start a discussion via a <a href="https://github.com/ballerina-platform/ballerina-standard-library/issues">GitHub issue</a> or in the <a href="https://discord.gg/ballerinalang">Discord server</a>. Based on the outcome of the discussion, the specification and implementation can be updated. Community feedback is always welcome. Any accepted proposal, which affects the specification is stored under <code>/docs/proposals</code>. Proposals under discussion can be found with the label <code>type/proposal</code> in GitHub.</p>
<p>The conforming implementation of the specification is released and included in the distribution. Any deviation from the specification is considered a bug.</p>
<h2 id="contents" level="2">Contents</h2>
<ol>
<li><a href="#1-overview">Overview</a></li>
<li><a href="#2-basic-auth">Basic Auth</a></li>
<li><a href="#3-listener-auth">Listener Auth</a>
<ul>
<li>3.1. <a href="#31-basic-auth-provider">Basic Auth Provider</a>
<ul>
<li>3.1.1. <a href="#311-file-user-store">File User Store</a></li>
<li>3.1.2. <a href="#312-ldap-user-store">LDAP User Store</a></li>
</ul>
</li>
<li>3.2. <a href="#32-basic-auth-handler">Basic Auth Handler</a>
<ul>
<li>3.2.1. <a href="#321-file-user-store">File User Store</a></li>
<li>3.2.2. <a href="#322-ldap-user-store">LDAP User Store</a></li>
</ul>
</li>
<li>3.3. <a href="#33-declarative-approach">Declarative Approach</a></li>
<li>3.4. <a href="#34-imperative-approach">Imperative Approach</a></li>
</ul>
</li>
<li><a href="#4-client-auth">Client Auth</a>
<ul>
<li>4.1. <a href="#41-basic-auth-provider">Basic Auth Provider</a></li>
<li>4.2. <a href="#42-basic-auth-handler">Basic Auth Handler</a></li>
<li>4.3. <a href="#43-declarative-approach">Declarative Approach</a></li>
<li>4.4. <a href="#44-imperative-approach">Imperative Approach</a></li>
</ul>
</li>
<li><a href="#5-samples">Samples</a>
<ul>
<li>5.1. <a href="#51-listener-auth">Listener Auth</a>
<ul>
<li>5.1.1. <a href="#511-declarative-approach-http-listener">Declarative Approach (HTTP Listener)</a>
<ul>
<li>5.1.1.1. <a href="#5111-file-user-store">File User Store</a></li>
<li>5.1.1.2. <a href="#5112-ldap-user-store">LDAP User Store</a></li>
</ul>
</li>
<li>5.1.2. <a href="#512-imperative-approach-http-listener">Imperative Approach (HTTP Listener)</a>
<ul>
<li>5.1.2.1. <a href="#5121-file-user-store">File User Store</a></li>
<li>5.1.2.2. <a href="#5122-ldap-user-store">LDAP User Store</a></li>
</ul>
</li>
</ul>
</li>
<li>5.2. <a href="#52-client-auth">Client Auth</a>
<ul>
<li>5.2.1. <a href="#521-declarative-approach-http-client">Declarative Approach (HTTP Client)</a></li>
<li>5.2.2. <a href="#522-imperative-approach-http-client">Imperative Approach (HTTP Client)</a></li>
</ul>
</li>
</ul>
</li>
</ol>
<h2 id="1-overview" level="2">1. Overview</h2>
<p>This specification elaborates on Basic Auth authentication and authorization for all the Ballerina listeners and
clients. The HTTP, gRPC, GraphQL, WebSocket, WebSub protocol-based listeners and clients are secured according to this
specification.</p>
<p>This has a number of design principles:</p>
<ul>
<li><strong>Listener auth</strong>: This refers to the authentication and authorization of the listener as defined in
<a href="https://ballerina.io/spec/lang/2021R1/#section_5.7.4">Ballerina 2021R1 Section 5.7.4</a>. The inbound requests/messages
independent of the transport protocol are authenticated and authorized according to the configured authentication
protocol and related configurations.</li>
<li><strong>Client auth</strong>: This refers to the authentication of the client as defined in
<a href="https://ballerina.io/spec/lang/2021R1/#section_7.9">Ballerina 2021R1 Section 7.9</a>. The outbound requests/messages
independent of the transport protocol are enriched according to the configured authentication protocol and related
configurations.</li>
<li><strong>Auth provider</strong>: This is the entity that is responsible for providing all the auth protocol-related implementations.</li>
<li><strong>Auth handler</strong>: This is the entity that is responsible for handling the security of the API based on the transport
protocol and with the use of provider APIs. This API gets the credentials and required configurations as user inputs
and returns the authentication protocol-related information. Internally, these APIs call the provider APIs of the
relevant authentication protocol.</li>
<li><strong>Declarative approach</strong>: This is also known as the configuration-driven approach, which is used for simple use cases,
where users have to provide a set of configurations and do not need to be worried more about how authentication and
authorization works.</li>
<li><strong>Imperative approach</strong>: This is also known as the code-driven approach, which is used for advanced use cases, where
users need to be worried more about how authentication and authorization work and need to have further customizations.</li>
</ul>
<h2 id="2-basic-auth" level="2">2. Basic Auth</h2>
<p>Basic Auth protocol defines the credential as username and password are concatenated with a <code>:</code> and encoded using
Base64 as defined in <a href="https://datatracker.ietf.org/doc/html/rfc4648#section-4">RFC4648 Section 4</a> into a sequence of
US-ASCII characters as defined in <a href="https://datatracker.ietf.org/doc/html/rfc0020">RFC0020</a>.</p>
<h2 id="3-listener-auth" level="2">3. Listener Auth</h2>
<p>This refers to the authentication and authorization of the listener as defined in
<a href="https://ballerina.io/spec/lang/2021R1/#section_5.7.4">Ballerina 2021R1 Section 5.7.4</a>. The inbound requests/messages
independent of the transport protocol are authenticated and authorized according to the configured authentication
protocol and related configurations.</p>
<h3 id="31-basic-auth-provider" level="3">3.1. Basic Auth Provider</h3>
<h4 id="311-file-user-store" level="4">3.1.1. File User Store</h4>
<p>The user information is stored in a file in the <a href="https://toml.io/en/">TOML language</a>. The structure of the file would
be as follows:</p>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#6A737D"># 1* of the following block</span></span>
<span class="line"><span style="color:#24292E">[[</span><span style="color:#6F42C1">ballerina</span><span style="color:#24292E">.</span><span style="color:#6F42C1">auth</span><span style="color:#24292E">.</span><span style="color:#6F42C1">users</span><span style="color:#24292E">]]</span></span>
<span class="line"><span style="color:#24292E">username=&#x3C;</span><span style="color:#B31D28;font-style:italic">String></span></span>
<span class="line"><span style="color:#24292E">password=&#x3C;</span><span style="color:#B31D28;font-style:italic">String></span></span>
<span class="line"><span style="color:#24292E">scopes=&#x3C;</span><span style="color:#B31D28;font-style:italic">String Array></span></span></code></pre></div></pre>
<p>The File User Store Basic Auth Provider has an API to authenticate the Basic Auth credential using the File User Store
defined in <a href="https://toml.io/en/">TOML language</a> and return the <code>UserDetails</code> which consists of the username and scopes
as an array if available.</p>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> type</span><span style="color:#6F42C1"> FileUserStoreConfig</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> type</span><span style="color:#6F42C1"> UserDetails</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> username;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E">[]? scopes;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public class</span><span style="color:#6F42C1"> ListenerFileUserStoreBasicAuthProvider</span><span style="color:#24292E"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> init</span><span style="color:#24292E">(</span><span style="color:#E36209">FileUserStoreConfig</span><span style="color:#E36209"> config</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#6A737D">        // init basic auth provider for file user store</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> authenticate</span><span style="color:#24292E">(</span><span style="color:#005CC5">string</span><span style="color:#E36209"> credential</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#24292E"> UserDetails</span><span style="color:#D73A49">|error</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6A737D">        // read the user store file, validate the credential and return user details</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre>
<h4 id="312-ldap-user-store" level="4">3.1.2. LDAP User Store</h4>
<p>The user information is stored in a user store that connects with the LDAP protocol as defined in
<a href="https://datatracker.ietf.org/doc/html/rfc4511">RFC4511</a>.</p>
<p>The LDAP User Store Basic Auth Provider has an API to authenticate the Basic Auth credential using the LDAP User Store.
The <code>LdapUserStoreConfig</code> record is used to provide the configuration related to the LDAP protocol. This returns the
<code>UserDetails</code> which consists of the username and scopes as an array if available.</p>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> type</span><span style="color:#6F42C1"> LdapUserStoreConfig</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> domainName;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> connectionUrl;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> connectionName;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> connectionPassword;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> userSearchBase;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> userEntryObjectClass;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> userNameAttribute;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> userNameSearchFilter;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> userNameListFilter;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E">[] groupSearchBase;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> groupEntryObjectClass;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> groupNameAttribute;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> groupNameSearchFilter;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> groupNameListFilter;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> membershipAttribute;</span></span>
<span class="line"><span style="color:#005CC5">    boolean</span><span style="color:#24292E"> userRolesCacheEnabled </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> false</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#005CC5">    boolean</span><span style="color:#24292E"> connectionPoolingEnabled </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> true</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#005CC5">    decimal</span><span style="color:#24292E"> connectionTimeout </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 5</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#005CC5">    decimal</span><span style="color:#24292E"> readTimeout </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> 60</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">    SecureSocket secureSocket</span><span style="color:#D73A49">?</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> type</span><span style="color:#6F42C1"> UserDetails</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> username;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E">[]? scopes;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public class</span><span style="color:#6F42C1"> ListenerLdapUserStoreBasicAuthProvider</span><span style="color:#24292E"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> init</span><span style="color:#24292E">(</span><span style="color:#E36209">LdapUserStoreConfig</span><span style="color:#E36209"> config</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#6A737D">        // init basic auth provider for LDAP</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> authenticate</span><span style="color:#24292E">(</span><span style="color:#005CC5">string</span><span style="color:#E36209"> credential</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#24292E"> UserDetails</span><span style="color:#D73A49">|</span><span style="color:#24292E">Error {</span></span>
<span class="line"><span style="color:#6A737D">        // connect to LDAP, validate the credential and return user details</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre>
<h3 id="32-basic-auth-handler" level="3">3.2. Basic Auth Handler</h3>
<blockquote>
<p><strong>NOTE</strong>: Since the auth handlers are tightly bound with the transport protocol, for the explanation of the concept,
all the samples are created for HTTP transport protocol hereinafter.</p>
</blockquote>
<h4 id="321-file-user-store" level="4">3.2.1. File User Store</h4>
<p>The user information is stored in a file in the <a href="https://toml.io/en/">TOML language</a>. The structure of the file would
be as follows:</p>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#6A737D"># 1* of the following block</span></span>
<span class="line"><span style="color:#24292E">[[</span><span style="color:#6F42C1">ballerina</span><span style="color:#24292E">.</span><span style="color:#6F42C1">auth</span><span style="color:#24292E">.</span><span style="color:#6F42C1">users</span><span style="color:#24292E">]]</span></span>
<span class="line"><span style="color:#24292E">username=&#x3C;</span><span style="color:#B31D28;font-style:italic">String></span></span>
<span class="line"><span style="color:#24292E">password=&#x3C;</span><span style="color:#B31D28;font-style:italic">String></span></span>
<span class="line"><span style="color:#24292E">scopes=&#x3C;</span><span style="color:#B31D28;font-style:italic">String Array></span></span></code></pre></div></pre>
<p>The File User Store Basic Auth Handler has an API to authenticate the HTTP request, headers of the HTTP request, or the
credential as defined in <a href="https://datatracker.ietf.org/doc/html/rfc7617#section-2">RFC7617 Section 2</a> using the File
User Store defined in <a href="https://toml.io/en/">TOML language</a>. This returns the <code>UserDetails</code> which consists of the
username and scopes as an array if available or <code>Unauthorized</code> in case of authentication failure.</p>
<p>The File User Store Basic Auth Handler has an API to authorize the user against the expected scope or scopes. This
returns <code>Forbidden</code> in case of authorization failure.</p>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/auth;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> type</span><span style="color:#6F42C1"> FileUserStoreConfig</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#D73A49">    *</span><span style="color:#24292E">auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">FileUserStoreConfig;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public class</span><span style="color:#6F42C1"> ListenerFileUserStoreBasicAuthHandler</span><span style="color:#24292E"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">    private</span><span style="color:#D73A49"> final</span><span style="color:#24292E"> auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">ListenerFileUserStoreBasicAuthProvider provider;</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> init</span><span style="color:#24292E">(</span><span style="color:#E36209">FileUserStoreConfig</span><span style="color:#E36209"> config</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#005CC5">        self</span><span style="color:#24292E">.provider </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#E36209">config</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> authenticate</span><span style="color:#24292E">(</span><span style="color:#E36209">Request</span><span style="color:#D73A49">|</span><span style="color:#E36209">Headers</span><span style="color:#D73A49">|</span><span style="color:#005CC5">string</span><span style="color:#E36209"> data</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#24292E"> auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails</span><span style="color:#D73A49">|</span><span style="color:#24292E">Unauthorized {</span></span>
<span class="line"><span style="color:#6A737D">        // extract the credential from data</span></span>
<span class="line"><span style="color:#24292E">        auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails</span><span style="color:#D73A49">|</span><span style="color:#24292E">auth:Error details </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> self</span><span style="color:#24292E">.provider.</span><span style="color:#6F42C1">authenticate</span><span style="color:#24292E">(</span><span style="color:#E36209">credential</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">        if</span><span style="color:#24292E"> details </span><span style="color:#D73A49">is</span><span style="color:#24292E"> auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">Error {</span></span>
<span class="line"><span style="color:#6A737D">            // return `Unauthorized`</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#D73A49"> &#x3C;</span><span style="color:#24292E">auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails</span><span style="color:#D73A49">></span><span style="color:#24292E">details;</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> authorize</span><span style="color:#24292E">(</span><span style="color:#E36209">auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails userDetails, </span><span style="color:#005CC5">string</span><span style="color:#D73A49">|</span><span style="color:#005CC5">string</span><span style="color:#24292E">[] </span><span style="color:#E36209">expectedScopes</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#24292E"> Forbidden</span><span style="color:#D73A49">?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6A737D">        // match the scopes with the provided `expectedScopes`</span></span>
<span class="line"><span style="color:#6A737D">        // if not matched return `Forbidden`</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre>
<h4 id="322-ldap-user-store" level="4">3.2.2. LDAP User Store</h4>
<p>The LDAP User Store Basic Auth Handler has an API to authenticate the HTTP request, headers of the HTTP request, or the
credential as defined in <a href="https://datatracker.ietf.org/doc/html/rfc7617#section-2">RFC7617 Section 2</a> using the LDAP
User Store. The <code>LdapUserStoreConfig</code> record is used to provide the configuration related to the LDAP protocol. This
returns the <code>UserDetails</code> which consists of the username and scopes as an array if available or <code>Unauthorized</code> in case
of authentication failure.</p>
<p>The LDAP User Store Basic Auth Handler has an API to authorize the user against the expected scope or scopes. This
returns <code>Forbidden</code> in case of authorization failure.</p>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/auth;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> type</span><span style="color:#6F42C1"> LdapUserStoreConfig</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#D73A49">    *</span><span style="color:#24292E">auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">LdapUserStoreConfig;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> client class</span><span style="color:#6F42C1"> ListenerLdapUserStoreBasicAuthHandler</span><span style="color:#24292E"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">    private</span><span style="color:#D73A49"> final</span><span style="color:#24292E"> auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">ListenerLdapUserStoreBasicAuthProvider provider;</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> init</span><span style="color:#24292E">(</span><span style="color:#E36209">LdapUserStoreConfig</span><span style="color:#E36209"> config</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#005CC5">        self</span><span style="color:#24292E">.provider </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#E36209">config</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    remote</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> authenticate</span><span style="color:#24292E">(</span><span style="color:#E36209">Request</span><span style="color:#D73A49">|</span><span style="color:#E36209">Headers</span><span style="color:#D73A49">|</span><span style="color:#005CC5">string</span><span style="color:#E36209"> data</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#24292E"> auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails</span><span style="color:#D73A49">|</span><span style="color:#24292E">Unauthorized {</span></span>
<span class="line"><span style="color:#6A737D">        // extract the credential from data</span></span>
<span class="line"><span style="color:#24292E">        auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails</span><span style="color:#D73A49">|</span><span style="color:#24292E">auth:Error details </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> self</span><span style="color:#24292E">.provider.</span><span style="color:#6F42C1">authenticate</span><span style="color:#24292E">(</span><span style="color:#E36209">credential</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">        if</span><span style="color:#24292E"> details </span><span style="color:#D73A49">is</span><span style="color:#24292E"> auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">Error {</span></span>
<span class="line"><span style="color:#6A737D">            // return `Unauthorized`</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#D73A49"> &#x3C;</span><span style="color:#24292E">auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails</span><span style="color:#D73A49">></span><span style="color:#24292E">details;</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    remote</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> authorize</span><span style="color:#24292E">(</span><span style="color:#E36209">auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails details, </span><span style="color:#005CC5">string</span><span style="color:#D73A49">|</span><span style="color:#005CC5">string</span><span style="color:#24292E">[] </span><span style="color:#E36209">expectedScopes</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#24292E"> Forbidden</span><span style="color:#D73A49">?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#6A737D">        // match the scopes with the provided `expectedScopes`</span></span>
<span class="line"><span style="color:#6A737D">        // if not matched return `Forbidden`</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre>
<h3 id="33-declarative-approach" level="3">3.3. Declarative Approach</h3>
<p>This is also known as the configuration-driven approach, which is used for simple use cases, where users have to
provide a set of configurations and do not need to be worried more about how authentication and authorization works.
The user does not have full control over the configuration-driven approach.</p>
<p>The service and/or resource configurations are used to define the authentication and authorization configurations.
Users can configure the configurations needed for different authentication schemes and configurations needed for
authorizations of each authentication scheme. Also, the configurations can be provided at both the service and resource
levels. The priority will be given from bottom to top. Then, the auth handler creation and request
authentication/authorization is handled internally without user intervention. The requests that succeeded both
authentication and/or authorization phases according to the configurations will be passed to the business logic layer.</p>
<h3 id="34-imperative-approach" level="3">3.4. Imperative Approach</h3>
<p>This is also known as the code-driven approach, which is used for advanced use cases, where users need to be worried
more about how authentication and authorization work and need to have further customizations. The user has full control
of the code-driven approach. The handler creation and authentication/authorization calls are made by the user at the
business logic layer.</p>
<h2 id="4-client-auth" level="2">4. Client Auth</h2>
<p>This refers to the authentication of the client as defined in
<a href="https://ballerina.io/spec/lang/2021R1/#section_7.9">Ballerina 2021R1 Section 7.9</a>. The outbound requests/messages
independent of the transport protocol are enriched according to the configured authentication protocol and related
configurations.</p>
<h3 id="41-basic-auth-provider" level="3">4.1. Basic Auth Provider</h3>
<p>The Basic Auth Provider has an API to generate the Basic Auth credential. The <code>CredentialsConfig</code> record is used to
provide the configuration related to the token generation. This returns the generated token.</p>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> type</span><span style="color:#6F42C1"> CredentialsConfig</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> username;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> password;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public class</span><span style="color:#6F42C1"> ClientBasicAuthProvider</span><span style="color:#24292E"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> init</span><span style="color:#24292E">(</span><span style="color:#E36209">CredentialsConfig</span><span style="color:#E36209"> config</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#6A737D">        // init basic auth provider</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> generateToken</span><span style="color:#24292E">() </span><span style="color:#D73A49">returns</span><span style="color:#005CC5"> string</span><span style="color:#D73A49">|</span><span style="color:#24292E">Error {</span></span>
<span class="line"><span style="color:#6A737D">        // generate the base64 encoded `username:password` value</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre>
<h3 id="42-basic-auth-handler" level="3">4.2. Basic Auth Handler</h3>
<blockquote>
<p><strong>NOTE</strong>: Since the auth handlers are tightly bound with the transport protocol, for the explanation of the concept,
all the samples are created for HTTP transport protocol hereinafter.</p>
</blockquote>
<p>The Basic Auth Handler has an API to enrich the HTTP request as defined in
<a href="https://datatracker.ietf.org/doc/html/rfc7617#section-2">RFC7617 Section 2</a> using the File User Store defined in TOML
language. This returns the enriched <code>Request</code> with headers or <code>Error</code> in case of failure.</p>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/auth;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> type</span><span style="color:#6F42C1"> CredentialsConfig</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#D73A49">    *</span><span style="color:#24292E">auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">CredentialsConfig;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public class</span><span style="color:#6F42C1"> ClientBasicAuthHandler</span><span style="color:#24292E"> {</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">    private</span><span style="color:#D73A49"> final</span><span style="color:#24292E"> auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">ClientBasicAuthProvider provider;</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> init</span><span style="color:#24292E">(</span><span style="color:#E36209">CredentialsConfig</span><span style="color:#E36209"> config</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#005CC5">        self</span><span style="color:#24292E">.provider </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#E36209">config</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">    </span></span>
<span class="line"><span style="color:#D73A49">    public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> enrich</span><span style="color:#24292E">(</span><span style="color:#E36209">Request</span><span style="color:#E36209"> req</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#24292E"> Request</span><span style="color:#D73A49">|</span><span style="color:#24292E">Error {</span></span>
<span class="line"><span style="color:#005CC5">        string</span><span style="color:#D73A49">|auth:</span><span style="color:#24292E">Error token </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> self</span><span style="color:#24292E">.provider.</span><span style="color:#6F42C1">generateToken</span><span style="color:#24292E">();</span></span>
<span class="line"><span style="color:#6A737D">        // set the token as the `Authorization: Bearer &#x3C;token>` header</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre>
<h3 id="43-declarative-approach" level="3">4.3. Declarative Approach</h3>
<p>This is also known as a configuration-driven approach, which is used for simple use cases, where users have to provide
a set of configurations and do not need to be worried more about how authentication works. The user does not have full
control over the configuration-driven approach.</p>
<p>The client configurations are used to define the authentication configurations. Users can configure the configurations
needed for different authentication schemes. Then, the auth handler creation and request enrichment is handled
internally without user intervention.</p>
<h3 id="44-imperative-approach" level="3">4.4. Imperative Approach</h3>
<p>This is also known as the code-driven approach, which is used for advanced use cases, where users need to be worried
more about how authentication works and need to have further customizations. The user has full control of the
code-driven approach. The handler creation and request enrichment calls are made by the user at the business logic layer.</p>
<h2 id="5-samples" level="2">5. Samples</h2>
<h3 id="51-listener-auth" level="3">5.1. Listener Auth</h3>
<h4 id="511-declarative-approach-http-listener" level="4">5.1.1. Declarative Approach (HTTP Listener)</h4>
<h5 id="5111-file-user-store" level="5">5.1.1.1. File User Store</h5>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/http;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">@</span><span style="color:#005CC5">http</span><span style="color:#24292E">:</span><span style="color:#005CC5">ServiceConfig</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    auth</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span></span>
<span class="line"><span style="color:#24292E">        {</span></span>
<span class="line"><span style="color:#6F42C1">            fileUserStoreConfig</span><span style="color:#24292E">: {},</span></span>
<span class="line"><span style="color:#6F42C1">            scopes</span><span style="color:#24292E">: [</span><span style="color:#032F62">"admin"</span><span style="color:#24292E">]</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">    ]</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"><span style="color:#D73A49">service</span><span style="color:#6F42C1"> /foo</span><span style="color:#D73A49"> on</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> http:Listener(</span><span style="color:#005CC5">9090</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">    resource</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> get</span><span style="color:#6F42C1"> bar</span><span style="color:#24292E">() </span><span style="color:#D73A49">returns</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#032F62"> "Hello, World!"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre>
<h5 id="5112-ldap-user-store" level="5">5.1.1.2. LDAP User Store</h5>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/http;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">@</span><span style="color:#005CC5">http</span><span style="color:#24292E">:</span><span style="color:#005CC5">ServiceConfig</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    auth</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span></span>
<span class="line"><span style="color:#24292E">        {</span></span>
<span class="line"><span style="color:#6F42C1">            ldapUserStoreConfig</span><span style="color:#24292E">: {</span></span>
<span class="line"><span style="color:#6F42C1">                domainName</span><span style="color:#24292E">: </span><span style="color:#032F62">"avix.lk"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                connectionUrl</span><span style="color:#24292E">: </span><span style="color:#032F62">"ldap://localhost:389"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                connectionName</span><span style="color:#24292E">: </span><span style="color:#032F62">"cn=admin,dc=avix,dc=lk"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                connectionPassword</span><span style="color:#24292E">: </span><span style="color:#032F62">"avix123"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                userSearchBase</span><span style="color:#24292E">: </span><span style="color:#032F62">"ou=Users,dc=avix,dc=lk"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                userEntryObjectClass</span><span style="color:#24292E">: </span><span style="color:#032F62">"inetOrgPerson"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                userNameAttribute</span><span style="color:#24292E">: </span><span style="color:#032F62">"uid"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                userNameSearchFilter</span><span style="color:#24292E">: </span><span style="color:#032F62">"(&#x26;(objectClass=inetOrgPerson)(uid=?))"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                userNameListFilter</span><span style="color:#24292E">: </span><span style="color:#032F62">"(objectClass=inetOrgPerson)"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                groupSearchBase</span><span style="color:#24292E">: [</span><span style="color:#032F62">"ou=Groups,dc=avix,dc=lk"</span><span style="color:#24292E">],</span></span>
<span class="line"><span style="color:#6F42C1">                groupEntryObjectClass</span><span style="color:#24292E">: </span><span style="color:#032F62">"groupOfNames"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                groupNameAttribute</span><span style="color:#24292E">: </span><span style="color:#032F62">"cn"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                groupNameSearchFilter</span><span style="color:#24292E">: </span><span style="color:#032F62">"(&#x26;(objectClass=groupOfNames)(cn=?))"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                groupNameListFilter</span><span style="color:#24292E">: </span><span style="color:#032F62">"(objectClass=groupOfNames)"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                membershipAttribute</span><span style="color:#24292E">: </span><span style="color:#032F62">"member"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                userRolesCacheEnabled</span><span style="color:#24292E">: </span><span style="color:#005CC5">true</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                connectionPoolingEnabled</span><span style="color:#24292E">: </span><span style="color:#005CC5">false</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                connectionTimeout</span><span style="color:#24292E">: </span><span style="color:#005CC5">5</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                readTimeout</span><span style="color:#24292E">: </span><span style="color:#005CC5">60</span></span>
<span class="line"><span style="color:#24292E">            },</span></span>
<span class="line"><span style="color:#6F42C1">            scopes</span><span style="color:#24292E">: [</span><span style="color:#032F62">"admin"</span><span style="color:#24292E">]</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">    ]</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"><span style="color:#D73A49">service</span><span style="color:#6F42C1"> /foo</span><span style="color:#D73A49"> on</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> http:Listener(</span><span style="color:#005CC5">9090</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">    resource</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> get</span><span style="color:#6F42C1"> bar</span><span style="color:#24292E">() </span><span style="color:#D73A49">returns</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#032F62"> "Hello, World!"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre>
<h4 id="512-imperative-approach-http-listener" level="4">5.1.2. Imperative Approach (HTTP Listener)</h4>
<h5 id="5121-file-user-store" level="5">5.1.2.1. File User Store</h5>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/http;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/auth;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">http</span><span style="color:#D73A49">:</span><span style="color:#24292E">FileUserStoreConfig config </span><span style="color:#D73A49">=</span><span style="color:#24292E"> {};</span></span>
<span class="line"><span style="color:#24292E">http</span><span style="color:#D73A49">:</span><span style="color:#24292E">ListenerFileUserStoreBasicAuthHandler handler </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#E36209">config</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">service</span><span style="color:#6F42C1"> /foo</span><span style="color:#D73A49"> on</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> http:Listener(</span><span style="color:#005CC5">9090</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">    resource</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> post</span><span style="color:#6F42C1"> bar</span><span style="color:#24292E">(@</span><span style="color:#005CC5">http</span><span style="color:#24292E">:</span><span style="color:#005CC5">Header</span><span style="color:#005CC5"> string</span><span style="color:#E36209"> Authorization</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#005CC5"> string</span><span style="color:#D73A49">|</span><span style="color:#24292E">http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Unauthorized</span><span style="color:#D73A49">|</span><span style="color:#24292E">http:Forbidden {</span></span>
<span class="line"><span style="color:#24292E">        auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails</span><span style="color:#D73A49">|</span><span style="color:#24292E">http:Unauthorized authn </span><span style="color:#D73A49">=</span><span style="color:#24292E"> handler.</span><span style="color:#6F42C1">authenticate</span><span style="color:#24292E">(</span><span style="color:#E36209">Authorization</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">        if</span><span style="color:#24292E"> authn </span><span style="color:#D73A49">is</span><span style="color:#24292E"> http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Unauthorized {</span></span>
<span class="line"><span style="color:#D73A49">            return</span><span style="color:#24292E"> authn;</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">        http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Forbidden? authz </span><span style="color:#D73A49">=</span><span style="color:#24292E"> handler.</span><span style="color:#6F42C1">authorize</span><span style="color:#24292E">(</span><span style="color:#D73A49">&#x3C;</span><span style="color:#E36209">auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails</span><span style="color:#D73A49">></span><span style="color:#E36209">authn</span><span style="color:#24292E">, </span><span style="color:#032F62">"admin"</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">        if</span><span style="color:#24292E"> authz </span><span style="color:#D73A49">is</span><span style="color:#24292E"> http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Forbidden {</span></span>
<span class="line"><span style="color:#D73A49">            return</span><span style="color:#24292E"> authz;</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#6A737D">        // business logic</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre>
<h5 id="5122-ldap-user-store" level="5">5.1.2.2. LDAP User Store</h5>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/http;</span></span>
<span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/auth;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">http</span><span style="color:#D73A49">:</span><span style="color:#24292E">LdapUserStoreConfig config </span><span style="color:#D73A49">=</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    domainName</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "avix.lk"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    connectionUrl</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "ldap://localhost:389"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    connectionName</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "cn=admin,dc=avix,dc=lk"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    connectionPassword</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "avix123"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    userSearchBase</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "ou=Users,dc=avix,dc=lk"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    userEntryObjectClass</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "inetOrgPerson"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    userNameAttribute</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "uid"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    userNameSearchFilter</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "(&#x26;(objectClass=inetOrgPerson)(uid=?))"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    userNameListFilter</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "(objectClass=inetOrgPerson)"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    groupSearchBase</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span><span style="color:#032F62">"ou=Groups,dc=avix,dc=lk"</span><span style="color:#24292E">],</span></span>
<span class="line"><span style="color:#24292E">    groupEntryObjectClass</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "groupOfNames"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    groupNameAttribute</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "cn"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    groupNameSearchFilter</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "(&#x26;(objectClass=groupOfNames)(cn=?))"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    groupNameListFilter</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "(objectClass=groupOfNames)"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    membershipAttribute</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "member"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    userRolesCacheEnabled</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> true</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    connectionPoolingEnabled</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> false</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    connectionTimeout</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> 5</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    readTimeout</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> 60</span></span>
<span class="line"><span style="color:#24292E">};</span></span>
<span class="line"><span style="color:#24292E">http</span><span style="color:#D73A49">:</span><span style="color:#24292E">ListenerLdapUserStoreBasicAuthHandler handler </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#E36209">config</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">service</span><span style="color:#6F42C1"> /foo</span><span style="color:#D73A49"> on</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> http:Listener(</span><span style="color:#005CC5">9090</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">    resource</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> post</span><span style="color:#6F42C1"> bar</span><span style="color:#24292E">(@</span><span style="color:#005CC5">http</span><span style="color:#24292E">:</span><span style="color:#005CC5">Header</span><span style="color:#005CC5"> string</span><span style="color:#E36209"> Authorization</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#005CC5"> string</span><span style="color:#D73A49">|</span><span style="color:#24292E">http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Unauthorized</span><span style="color:#D73A49">|</span><span style="color:#24292E">http:Forbidden {</span></span>
<span class="line"><span style="color:#24292E">        auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails</span><span style="color:#D73A49">|</span><span style="color:#24292E">http:Unauthorized authn </span><span style="color:#D73A49">=</span><span style="color:#24292E"> handler</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">authenticate</span><span style="color:#24292E">(</span><span style="color:#E36209">Authorization</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">        if</span><span style="color:#24292E"> authn </span><span style="color:#D73A49">is</span><span style="color:#24292E"> http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Unauthorized {</span></span>
<span class="line"><span style="color:#D73A49">            return</span><span style="color:#24292E"> authn;</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">        http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Forbidden? authz </span><span style="color:#D73A49">=</span><span style="color:#24292E"> handler</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">authorize</span><span style="color:#24292E">(</span><span style="color:#D73A49">&#x3C;</span><span style="color:#E36209">auth</span><span style="color:#D73A49">:</span><span style="color:#24292E">UserDetails</span><span style="color:#D73A49">></span><span style="color:#E36209">authn</span><span style="color:#24292E">, </span><span style="color:#032F62">"admin"</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">        if</span><span style="color:#24292E"> authz </span><span style="color:#D73A49">is</span><span style="color:#24292E"> http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Forbidden {</span></span>
<span class="line"><span style="color:#D73A49">            return</span><span style="color:#24292E"> authz;</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#6A737D">        // business logic</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre>
<h3 id="52-client-auth" level="3">5.2. Client Auth</h3>
<h4 id="521-declarative-approach-http-client" level="4">5.2.1. Declarative Approach (HTTP Client)</h4>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/http;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client c </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#032F62">"https://localhost:9090"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#E36209">    auth</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        username</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "tom"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">        password</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "123"</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> main</span><span style="color:#24292E">() </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Request req </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#005CC5">    json</span><span style="color:#24292E"> response </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> c</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">post</span><span style="color:#24292E">(</span><span style="color:#032F62">"/foo/bar"</span><span style="color:#24292E">, </span><span style="color:#E36209">req</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#6A737D">    // evaluate response</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre>
<h4 id="522-imperative-approach-http-client" level="4">5.2.2. Imperative Approach (HTTP Client)</h4>
<pre><div><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><span class="line"><span style="color:#D73A49">import</span><span style="color:#24292E"> ballerina/http;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">http</span><span style="color:#D73A49">:</span><span style="color:#24292E">CredentialsConfig config </span><span style="color:#D73A49">=</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    username</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "tom"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    password</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "123"</span></span>
<span class="line"><span style="color:#24292E">};</span></span>
<span class="line"><span style="color:#24292E">http</span><span style="color:#D73A49">:</span><span style="color:#24292E">ClientBasicAuthHandler handler </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#E36209">config</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client c </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#032F62">"https://localhost:9090"</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> main</span><span style="color:#24292E">() </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Request req </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">    req </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> handler.</span><span style="color:#6F42C1">enrich</span><span style="color:#24292E">(</span><span style="color:#E36209">req</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#005CC5">    json</span><span style="color:#24292E"> response </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> c</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">post</span><span style="color:#24292E">(</span><span style="color:#032F62">"/foo/bar"</span><span style="color:#24292E">, </span><span style="color:#E36209">req</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#6A737D">    // evaluate response</span></span>
<span class="line"><span style="color:#24292E">}</span></span></code></pre></div></pre></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"frontmatter":{},"content":"# Specification: Ballerina Auth Library\n\n_Owners_: @ldclakmal @shafreenAnfar  \n_Reviewers_: @shafreenAnfar  \n_Created_: 2021/10/01  \n_Updated_: 2022/02/17  \n_Edition_: Swan Lake  \n\n## Introduction\nThis is the specification for the Auth standard library of [Ballerina language](https://ballerina.io/), which is used for authorization of listeners and clients (HTTP, gRPC, GraphQL, WebSocket, WebSub, etc.).\n\nThe Auth library specification has evolved and may continue to evolve in the future. The released versions of the specification can be found under the relevant GitHub tag.\n\nIf you have any feedback or suggestions about the library, start a discussion via a [GitHub issue](https://github.com/ballerina-platform/ballerina-standard-library/issues) or in the [Discord server](https://discord.gg/ballerinalang). Based on the outcome of the discussion, the specification and implementation can be updated. Community feedback is always welcome. Any accepted proposal, which affects the specification is stored under `/docs/proposals`. Proposals under discussion can be found with the label `type/proposal` in GitHub.\n\nThe conforming implementation of the specification is released and included in the distribution. Any deviation from the specification is considered a bug.\n\n## Contents\n\n1. [Overview](#1-overview)\n2. [Basic Auth](#2-basic-auth)\n3. [Listener Auth](#3-listener-auth)\n    * 3.1. [Basic Auth Provider](#31-basic-auth-provider)\n        * 3.1.1. [File User Store](#311-file-user-store)\n        * 3.1.2. [LDAP User Store](#312-ldap-user-store)\n    * 3.2. [Basic Auth Handler](#32-basic-auth-handler)\n        * 3.2.1. [File User Store](#321-file-user-store)\n        * 3.2.2. [LDAP User Store](#322-ldap-user-store)\n    * 3.3. [Declarative Approach](#33-declarative-approach)\n    * 3.4. [Imperative Approach](#34-imperative-approach)\n4. [Client Auth](#4-client-auth)\n    * 4.1. [Basic Auth Provider](#41-basic-auth-provider)\n    * 4.2. [Basic Auth Handler](#42-basic-auth-handler)\n    * 4.3. [Declarative Approach](#43-declarative-approach)\n    * 4.4. [Imperative Approach](#44-imperative-approach)\n5. [Samples](#5-samples)\n    * 5.1. [Listener Auth](#51-listener-auth)\n        * 5.1.1. [Declarative Approach (HTTP Listener)](#511-declarative-approach-http-listener)\n            * 5.1.1.1. [File User Store](#5111-file-user-store)\n            * 5.1.1.2. [LDAP User Store](#5112-ldap-user-store)\n        * 5.1.2. [Imperative Approach (HTTP Listener)](#512-imperative-approach-http-listener)\n            * 5.1.2.1. [File User Store](#5121-file-user-store)\n            * 5.1.2.2. [LDAP User Store](#5122-ldap-user-store)\n    * 5.2. [Client Auth](#52-client-auth)\n        * 5.2.1. [Declarative Approach (HTTP Client)](#521-declarative-approach-http-client)\n        * 5.2.2. [Imperative Approach (HTTP Client)](#522-imperative-approach-http-client)\n\n## 1. Overview\nThis specification elaborates on Basic Auth authentication and authorization for all the Ballerina listeners and \nclients. The HTTP, gRPC, GraphQL, WebSocket, WebSub protocol-based listeners and clients are secured according to this \nspecification.\n\nThis has a number of design principles:\n- **Listener auth**: This refers to the authentication and authorization of the listener as defined in \n  [Ballerina 2021R1 Section 5.7.4](https://ballerina.io/spec/lang/2021R1/#section_5.7.4). The inbound requests/messages \n  independent of the transport protocol are authenticated and authorized according to the configured authentication \n  protocol and related configurations.\n- **Client auth**: This refers to the authentication of the client as defined in \n  [Ballerina 2021R1 Section 7.9](https://ballerina.io/spec/lang/2021R1/#section_7.9). The outbound requests/messages \n  independent of the transport protocol are enriched according to the configured authentication protocol and related \n  configurations.\n- **Auth provider**: This is the entity that is responsible for providing all the auth protocol-related implementations.\n- **Auth handler**: This is the entity that is responsible for handling the security of the API based on the transport \n  protocol and with the use of provider APIs. This API gets the credentials and required configurations as user inputs \n  and returns the authentication protocol-related information. Internally, these APIs call the provider APIs of the \n  relevant authentication protocol.\n- **Declarative approach**: This is also known as the configuration-driven approach, which is used for simple use cases, \n  where users have to provide a set of configurations and do not need to be worried more about how authentication and \n  authorization works.\n- **Imperative approach**: This is also known as the code-driven approach, which is used for advanced use cases, where \n  users need to be worried more about how authentication and authorization work and need to have further customizations.\n\n## 2. Basic Auth\nBasic Auth protocol defines the credential as username and password are concatenated with a `:` and encoded using \nBase64 as defined in [RFC4648 Section 4](https://datatracker.ietf.org/doc/html/rfc4648#section-4) into a sequence of \nUS-ASCII characters as defined in [RFC0020](https://datatracker.ietf.org/doc/html/rfc0020).\n\n## 3. Listener Auth\nThis refers to the authentication and authorization of the listener as defined in \n[Ballerina 2021R1 Section 5.7.4](https://ballerina.io/spec/lang/2021R1/#section_5.7.4). The inbound requests/messages \nindependent of the transport protocol are authenticated and authorized according to the configured authentication \nprotocol and related configurations.\n\n### 3.1. Basic Auth Provider\n\n#### 3.1.1. File User Store\nThe user information is stored in a file in the [TOML language](https://toml.io/en/). The structure of the file would \nbe as follows:\n\n```toml\n# 1* of the following block\n[[ballerina.auth.users]]\nusername=\u003cString\u003e\npassword=\u003cString\u003e\nscopes=\u003cString Array\u003e\n```\n\nThe File User Store Basic Auth Provider has an API to authenticate the Basic Auth credential using the File User Store \ndefined in [TOML language](https://toml.io/en/) and return the `UserDetails` which consists of the username and scopes\nas an array if available.\n\n```ballerina\npublic type FileUserStoreConfig record {|\n|};\n\npublic type UserDetails record {|\n    string username;\n    string[]? scopes;\n|};\n\npublic class ListenerFileUserStoreBasicAuthProvider {\n\n    public function init(FileUserStoreConfig config) {\n        // init basic auth provider for file user store\n    }\n    \n    public function authenticate(string credential) returns UserDetails|error {\n        // read the user store file, validate the credential and return user details\n    }\n}\n```\n\n#### 3.1.2. LDAP User Store\nThe user information is stored in a user store that connects with the LDAP protocol as defined in \n[RFC4511](https://datatracker.ietf.org/doc/html/rfc4511).\n\nThe LDAP User Store Basic Auth Provider has an API to authenticate the Basic Auth credential using the LDAP User Store. \nThe `LdapUserStoreConfig` record is used to provide the configuration related to the LDAP protocol. This returns the \n`UserDetails` which consists of the username and scopes as an array if available.\n\n```ballerina\npublic type LdapUserStoreConfig record {|\n    string domainName;\n    string connectionUrl;\n    string connectionName;\n    string connectionPassword;\n    string userSearchBase;\n    string userEntryObjectClass;\n    string userNameAttribute;\n    string userNameSearchFilter;\n    string userNameListFilter;\n    string[] groupSearchBase;\n    string groupEntryObjectClass;\n    string groupNameAttribute;\n    string groupNameSearchFilter;\n    string groupNameListFilter;\n    string membershipAttribute;\n    boolean userRolesCacheEnabled = false;\n    boolean connectionPoolingEnabled = true;\n    decimal connectionTimeout = 5;\n    decimal readTimeout = 60;\n    SecureSocket secureSocket?;\n|};\n\npublic type UserDetails record {|\n    string username;\n    string[]? scopes;\n|};\n\npublic class ListenerLdapUserStoreBasicAuthProvider {\n\n    public function init(LdapUserStoreConfig config) {\n        // init basic auth provider for LDAP\n    }\n    \n    public function authenticate(string credential) returns UserDetails|Error {\n        // connect to LDAP, validate the credential and return user details\n    }\n}\n```\n\n### 3.2. Basic Auth Handler\n\n\u003e **NOTE**: Since the auth handlers are tightly bound with the transport protocol, for the explanation of the concept, \n\u003e all the samples are created for HTTP transport protocol hereinafter.\n\n#### 3.2.1. File User Store\nThe user information is stored in a file in the [TOML language](https://toml.io/en/). The structure of the file would \nbe as follows:\n\n```\n# 1* of the following block\n[[ballerina.auth.users]]\nusername=\u003cString\u003e\npassword=\u003cString\u003e\nscopes=\u003cString Array\u003e\n```\n\nThe File User Store Basic Auth Handler has an API to authenticate the HTTP request, headers of the HTTP request, or the \ncredential as defined in [RFC7617 Section 2](https://datatracker.ietf.org/doc/html/rfc7617#section-2) using the File \nUser Store defined in [TOML language](https://toml.io/en/). This returns the `UserDetails` which consists of the \nusername and scopes as an array if available or `Unauthorized` in case of authentication failure.\n\nThe File User Store Basic Auth Handler has an API to authorize the user against the expected scope or scopes. This \nreturns `Forbidden` in case of authorization failure.\n\n```ballerina\nimport ballerina/auth;\n\npublic type FileUserStoreConfig record {|\n    *auth:FileUserStoreConfig;\n|};\n\npublic class ListenerFileUserStoreBasicAuthHandler {\n\n    private final auth:ListenerFileUserStoreBasicAuthProvider provider;\n    \n    public function init(FileUserStoreConfig config) {\n        self.provider = new (config);\n    }\n    \n    public function authenticate(Request|Headers|string data) returns auth:UserDetails|Unauthorized {\n        // extract the credential from data\n        auth:UserDetails|auth:Error details = self.provider.authenticate(credential);\n        if details is auth:Error {\n            // return `Unauthorized`\n        }\n        return \u003cauth:UserDetails\u003edetails;\n    }\n    \n    public function authorize(auth:UserDetails userDetails, string|string[] expectedScopes) returns Forbidden? {\n        // match the scopes with the provided `expectedScopes`\n        // if not matched return `Forbidden`\n    }\n}\n```\n\n#### 3.2.2. LDAP User Store\nThe LDAP User Store Basic Auth Handler has an API to authenticate the HTTP request, headers of the HTTP request, or the \ncredential as defined in [RFC7617 Section 2](https://datatracker.ietf.org/doc/html/rfc7617#section-2) using the LDAP \nUser Store. The `LdapUserStoreConfig` record is used to provide the configuration related to the LDAP protocol. This \nreturns the `UserDetails` which consists of the username and scopes as an array if available or `Unauthorized` in case \nof authentication failure.\n\nThe LDAP User Store Basic Auth Handler has an API to authorize the user against the expected scope or scopes. This \nreturns `Forbidden` in case of authorization failure.\n\n```ballerina\nimport ballerina/auth;\n\npublic type LdapUserStoreConfig record {|\n    *auth:LdapUserStoreConfig;\n|};\n\npublic client class ListenerLdapUserStoreBasicAuthHandler {\n\n    private final auth:ListenerLdapUserStoreBasicAuthProvider provider;\n    \n    public function init(LdapUserStoreConfig config) {\n        self.provider = new (config);\n    }\n    \n    remote function authenticate(Request|Headers|string data) returns auth:UserDetails|Unauthorized {\n        // extract the credential from data\n        auth:UserDetails|auth:Error details = self.provider.authenticate(credential);\n        if details is auth:Error {\n            // return `Unauthorized`\n        }\n        return \u003cauth:UserDetails\u003edetails;\n    }\n    \n    remote function authorize(auth:UserDetails details, string|string[] expectedScopes) returns Forbidden? {\n        // match the scopes with the provided `expectedScopes`\n        // if not matched return `Forbidden`\n    }\n}\n```\n\n### 3.3. Declarative Approach\nThis is also known as the configuration-driven approach, which is used for simple use cases, where users have to \nprovide a set of configurations and do not need to be worried more about how authentication and authorization works. \nThe user does not have full control over the configuration-driven approach.\n\nThe service and/or resource configurations are used to define the authentication and authorization configurations. \nUsers can configure the configurations needed for different authentication schemes and configurations needed for \nauthorizations of each authentication scheme. Also, the configurations can be provided at both the service and resource \nlevels. The priority will be given from bottom to top. Then, the auth handler creation and request \nauthentication/authorization is handled internally without user intervention. The requests that succeeded both \nauthentication and/or authorization phases according to the configurations will be passed to the business logic layer.\n\n### 3.4. Imperative Approach\nThis is also known as the code-driven approach, which is used for advanced use cases, where users need to be worried \nmore about how authentication and authorization work and need to have further customizations. The user has full control \nof the code-driven approach. The handler creation and authentication/authorization calls are made by the user at the \nbusiness logic layer.\n\n## 4. Client Auth\nThis refers to the authentication of the client as defined in\n[Ballerina 2021R1 Section 7.9](https://ballerina.io/spec/lang/2021R1/#section_7.9). The outbound requests/messages\nindependent of the transport protocol are enriched according to the configured authentication protocol and related\nconfigurations.\n\n### 4.1. Basic Auth Provider\nThe Basic Auth Provider has an API to generate the Basic Auth credential. The `CredentialsConfig` record is used to \nprovide the configuration related to the token generation. This returns the generated token.\n\n```ballerina\npublic type CredentialsConfig record {|\n    string username;\n    string password;\n|};\n\npublic class ClientBasicAuthProvider {\n\n    public function init(CredentialsConfig config) {\n        // init basic auth provider\n    }\n    \n    public function generateToken() returns string|Error {\n        // generate the base64 encoded `username:password` value\n    }\n}\n```\n\n### 4.2. Basic Auth Handler\n\n\u003e **NOTE**: Since the auth handlers are tightly bound with the transport protocol, for the explanation of the concept, \n\u003e all the samples are created for HTTP transport protocol hereinafter.\n\nThe Basic Auth Handler has an API to enrich the HTTP request as defined in \n[RFC7617 Section 2](https://datatracker.ietf.org/doc/html/rfc7617#section-2) using the File User Store defined in TOML \nlanguage. This returns the enriched `Request` with headers or `Error` in case of failure.\n\n```ballerina\nimport ballerina/auth;\n\npublic type CredentialsConfig record {|\n    *auth:CredentialsConfig;\n|};\n\npublic class ClientBasicAuthHandler {\n\n    private final auth:ClientBasicAuthProvider provider;\n    \n    public function init(CredentialsConfig config) {\n        self.provider = new (config);\n    }\n    \n    public function enrich(Request req) returns Request|Error {\n        string|auth:Error token = self.provider.generateToken();\n        // set the token as the `Authorization: Bearer \u003ctoken\u003e` header\n    }\n}\n```\n\n### 4.3. Declarative Approach\nThis is also known as a configuration-driven approach, which is used for simple use cases, where users have to provide \na set of configurations and do not need to be worried more about how authentication works. The user does not have full \ncontrol over the configuration-driven approach.\n\nThe client configurations are used to define the authentication configurations. Users can configure the configurations \nneeded for different authentication schemes. Then, the auth handler creation and request enrichment is handled \ninternally without user intervention.\n\n### 4.4. Imperative Approach\nThis is also known as the code-driven approach, which is used for advanced use cases, where users need to be worried \nmore about how authentication works and need to have further customizations. The user has full control of the \ncode-driven approach. The handler creation and request enrichment calls are made by the user at the business logic layer.\n\n## 5. Samples\n\n### 5.1. Listener Auth\n\n#### 5.1.1. Declarative Approach (HTTP Listener)\n\n##### 5.1.1.1. File User Store\n\n```ballerina\nimport ballerina/http;\n\n@http:ServiceConfig {\n    auth: [\n        {\n            fileUserStoreConfig: {},\n            scopes: [\"admin\"]\n        }\n    ]\n}\nservice /foo on new http:Listener(9090) {\n    resource function get bar() returns string {\n        return \"Hello, World!\";\n    }\n}\n```\n\n##### 5.1.1.2. LDAP User Store\n\n```ballerina\nimport ballerina/http;\n\n@http:ServiceConfig {\n    auth: [\n        {\n            ldapUserStoreConfig: {\n                domainName: \"avix.lk\",\n                connectionUrl: \"ldap://localhost:389\",\n                connectionName: \"cn=admin,dc=avix,dc=lk\",\n                connectionPassword: \"avix123\",\n                userSearchBase: \"ou=Users,dc=avix,dc=lk\",\n                userEntryObjectClass: \"inetOrgPerson\",\n                userNameAttribute: \"uid\",\n                userNameSearchFilter: \"(\u0026(objectClass=inetOrgPerson)(uid=?))\",\n                userNameListFilter: \"(objectClass=inetOrgPerson)\",\n                groupSearchBase: [\"ou=Groups,dc=avix,dc=lk\"],\n                groupEntryObjectClass: \"groupOfNames\",\n                groupNameAttribute: \"cn\",\n                groupNameSearchFilter: \"(\u0026(objectClass=groupOfNames)(cn=?))\",\n                groupNameListFilter: \"(objectClass=groupOfNames)\",\n                membershipAttribute: \"member\",\n                userRolesCacheEnabled: true,\n                connectionPoolingEnabled: false,\n                connectionTimeout: 5,\n                readTimeout: 60\n            },\n            scopes: [\"admin\"]\n        }\n    ]\n}\nservice /foo on new http:Listener(9090) {\n    resource function get bar() returns string {\n        return \"Hello, World!\";\n    }\n}\n```\n\n#### 5.1.2. Imperative Approach (HTTP Listener)\n\n##### 5.1.2.1. File User Store\n\n```ballerina\nimport ballerina/http;\nimport ballerina/auth;\n\nhttp:FileUserStoreConfig config = {};\nhttp:ListenerFileUserStoreBasicAuthHandler handler = new (config);\n\nservice /foo on new http:Listener(9090) {\n    resource function post bar(@http:Header string Authorization) returns string|http:Unauthorized|http:Forbidden {\n        auth:UserDetails|http:Unauthorized authn = handler.authenticate(Authorization);\n        if authn is http:Unauthorized {\n            return authn;\n        }\n        http:Forbidden? authz = handler.authorize(\u003cauth:UserDetails\u003eauthn, \"admin\");\n        if authz is http:Forbidden {\n            return authz;\n        }\n        // business logic\n    }\n}\n```\n\n##### 5.1.2.2. LDAP User Store\n\n```ballerina\nimport ballerina/http;\nimport ballerina/auth;\n\nhttp:LdapUserStoreConfig config = {\n    domainName: \"avix.lk\",\n    connectionUrl: \"ldap://localhost:389\",\n    connectionName: \"cn=admin,dc=avix,dc=lk\",\n    connectionPassword: \"avix123\",\n    userSearchBase: \"ou=Users,dc=avix,dc=lk\",\n    userEntryObjectClass: \"inetOrgPerson\",\n    userNameAttribute: \"uid\",\n    userNameSearchFilter: \"(\u0026(objectClass=inetOrgPerson)(uid=?))\",\n    userNameListFilter: \"(objectClass=inetOrgPerson)\",\n    groupSearchBase: [\"ou=Groups,dc=avix,dc=lk\"],\n    groupEntryObjectClass: \"groupOfNames\",\n    groupNameAttribute: \"cn\",\n    groupNameSearchFilter: \"(\u0026(objectClass=groupOfNames)(cn=?))\",\n    groupNameListFilter: \"(objectClass=groupOfNames)\",\n    membershipAttribute: \"member\",\n    userRolesCacheEnabled: true,\n    connectionPoolingEnabled: false,\n    connectionTimeout: 5,\n    readTimeout: 60\n};\nhttp:ListenerLdapUserStoreBasicAuthHandler handler = new (config);\n\nservice /foo on new http:Listener(9090) {\n    resource function post bar(@http:Header string Authorization) returns string|http:Unauthorized|http:Forbidden {\n        auth:UserDetails|http:Unauthorized authn = handler-\u003eauthenticate(Authorization);\n        if authn is http:Unauthorized {\n            return authn;\n        }\n        http:Forbidden? authz = handler-\u003eauthorize(\u003cauth:UserDetails\u003eauthn, \"admin\");\n        if authz is http:Forbidden {\n            return authz;\n        }\n        // business logic\n    }\n}\n```\n\n### 5.2. Client Auth\n\n#### 5.2.1. Declarative Approach (HTTP Client)\n\n```ballerina\nimport ballerina/http;\n\nhttp:Client c = check new (\"https://localhost:9090\",\n    auth = {\n        username: \"tom\",\n        password: \"123\"\n    }\n);\n\npublic function main() returns error? {\n    http:Request req = new;\n    json response = check c-\u003epost(\"/foo/bar\", req);\n    // evaluate response\n}\n```\n\n#### 5.2.2. Imperative Approach (HTTP Client)\n\n```ballerina\nimport ballerina/http;\n\nhttp:CredentialsConfig config = {\n    username: \"tom\",\n    password: \"123\"\n};\nhttp:ClientBasicAuthHandler handler = new (config);\n\nhttp:Client c = check new (\"https://localhost:9090\");\n\npublic function main() returns error? {\n    http:Request req = new;\n    req = check handler.enrich(req);\n    json response = check c-\u003epost(\"/foo/bar\", req);\n    // evaluate response\n}\n```\n","codeSnippets":"[[-1933500355,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e# 1* of the following block\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e[[\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eballerina\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eauth\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eusers\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e]]\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eusername=\u0026#x3C;\u003c/span\u003e\u003cspan style=\\\"color:#B31D28;font-style:italic\\\"\u003eString\u003e\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003epassword=\u0026#x3C;\u003c/span\u003e\u003cspan style=\\\"color:#B31D28;font-style:italic\\\"\u003eString\u003e\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003escopes=\u0026#x3C;\u003c/span\u003e\u003cspan style=\\\"color:#B31D28;font-style:italic\\\"\u003eString Array\u003e\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[-2024930277,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e type\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e FileUserStoreConfig\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e record\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e type\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e UserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e record\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e username;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e[]? scopes;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic class\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e ListenerFileUserStoreBasicAuthProvider\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e init\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eFileUserStoreConfig\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e config\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // init basic auth provider for file user store\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e authenticate\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003estring\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e credential\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e UserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|error\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // read the user store file, validate the credential and return user details\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[-729061642,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e type\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e LdapUserStoreConfig\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e record\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e domainName;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e connectionUrl;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e connectionName;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e connectionPassword;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e userSearchBase;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e userEntryObjectClass;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e userNameAttribute;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e userNameSearchFilter;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e userNameListFilter;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e[] groupSearchBase;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e groupEntryObjectClass;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e groupNameAttribute;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e groupNameSearchFilter;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e groupNameListFilter;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e membershipAttribute;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    boolean\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e userRolesCacheEnabled \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e false\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    boolean\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e connectionPoolingEnabled \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e true\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    decimal\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e connectionTimeout \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e 5\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    decimal\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e readTimeout \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e 60\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    SecureSocket secureSocket\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e?\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e type\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e UserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e record\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e username;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e[]? scopes;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic class\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e ListenerLdapUserStoreBasicAuthProvider\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e init\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eLdapUserStoreConfig\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e config\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // init basic auth provider for LDAP\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e authenticate\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003estring\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e credential\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e UserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eError {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // connect to LDAP, validate the credential and return user details\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[439007208,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/auth;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e type\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e FileUserStoreConfig\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e record\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    *\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eauth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eFileUserStoreConfig;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic class\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e ListenerFileUserStoreBasicAuthHandler\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    private\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e final\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eListenerFileUserStoreBasicAuthProvider provider;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e init\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eFileUserStoreConfig\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e config\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e        self\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.provider \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e (\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003econfig\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e authenticate\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eRequest\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eHeaders\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003estring\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e data\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUnauthorized {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // extract the credential from data\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eauth:Error details \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e self\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.provider.\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eauthenticate\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003ecredential\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        if\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e details \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eis\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eError {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e            // return `Unauthorized`\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        return\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eauth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e\u003e\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003edetails;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e authorize\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eauth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails userDetails, \u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003estring\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003estring\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e[] \u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eexpectedScopes\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e Forbidden\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e?\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // match the scopes with the provided `expectedScopes`\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // if not matched return `Forbidden`\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[-312231695,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/auth;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e type\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e LdapUserStoreConfig\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e record\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    *\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eauth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eLdapUserStoreConfig;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e client class\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e ListenerLdapUserStoreBasicAuthHandler\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    private\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e final\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eListenerLdapUserStoreBasicAuthProvider provider;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e init\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eLdapUserStoreConfig\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e config\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e        self\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.provider \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e (\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003econfig\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    remote\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e authenticate\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eRequest\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eHeaders\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003estring\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e data\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUnauthorized {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // extract the credential from data\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eauth:Error details \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e self\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.provider.\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eauthenticate\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003ecredential\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        if\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e details \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eis\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eError {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e            // return `Unauthorized`\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        return\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e \u0026#x3C;\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eauth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e\u003e\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003edetails;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    remote\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e authorize\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eauth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails details, \u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003estring\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003estring\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e[] \u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eexpectedScopes\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e Forbidden\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e?\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // match the scopes with the provided `expectedScopes`\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // if not matched return `Forbidden`\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[1713162733,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e type\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e CredentialsConfig\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e record\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e username;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e password;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic class\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e ClientBasicAuthProvider\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e init\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eCredentialsConfig\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e config\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // init basic auth provider\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e generateToken\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e() \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e string\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eError {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // generate the base64 encoded `username:password` value\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[1943847585,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/auth;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e type\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e CredentialsConfig\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e record\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    *\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eauth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eCredentialsConfig;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic class\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e ClientBasicAuthHandler\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    private\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e final\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eClientBasicAuthProvider provider;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e init\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eCredentialsConfig\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e config\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e        self\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.provider \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e (\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003econfig\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    \u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    public\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e enrich\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eRequest\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e req\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e Request\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eError {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e        string\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|auth:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eError token \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e self\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e.provider.\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003egenerateToken\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e();\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // set the token as the `Authorization: Bearer \u0026#x3C;token\u003e` header\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[-1144475572,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/http;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e@\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003eServiceConfig\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e [\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e            fileUserStoreConfig\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: {},\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e            scopes\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: [\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"admin\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e]\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    ]\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eservice\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e /foo\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e on\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e http:Listener(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e9090\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    resource\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e get\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e bar\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e() \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        return\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"Hello, World!\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[-1088021531,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/http;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e@\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003eServiceConfig\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e [\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e            ldapUserStoreConfig\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                domainName\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"avix.lk\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                connectionUrl\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"ldap://localhost:389\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                connectionName\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"cn=admin,dc=avix,dc=lk\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                connectionPassword\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"avix123\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                userSearchBase\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"ou=Users,dc=avix,dc=lk\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                userEntryObjectClass\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"inetOrgPerson\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                userNameAttribute\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"uid\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                userNameSearchFilter\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"(\u0026#x26;(objectClass=inetOrgPerson)(uid=?))\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                userNameListFilter\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"(objectClass=inetOrgPerson)\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                groupSearchBase\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: [\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"ou=Groups,dc=avix,dc=lk\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e],\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                groupEntryObjectClass\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"groupOfNames\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                groupNameAttribute\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"cn\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                groupNameSearchFilter\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"(\u0026#x26;(objectClass=groupOfNames)(cn=?))\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                groupNameListFilter\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"(objectClass=groupOfNames)\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                membershipAttribute\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"member\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                userRolesCacheEnabled\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003etrue\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                connectionPoolingEnabled\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003efalse\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                connectionTimeout\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e5\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e                readTimeout\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: \u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e60\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e            },\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e            scopes\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e: [\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"admin\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e]\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    ]\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eservice\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e /foo\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e on\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e http:Listener(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e9090\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    resource\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e get\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e bar\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e() \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e string\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        return\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"Hello, World!\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[-609118238,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/http;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/auth;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eFileUserStoreConfig config \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eListenerFileUserStoreBasicAuthHandler handler \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e (\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003econfig\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eservice\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e /foo\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e on\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e http:Listener(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e9090\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    resource\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e post\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e bar\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(@\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003eHeader\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e string\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e Authorization\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e string\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUnauthorized\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp:Forbidden {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp:Unauthorized authn \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e handler.\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eauthenticate\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eAuthorization\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        if\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e authn \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eis\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e http\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUnauthorized {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e            return\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e authn;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        http\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eForbidden? authz \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e handler.\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eauthorize\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eauth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e\u003e\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eauthn\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"admin\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        if\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e authz \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eis\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e http\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eForbidden {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e            return\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e authz;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // business logic\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[-2030977860,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/http;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/auth;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eLdapUserStoreConfig config \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    domainName\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"avix.lk\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    connectionUrl\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"ldap://localhost:389\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    connectionName\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"cn=admin,dc=avix,dc=lk\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    connectionPassword\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"avix123\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    userSearchBase\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"ou=Users,dc=avix,dc=lk\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    userEntryObjectClass\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"inetOrgPerson\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    userNameAttribute\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"uid\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    userNameSearchFilter\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"(\u0026#x26;(objectClass=inetOrgPerson)(uid=?))\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    userNameListFilter\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"(objectClass=inetOrgPerson)\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    groupSearchBase\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e [\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"ou=Groups,dc=avix,dc=lk\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e],\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    groupEntryObjectClass\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"groupOfNames\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    groupNameAttribute\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"cn\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    groupNameSearchFilter\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"(\u0026#x26;(objectClass=groupOfNames)(cn=?))\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    groupNameListFilter\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"(objectClass=groupOfNames)\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    membershipAttribute\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"member\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    userRolesCacheEnabled\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e true\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    connectionPoolingEnabled\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e false\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    connectionTimeout\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e 5\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    readTimeout\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e 60\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eListenerLdapUserStoreBasicAuthHandler handler \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e (\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003econfig\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eservice\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e /foo\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e on\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e http:Listener(\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e9090\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e    resource\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e post\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e bar\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(@\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003eHeader\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e string\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e Authorization\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e) \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e string\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUnauthorized\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp:Forbidden {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e|\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp:Unauthorized authn \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e handler\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eauthenticate\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eAuthorization\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        if\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e authn \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eis\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e http\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUnauthorized {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e            return\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e authn;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        http\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eForbidden? authz \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e handler\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eauthorize\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eauth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eUserDetails\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e\u003e\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003eauthn\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"admin\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e        if\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e authz \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eis\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e http\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eForbidden {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e            return\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e authz;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e        // business logic\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[320165857,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/http;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eClient c \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e check\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e (\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"https://localhost:9090\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#E36209\\\"\u003e    auth\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e =\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        username\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"tom\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e        password\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"123\\\"\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    }\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e main\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e() \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e error?\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    http\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eRequest req \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    json\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e response \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e check\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e c\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003epost\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"/foo/bar\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003ereq\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e    // evaluate response\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"],[-1676888424,\"\u003cpre class=\\\"shiki github-light\\\" style=\\\"background-color:#fff;color:#24292e\\\" tabindex=\\\"0\\\"\u003e\u003ccode\u003e\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003eimport\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e ballerina/http;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eCredentialsConfig config \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    username\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"tom\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e,\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    password\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e \\\"123\\\"\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e};\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eClientBasicAuthHandler handler \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e (\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003econfig\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003ehttp\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eClient c \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e check\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e (\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"https://localhost:9090\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003epublic\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e function\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003e main\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e() \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003ereturns\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e error?\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e {\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    http\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e:\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003eRequest req \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e new\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e;\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e    req \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e check\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e handler.\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003eenrich\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003ereq\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#005CC5\\\"\u003e    json\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e response \u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e=\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e check\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e c\u003c/span\u003e\u003cspan style=\\\"color:#D73A49\\\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\\\"color:#6F42C1\\\"\u003epost\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e(\u003c/span\u003e\u003cspan style=\\\"color:#032F62\\\"\u003e\\\"/foo/bar\\\"\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e, \u003c/span\u003e\u003cspan style=\\\"color:#E36209\\\"\u003ereq\u003c/span\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e);\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#6A737D\\\"\u003e    // evaluate response\u003c/span\u003e\u003c/span\u003e\\n\u003cspan class=\\\"line\\\"\u003e\u003cspan style=\\\"color:#24292E\\\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\"]]"},"__N_SSG":true},"page":"/spec/[slug]","query":{"slug":"auth"},"buildId":"AraISIDs-pp-rOmbtdfJx","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>