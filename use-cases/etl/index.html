<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="description" content="Write code with integration-friendly abstractions."/><meta name="author" content="WSO2 LLC"/><meta name="keywords" content="ballerina, learn, documentation, docs, programming language"/><link rel="shortcut icon" href="/img/favicon.ico"/><title>Ballerina for ETL</title><meta property="og:type" content="article"/><meta property="og:title" content="Ballerina - Ballerina for ETL"/><meta property="og:description" content="Write code with integration-friendly abstractions."/><meta property="og:title" content="Ballerina - Ballerina for ETL"/><meta property="og:image" content="https://ballerina.io/images/ballerina-etl-sm-banner.png"/><meta property="og:description" itemProp="image" content="Write code with integration-friendly abstractions."/><meta name="twitter:site" content="@ballerinalang"/><meta name="twitter:creator" content="@ballerinalang"/><meta name="twitter:title" content="Ballerina - Ballerina for ETL"/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:description" content="Write code with integration-friendly abstractions."/><meta name="twitter:image" content="https://ballerina.io/images/ballerina-etl-sm-banner.png"/><meta property="twitter:text:description" content="Write code with integration-friendly abstractions."/><meta property="twitter:image" content="https://ballerina.io/images/ballerina-etl-sm-banner.png"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.setAttributeNode(d.createAttribute('data-ot-ignore'));j.async=true;j.src=
'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
})(window,document,'script','dataLayer','GTM-PSL2TX4');</script><script type="text/javascript" crossorigin="true" src="https://cdn.jsdelivr.net/npm/@docsearch/js@alpha"></script><script src="https://cookie-cdn.cookiepro.com/scripttemplates/otSDKStub.js" type="text/javascript" charSet="UTF-8" data-domain-script="630ad396-5fd5-4745-92ae-2765dc8841ee" defer=""></script><meta name="next-head-count" content="25"/><meta charSet="utf-8"/><meta name="author" content="WSO2 LLC"/><meta http-equiv="X-Frame-Options" content="SAMEORIGIN"/><meta http-equiv="Content-Security-Policy" content="frame-ancestors &#x27;none&#x27;;"/><link rel="shortcut icon" href="/images/favicon.ico"/><link rel="stylesheet" href="/css/roboto.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css"/><link rel="stylesheet" href="/css/ballerina-search-button.css"/><link rel="stylesheet" href="/css/ballerina-search-modal.css"/><link rel="stylesheet" href="/css/ballerina-search-variables.css"/><link rel="stylesheet" href="/css/ballerina-search-style.css"/><link rel="preload" href="/_next/static/css/9bb35c8110b0fa38.css" as="style"/><link rel="stylesheet" href="/_next/static/css/9bb35c8110b0fa38.css" data-n-g=""/><link rel="preload" href="/_next/static/css/34a5e7f657fdefb2.css" as="style"/><link rel="stylesheet" href="/_next/static/css/34a5e7f657fdefb2.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-9ee6b616f8ba237c.js" defer=""></script><script src="/_next/static/chunks/framework-79bce4a3a540b080.js" defer=""></script><script src="/_next/static/chunks/main-0ea70f422df5d19e.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ba2391f08766dae9.js" defer=""></script><script src="/_next/static/chunks/7621-d6bcd83f463fef72.js" defer=""></script><script src="/_next/static/chunks/1058-de0b031bc614d462.js" defer=""></script><script src="/_next/static/chunks/8130-4f833ffdbe1dba0f.js" defer=""></script><script src="/_next/static/chunks/6084-4e54ad5efcb8d3b5.js" defer=""></script><script src="/_next/static/chunks/5530-11a262420fdd225c.js" defer=""></script><script src="/_next/static/chunks/6242-7c6681de385c0d0b.js" defer=""></script><script src="/_next/static/chunks/1726-d958e891b50f9478.js" defer=""></script><script src="/_next/static/chunks/pages/use-cases/etl-8bbfa47506fb6443.js" defer=""></script><script src="/_next/static/wABIY1zECRpgDqtNoqHax/_buildManifest.js" defer=""></script><script src="/_next/static/wABIY1zECRpgDqtNoqHax/_ssgManifest.js" defer=""></script><script src="/_next/static/wABIY1zECRpgDqtNoqHax/_middlewareManifest.js" defer=""></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PSL2TX4" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__next" data-reactroot=""><div class="main-wrapper usecases vstack gap-0"><div class="wrap-page-content"><div class="community-wrap-row row"><div class="col-sm-12"><div class="pageHeader pageContentRow integration row"><div class="col-12"><div class="container"><h1>Ballerina for <i>ETL</i></h1></div></div></div><div class="pageContentRow integration row"><div class="col-12"><div class="container"><div class="row"><div class="col-lg-5 col-12"><div><p class="Intro_introText2__T9eDG">Extracting, transforming, and loading data often involves dealing with intricate, time-consuming processes, leading to high costs and operational inefficiencies.</p><p class="Intro_introText3____Wun">Ballerina simplifies ETL with its programmable approach. It excels in complex data operations, integrations, and deployment flexibility, ensuring a scalable and adaptable ETL experience.</p><p><a href="/downloads/" class="Intro_cDownload__5ashC">Download Ballerina</a></p></div></div><div class="Intro_introImg__pSkF8 col-lg-7 col-12"><img src="/images/etl-sm-banner.png" alt="AI"/></div></div></div></div></div><div class="pageContentRow integration code odd row"><div class="col-12"><div class="container"><div class="row"><div class="Code_box__Pmweq col-12"><h2 id="drive-data-interactions-with-models" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Data extraction (E)</h2></div></div><div class="Code_subsection__9izvC row"><div class="Code_box__Pmweq col-lg-5 col-md-5 col-12"><div><h3>Drive data interactions with models</h3><p>Ballerina&#x27;s <code>persist</code> feature seamlessly connects to databases, retrieves data, and kickstarts your ETL process.</p><div class="Code_dVersion__ghwNY"><a href="https://github.com/ballerina-guides/etl-samples/blob/main/extract-data-from-database/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div></div></div><div class="Code_box__Pmweq col-lg-7 col-md-7 col-12"><div class="Code_codeSnippet__xFpp1"><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><button type="button" title="Copy" aria-label="Copy" data="function getOrderData() returns error? {
    stream<OrderData, persist:Error?> orders = dbClient->/orderdata();
    check from var orderData in orders
        do {
            io:println(orderData);
        };
}

function getCustomerData() returns error? {
    stream<CustomerData, persist:Error?> customers = dbClient->/customers();
    check from var customerData in customers
        do {
            io:println(customerData);
        };
}

function getOrderWithCustomer(string orderId) returns error? {
    OrderWithCustomer orderwithCustomer = check dbClient->/orderdata/[orderId];
    io:println(orderwithCustomer);
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copied&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied&#x27;);window.setTimeout(() => {this.classList.remove(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copy&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy&#x27;);}, 3000);"><span class="ready"></span><span class="success"></span></button><span class="line"><span style="color:#D73A49">function</span><span style="color:#6F42C1"> getOrderData</span><span style="color:#24292E">() </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    stream&#x3C;</span><span style="color:#24292E">OrderData, persist</span><span style="color:#D73A49">:</span><span style="color:#24292E">Error?</span><span style="color:#D73A49">></span><span style="color:#24292E"> orders </span><span style="color:#D73A49">=</span><span style="color:#24292E"> dbClient</span><span style="color:#D73A49">->/</span><span style="color:#6F42C1">orderdata</span><span style="color:#24292E">();</span></span>
<span class="line"><span style="color:#D73A49">    check</span><span style="color:#D73A49"> from</span><span style="color:#005CC5"> var</span><span style="color:#24292E"> orderData </span><span style="color:#D73A49">in</span><span style="color:#24292E"> orders</span></span>
<span class="line"><span style="color:#D73A49">        do</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">            io</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#E36209">orderData</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">        };</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">function</span><span style="color:#6F42C1"> getCustomerData</span><span style="color:#24292E">() </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">    stream&#x3C;</span><span style="color:#24292E">CustomerData, persist</span><span style="color:#D73A49">:</span><span style="color:#24292E">Error?</span><span style="color:#D73A49">></span><span style="color:#24292E"> customers </span><span style="color:#D73A49">=</span><span style="color:#24292E"> dbClient</span><span style="color:#D73A49">->/</span><span style="color:#6F42C1">customers</span><span style="color:#24292E">();</span></span>
<span class="line"><span style="color:#D73A49">    check</span><span style="color:#D73A49"> from</span><span style="color:#005CC5"> var</span><span style="color:#24292E"> customerData </span><span style="color:#D73A49">in</span><span style="color:#24292E"> customers</span></span>
<span class="line"><span style="color:#D73A49">        do</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">            io</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#E36209">customerData</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">        };</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">function</span><span style="color:#6F42C1"> getOrderWithCustomer</span><span style="color:#24292E">(</span><span style="color:#005CC5">string</span><span style="color:#E36209"> orderId</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    OrderWithCustomer orderwithCustomer </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> dbClient</span><span style="color:#D73A49">->/</span><span style="color:#24292E">orderdata</span><span style="color:#D73A49">/</span><span style="color:#24292E">[orderId];</span></span>
<span class="line"><span style="color:#24292E">    io</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#E36209">orderwithCustomer</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">}</span></span><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></div></div></div></div><div class="Code_subsection__9izvC row"><div class="Code_box__Pmweq col-lg-5 col-md-5 col-12"><div><h3>Make data extraction smarter</h3><p>Ballerina AI integrations can extract information from unstructured data, unlocking vast amounts of information captured in emails, documents, comments, etc. in the extraction process.</p><div class="Code_dVersion__ghwNY"><a href="https://github.com/ballerina-guides/etl-samples/blob/main/extract-information-from-unstructured-data/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div></div></div><div class="Code_box__Pmweq col-lg-7 col-md-7 col-12"><div class="Code_codeSnippet__xFpp1"><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><button type="button" title="Copy" aria-label="Copy" data="final chat:Client openAiChat = check new ({auth: {token: openAIKey}});

isolated service /api/reviews on new http:Listener(8080) {
    resource function post summary(SummaryRequest summaryRequest) returns error? {
        chat:CreateChatCompletionRequest request = {
            model: &#x22;gpt-3.5-turbo&#x22;,
            messages: [
                {
                    role: &#x22;user&#x22;,
                    content: string &#x60;
                        Extract the following details in JSON from the reviews given.
                            {
                                good_points: string,
                                bad_points: string,
                                improvement_points: string
                            }
                        The fields should contain points extracted from all reviews
                        Here are the reviews:
                        ${string:&#x27;join(&#x22;,&#x22;, ...summaryRequest.reviews)}
                    &#x60;
                }
            ]
        };
        chat:CreateChatCompletionResponse summary = check openAiChat->/chat/completions.post(request);
        if summary.choices.length() > 0 {
            string content = check summary.choices[0].message?.content.ensureType();
            io:println(content);
        }
    }
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copied&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied&#x27;);window.setTimeout(() => {this.classList.remove(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copy&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy&#x27;);}, 3000);"><span class="ready"></span><span class="success"></span></button><span class="line"><span style="color:#D73A49">final</span><span style="color:#24292E"> chat</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client openAiChat </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> ({auth</span><span style="color:#D73A49">:</span><span style="color:#24292E"> {token: openAIKey}});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">isolated</span><span style="color:#D73A49"> service</span><span style="color:#6F42C1"> /api/reviews</span><span style="color:#D73A49"> on</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> http:Listener(</span><span style="color:#005CC5">8080</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">    resource</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> post</span><span style="color:#6F42C1"> summary</span><span style="color:#24292E">(</span><span style="color:#E36209">SummaryRequest</span><span style="color:#E36209"> summaryRequest</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        chat</span><span style="color:#D73A49">:</span><span style="color:#24292E">CreateChatCompletionRequest request </span><span style="color:#D73A49">=</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">            model</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "gpt-3.5-turbo"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">            messages</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span></span>
<span class="line"><span style="color:#24292E">                {</span></span>
<span class="line"><span style="color:#6F42C1">                    role</span><span style="color:#24292E">: </span><span style="color:#032F62">"user"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                    content</span><span style="color:#24292E">: </span><span style="color:#005CC5">string</span><span style="color:#24292E"> `</span></span>
<span class="line"><span style="color:#24292E">                        Extract the following details in JSON from the reviews given.</span></span>
<span class="line"><span style="color:#24292E">                            {</span></span>
<span class="line"><span style="color:#6F42C1">                                good_points</span><span style="color:#24292E">: </span><span style="color:#005CC5">string</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                                bad_points</span><span style="color:#24292E">: </span><span style="color:#005CC5">string</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                                improvement_points</span><span style="color:#24292E">: </span><span style="color:#005CC5">string</span></span>
<span class="line"><span style="color:#24292E">                            }</span></span>
<span class="line"><span style="color:#24292E">                        The fields should contain points extracted from all reviews</span></span>
<span class="line"><span style="color:#24292E">                        Here are the </span><span style="color:#6F42C1">reviews</span><span style="color:#24292E">:</span></span>
<span class="line"><span style="color:#24292E">                        ${</span><span style="color:#6F42C1">string</span><span style="color:#24292E">:</span><span style="color:#6F42C1">'join</span><span style="color:#24292E">(</span><span style="color:#032F62">","</span><span style="color:#24292E">, </span><span style="color:#D73A49">...</span><span style="color:#24292E">summaryRequest.reviews)}</span></span>
<span class="line"><span style="color:#24292E">                    `</span></span>
<span class="line"><span style="color:#24292E">                }</span></span>
<span class="line"><span style="color:#24292E">            ]</span></span>
<span class="line"><span style="color:#24292E">        };</span></span>
<span class="line"><span style="color:#24292E">        chat</span><span style="color:#D73A49">:</span><span style="color:#24292E">CreateChatCompletionResponse summary </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> openAiChat</span><span style="color:#D73A49">->/</span><span style="color:#24292E">chat</span><span style="color:#D73A49">/</span><span style="color:#24292E">completions.</span><span style="color:#6F42C1">post</span><span style="color:#24292E">(</span><span style="color:#E36209">request</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">        if</span><span style="color:#24292E"> summary.choices.</span><span style="color:#6F42C1">length</span><span style="color:#24292E">() </span><span style="color:#D73A49">></span><span style="color:#005CC5"> 0</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#005CC5">            string</span><span style="color:#24292E"> content </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> summary.choices[</span><span style="color:#005CC5">0</span><span style="color:#24292E">].message?.content.</span><span style="color:#6F42C1">ensureType</span><span style="color:#24292E">();</span></span>
<span class="line"><span style="color:#24292E">            io</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#E36209">content</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></div></div></div></div><div class="Code_subsection__9izvC row"><div class="Code_box__Pmweq col-lg-5 col-md-5 col-12"><div><h3>Unleash data from APIs</h3><p>Ballerina offers a wide range of built-in connectors, including HTTP and GraphQL clients, making it easy to interact with APIs for efficient data extraction in your ETL pipeline.</p><div class="Code_dVersion__ghwNY"><a href="https://github.com/ballerina-guides/etl-samples/blob/main/extract-data-from-github/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div></div></div><div class="Code_box__Pmweq col-lg-7 col-md-7 col-12"><div class="Code_codeSnippet__xFpp1"><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><button type="button" title="Copy" aria-label="Copy" data="configurable string githubAccessToken = ?;
configurable string repoOwner = &#x22;ballerina-platform&#x22;;
configurable string repoName = &#x22;ballerina-lang&#x22;;

final github:Client githubClient = check new ({
    auth: {
        token: githubAccessToken
    }
});

public function main() returns error? {
    github:IssueFilters filters = {
        labels: [&#x22;Type/NewFeature&#x22;, &#x22;Priority/High&#x22;],
        states: [github:ISSUE_OPEN]
    };
    stream<github:Issue, github:Error?> openFeatures
            = check githubClient->getIssues(repoOwner, repoName, filters);
    check from var feature in openFeatures
        do {
            io:println(feature.title);
        };
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copied&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied&#x27;);window.setTimeout(() => {this.classList.remove(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copy&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy&#x27;);}, 3000);"><span class="ready"></span><span class="success"></span></button><span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> githubAccessToken </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> repoOwner </span><span style="color:#D73A49">=</span><span style="color:#032F62"> "ballerina-platform"</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> repoName </span><span style="color:#D73A49">=</span><span style="color:#032F62"> "ballerina-lang"</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">final</span><span style="color:#24292E"> github</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client githubClient </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> ({</span></span>
<span class="line"><span style="color:#24292E">    auth</span><span style="color:#D73A49">:</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        token</span><span style="color:#D73A49">:</span><span style="color:#24292E"> githubAccessToken</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> main</span><span style="color:#24292E">() </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    github</span><span style="color:#D73A49">:</span><span style="color:#24292E">IssueFilters filters </span><span style="color:#D73A49">=</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        labels</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span><span style="color:#032F62">"Type/NewFeature"</span><span style="color:#24292E">, </span><span style="color:#032F62">"Priority/High"</span><span style="color:#24292E">],</span></span>
<span class="line"><span style="color:#24292E">        states</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span><span style="color:#6F42C1">github</span><span style="color:#24292E">:ISSUE_OPEN]</span></span>
<span class="line"><span style="color:#24292E">    };</span></span>
<span class="line"><span style="color:#D73A49">    stream&#x3C;</span><span style="color:#24292E">github</span><span style="color:#D73A49">:</span><span style="color:#24292E">Issue, github</span><span style="color:#D73A49">:</span><span style="color:#24292E">Error?</span><span style="color:#D73A49">></span><span style="color:#24292E"> openFeatures</span></span>
<span class="line"><span style="color:#D73A49">            =</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> githubClient</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">getIssues</span><span style="color:#24292E">(</span><span style="color:#E36209">repoOwner</span><span style="color:#24292E">, </span><span style="color:#E36209">repoName</span><span style="color:#24292E">, </span><span style="color:#E36209">filters</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#D73A49">    check</span><span style="color:#D73A49"> from</span><span style="color:#005CC5"> var</span><span style="color:#24292E"> feature </span><span style="color:#D73A49">in</span><span style="color:#24292E"> openFeatures</span></span>
<span class="line"><span style="color:#D73A49">        do</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">            io</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">println</span><span style="color:#24292E">(feature.title);</span></span>
<span class="line"><span style="color:#24292E">        };</span></span>
<span class="line"><span style="color:#24292E">}</span></span><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></div></div></div></div></div></div></div><div class="pageContentRow integration code row"><div class="col-12"><div class="container"><div class="row"><div class="Code_box__Pmweq col-12"><h2 id="eleminating-redundency-for-cleaner-data" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Data transformation (T)</h2></div></div><div class="Code_subsection__9izvC row"><div class="Code_box__Pmweq col-lg-5 col-md-5 col-12"><div><h3>Eliminating redundancy for cleaner data</h3><p>Ballerina simplifies duplicate removal through Ballerina queries and other intuitive constructs.</p><div class="Code_dVersion__ghwNY"><span>Sample 1: Remove duplicates based on composite fields</span><a href="https://github.com/ballerina-guides/etl-samples/blob/main/remove-duplicates/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div><div class="Code_dVersion__ghwNY"><span>Sample 2: Remove duplicates based on approximation</span><a href="https://github.com/ballerina-guides/etl-samples/blob/main/remove-approximate-duplicates/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div></div></div><div class="Code_box__Pmweq col-lg-7 col-md-7 col-12"><div id="code-tab"><ul class="mb-3 codeTabs nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><button type="button" id="code-tab-clean1" role="tab" data-rr-ui-event-key="clean1" aria-controls="code-tabpane-clean1" aria-selected="true" class="nav-link active">Sample 1</button></li><li class="nav-item" role="presentation"><button type="button" id="code-tab-clean2" role="tab" data-rr-ui-event-key="clean2" aria-controls="code-tabpane-clean2" aria-selected="false" tabindex="-1" class="nav-link">Sample 2</button></li></ul><div class="tab-content"><div role="tabpanel" id="code-tabpane-clean1" aria-labelledby="code-tab-clean1" class="fade tab-pane active show"><div class="Code_codeSnippet__xFpp1"><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><button type="button" title="Copy" aria-label="Copy" data="type SalesOrder record {|
    string itemId;
    string customerId;
    string itemName;
    int quantity;
    int date;
|};

function removeDuplicates(SalesOrder[] orders) returns SalesOrder[] {
    return from var {itemId, customerId, itemName, quantity, date} in orders
        group by itemId, customerId, itemName
        select {
            itemId,
            customerId,
            itemName,
            quantity: [quantity][0],
            date: [date][0]
        };
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copied&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied&#x27;);window.setTimeout(() => {this.classList.remove(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copy&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy&#x27;);}, 3000);"><span class="ready"></span><span class="success"></span></button><span class="line"><span style="color:#D73A49">type</span><span style="color:#6F42C1"> SalesOrder</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> itemId;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> customerId;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> itemName;</span></span>
<span class="line"><span style="color:#005CC5">    int</span><span style="color:#24292E"> quantity;</span></span>
<span class="line"><span style="color:#005CC5">    int</span><span style="color:#24292E"> date;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">function</span><span style="color:#6F42C1"> removeDuplicates</span><span style="color:#24292E">(</span><span style="color:#E36209">SalesOrder</span><span style="color:#24292E">[] </span><span style="color:#E36209">orders</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#24292E"> SalesOrder[] {</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#D73A49"> from</span><span style="color:#005CC5"> var</span><span style="color:#24292E"> {itemId, customerId, itemName, quantity, date} </span><span style="color:#D73A49">in</span><span style="color:#24292E"> orders</span></span>
<span class="line"><span style="color:#D73A49">        group</span><span style="color:#D73A49"> by</span><span style="color:#24292E"> itemId, customerId, itemName</span></span>
<span class="line"><span style="color:#D73A49">        select</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">            itemId,</span></span>
<span class="line"><span style="color:#24292E">            customerId,</span></span>
<span class="line"><span style="color:#24292E">            itemName,</span></span>
<span class="line"><span style="color:#24292E">            quantity</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [quantity][</span><span style="color:#005CC5">0</span><span style="color:#24292E">],</span></span>
<span class="line"><span style="color:#24292E">            date</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [date][</span><span style="color:#005CC5">0</span><span style="color:#24292E">]</span></span>
<span class="line"><span style="color:#24292E">        };</span></span>
<span class="line"><span style="color:#24292E">}</span></span><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></div></div></div><div role="tabpanel" id="code-tabpane-clean2" aria-labelledby="code-tab-clean2" class="fade tab-pane"><div class="Code_codeSnippet__xFpp1"><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><button type="button" title="Copy" aria-label="Copy" data="public type Customer record {|
    string name;
    string city;
    string phone;
|};

function findDuplicates(Customer[] customers) returns [Customer[], Customer[]] {
    Customer[] duplicates = [];
    Customer[] uniqueCustomers = [customers[0]];
    foreach int customerIdx in 1 ... customers.length() - 1 {
        foreach Customer uniqueCustomer in uniqueCustomers {
            Customer customer = customers[customerIdx];
            if getEditDistance(customer.name, uniqueCustomer.name) < 3 &#x26;&#x26;
                getEditDistance(customer.city, uniqueCustomer.city) < 2 &#x26;&#x26;
                getEditDistance(customer.phone, uniqueCustomer.phone) < 4 {
                duplicates.push(customer);
            } else {
                uniqueCustomers.push(customer);
            }
        }
    }
    return [uniqueCustomers, duplicates];
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copied&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied&#x27;);window.setTimeout(() => {this.classList.remove(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copy&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy&#x27;);}, 3000);"><span class="ready"></span><span class="success"></span></button><span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> type</span><span style="color:#6F42C1"> Customer</span><span style="color:#D73A49"> record</span><span style="color:#24292E"> {</span><span style="color:#D73A49">|</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> name;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> city;</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> phone;</span></span>
<span class="line"><span style="color:#D73A49">|</span><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">function</span><span style="color:#6F42C1"> findDuplicates</span><span style="color:#24292E">(</span><span style="color:#E36209">Customer</span><span style="color:#24292E">[] </span><span style="color:#E36209">customers</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#24292E"> [Customer[], Customer[]] {</span></span>
<span class="line"><span style="color:#24292E">    Customer[] duplicates </span><span style="color:#D73A49">=</span><span style="color:#24292E"> [];</span></span>
<span class="line"><span style="color:#24292E">    Customer[] uniqueCustomers </span><span style="color:#D73A49">=</span><span style="color:#24292E"> [customers[</span><span style="color:#005CC5">0</span><span style="color:#24292E">]];</span></span>
<span class="line"><span style="color:#D73A49">    foreach </span><span style="color:#005CC5">int</span><span style="color:#24292E"> customerIdx </span><span style="color:#D73A49">in</span><span style="color:#005CC5"> 1</span><span style="color:#D73A49"> ...</span><span style="color:#24292E"> customers.</span><span style="color:#6F42C1">length</span><span style="color:#24292E">() </span><span style="color:#D73A49">-</span><span style="color:#005CC5"> 1</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">        foreach </span><span style="color:#24292E">Customer uniqueCustomer </span><span style="color:#D73A49">in</span><span style="color:#24292E"> uniqueCustomers {</span></span>
<span class="line"><span style="color:#24292E">            Customer customer </span><span style="color:#D73A49">=</span><span style="color:#24292E"> customers[customerIdx];</span></span>
<span class="line"><span style="color:#D73A49">            if</span><span style="color:#6F42C1"> getEditDistance</span><span style="color:#24292E">(customer.name, uniqueCustomer.name) </span><span style="color:#D73A49">&#x3C;</span><span style="color:#005CC5"> 3</span><span style="color:#D73A49"> &#x26;&#x26;</span></span>
<span class="line"><span style="color:#6F42C1">                getEditDistance</span><span style="color:#24292E">(customer.city, uniqueCustomer.city) </span><span style="color:#D73A49">&#x3C;</span><span style="color:#005CC5"> 2</span><span style="color:#D73A49"> &#x26;&#x26;</span></span>
<span class="line"><span style="color:#6F42C1">                getEditDistance</span><span style="color:#24292E">(customer.phone, uniqueCustomer.phone) </span><span style="color:#D73A49">&#x3C;</span><span style="color:#005CC5"> 4</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">                duplicates.</span><span style="color:#6F42C1">push</span><span style="color:#24292E">(</span><span style="color:#E36209">customer</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">            } </span><span style="color:#D73A49">else</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">                uniqueCustomers.</span><span style="color:#6F42C1">push</span><span style="color:#24292E">(</span><span style="color:#E36209">customer</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">            }</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> [uniqueCustomers, duplicates];</span></span>
<span class="line"><span style="color:#24292E">}</span></span><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></div></div></div></div></div></div></div><div class="Code_subsection__9izvC row"><div class="Code_box__Pmweq col-lg-5 col-md-5 col-12"><div><h3>Refining data excellence</h3><p>Ballerina&#x27;s seamless integration with AI models enhances error correction, ensuring data integrity and precision during transformation.</p><div class="Code_dVersion__ghwNY"><a href="https://github.com/ballerina-guides/etl-samples/blob/main/refine-data-using-ai/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div></div></div><div class="Code_box__Pmweq col-lg-7 col-md-7 col-12"><div class="Code_codeSnippet__xFpp1"><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><button type="button" title="Copy" aria-label="Copy" data="configurable string openAIToken = ?;
final http:Client openAIClient = check new (&#x22;https://api.openai.com&#x22;, {auth: {token: openAIToken}});

public function main(string filePath) returns error? {
    string inputString = check io:fileReadString(filePath);

    OpenAiChatResponse response = check openAIClient->/v1/chat/completions.post(
        {
            model: &#x22;gpt-3.5-turbo&#x22;,
            messages: [
                {
                    role: &#x22;user&#x22;,
                    content: &#x22;Fix grammar and spelling mistakes.&#x22;
                },
                {
                    role: &#x22;user&#x22;,
                    content: inputString
                }
            ]
        }
    );

    io:println(string &#x60;Corrected: ${response.choices[0].message.content}&#x60;);
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copied&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied&#x27;);window.setTimeout(() => {this.classList.remove(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copy&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy&#x27;);}, 3000);"><span class="ready"></span><span class="success"></span></button><span class="line"><span style="color:#D73A49">configurable</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> openAIToken </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> ?</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#D73A49">final</span><span style="color:#24292E"> http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client openAIClient </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#032F62">"https://api.openai.com"</span><span style="color:#24292E">, {auth</span><span style="color:#D73A49">:</span><span style="color:#24292E"> {token: openAIToken}});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> main</span><span style="color:#24292E">(</span><span style="color:#005CC5">string</span><span style="color:#E36209"> filePath</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> inputString </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> io</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">fileReadString</span><span style="color:#24292E">(</span><span style="color:#E36209">filePath</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">    OpenAiChatResponse response </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> openAIClient</span><span style="color:#D73A49">->/</span><span style="color:#24292E">v1</span><span style="color:#D73A49">/</span><span style="color:#24292E">chat</span><span style="color:#D73A49">/</span><span style="color:#24292E">completions.</span><span style="color:#6F42C1">post</span><span style="color:#24292E">(</span></span>
<span class="line"><span style="color:#24292E">        {</span></span>
<span class="line"><span style="color:#24292E">            model</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "gpt-3.5-turbo"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">            messages</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span></span>
<span class="line"><span style="color:#24292E">                {</span></span>
<span class="line"><span style="color:#6F42C1">                    role</span><span style="color:#24292E">: </span><span style="color:#032F62">"user"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                    content</span><span style="color:#24292E">: </span><span style="color:#032F62">"Fix grammar and spelling mistakes."</span></span>
<span class="line"><span style="color:#24292E">                },</span></span>
<span class="line"><span style="color:#24292E">                {</span></span>
<span class="line"><span style="color:#6F42C1">                    role</span><span style="color:#24292E">: </span><span style="color:#032F62">"user"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#6F42C1">                    content</span><span style="color:#24292E">: inputString</span></span>
<span class="line"><span style="color:#24292E">                }</span></span>
<span class="line"><span style="color:#24292E">            ]</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#24292E">    );</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">    io</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">println</span><span style="color:#24292E">(</span><span style="color:#005CC5">string</span><span style="color:#032F62"> `Corrected: ${</span><span style="color:#24292E">response</span><span style="color:#032F62">.</span><span style="color:#24292E">choices</span><span style="color:#032F62">[</span><span style="color:#005CC5">0</span><span style="color:#032F62">].</span><span style="color:#24292E">message</span><span style="color:#032F62">.</span><span style="color:#24292E">content</span><span style="color:#032F62">}`</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">}</span></span><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></div></div></div></div><div class="Code_subsection__9izvC row"><div class="Code_box__Pmweq col-lg-5 col-md-5 col-12"><div><h3>Data enrichment magic</h3><p>Ballerina streamlines data enrichment, simplifying the journey from data extraction from databases or APIs to adding depth and context to your insights.</p><div class="Code_dVersion__ghwNY"><a href="https://github.com/ballerina-guides/etl-samples/blob/main/enrich-data/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div></div></div><div class="Code_box__Pmweq col-lg-7 col-md-7 col-12"><div class="Code_codeSnippet__xFpp1"><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><button type="button" title="Copy" aria-label="Copy" data="final http:Client geocodingClient = check new (&#x22;https://maps.googleapis.com&#x22;);

isolated service /api/v1 on new http:Listener(8080) {
    resource function post customerWithGeoCode(Customer customer) returns GeoTaggedCustomer|error {
        GeocodeResponse response = check geocodingClient->
            /maps/api/geocode/&#x27;json(address = customer.address, key = geocodingAPIKey);
        if response.status == &#x22;OK&#x22; {
            return {
                ...customer,
                latitude: response.results[0].geometry.location.lat,
                longitude: response.results[0].geometry.location.lng
            };
        }
        return error(&#x22;Error while getting the location information.&#x22;);
    }
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copied&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied&#x27;);window.setTimeout(() => {this.classList.remove(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copy&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy&#x27;);}, 3000);"><span class="ready"></span><span class="success"></span></button><span class="line"><span style="color:#D73A49">final</span><span style="color:#24292E"> http</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client geocodingClient </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#032F62">"https://maps.googleapis.com"</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">isolated</span><span style="color:#D73A49"> service</span><span style="color:#6F42C1"> /api/v1</span><span style="color:#D73A49"> on</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> http:Listener(</span><span style="color:#005CC5">8080</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">    resource</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> post</span><span style="color:#6F42C1"> customerWithGeoCode</span><span style="color:#24292E">(</span><span style="color:#E36209">Customer</span><span style="color:#E36209"> customer</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#24292E"> GeoTaggedCustomer</span><span style="color:#D73A49">|error</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        GeocodeResponse response </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> geocodingClient</span><span style="color:#D73A49">-></span></span>
<span class="line"><span style="color:#D73A49">            /</span><span style="color:#24292E">maps</span><span style="color:#D73A49">/</span><span style="color:#24292E">api</span><span style="color:#D73A49">/</span><span style="color:#24292E">geocode</span><span style="color:#D73A49">/</span><span style="color:#6F42C1">'json</span><span style="color:#24292E">(</span><span style="color:#E36209">address</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> customer.address, </span><span style="color:#E36209">key</span><span style="color:#D73A49"> =</span><span style="color:#24292E"> geocodingAPIKey);</span></span>
<span class="line"><span style="color:#D73A49">        if</span><span style="color:#24292E"> response.status </span><span style="color:#D73A49">==</span><span style="color:#032F62"> "OK"</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">            return</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#D73A49">                ...</span><span style="color:#24292E">customer,</span></span>
<span class="line"><span style="color:#24292E">                latitude</span><span style="color:#D73A49">:</span><span style="color:#24292E"> response.results[</span><span style="color:#005CC5">0</span><span style="color:#24292E">].geometry.location.lat,</span></span>
<span class="line"><span style="color:#24292E">                longitude</span><span style="color:#D73A49">:</span><span style="color:#24292E"> response.results[</span><span style="color:#005CC5">0</span><span style="color:#24292E">].geometry.location.lng</span></span>
<span class="line"><span style="color:#24292E">            };</span></span>
<span class="line"><span style="color:#24292E">        }</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#D73A49"> error</span><span style="color:#24292E">(</span><span style="color:#032F62">"Error while getting the location information."</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></div></div></div></div><div class="Code_subsection__9izvC row"><div class="Code_box__Pmweq col-lg-5 col-md-5 col-12"><div><h3>Reshaping data with data mapper</h3><p>Comprehensive data mapping support facilitates the transformation of source data into any schema expected by target systems.</p><div class="Code_dVersion__ghwNY"><a href="https://github.com/ballerina-guides/etl-samples/blob/main/data-mapper/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div></div></div><div class="Code_box__Pmweq col-lg-7 col-md-7 col-12"><img src="/images/usecases/etl-data-mapping.gif" alt="Reshaping data with data mapper"/></div></div><div class="Code_subsection__9izvC row"><div class="Code_box__Pmweq col-lg-5 col-md-5 col-12"><div><h3>Precision cleaning with regular expressions</h3><p>Ballerina&#x27;s regex support empowers data cleansing and standardization, enhancing data quality and consistency.</p><div class="Code_dVersion__ghwNY"><a href="https://github.com/ballerina-guides/etl-samples/blob/main/clean-and-standardize-data/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div></div></div><div class="Code_box__Pmweq col-lg-7 col-md-7 col-12"><div class="Code_codeSnippet__xFpp1"><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><button type="button" title="Copy" aria-label="Copy" data="function standardizeValues(string inputString) returns int {
    string:RegExp yesPattern = re &#x60;y|Y|((y|Y)(e|E)(s|S))&#x60;;
    if yesPattern.isFullMatch(inputString) {
        return 1;
    }
    string:RegExp noPattern = re &#x60;n|N|((n|N)(o|O))&#x60;;
    if noPattern.isFullMatch(inputString) {
        return -1;
    }
    return 0;
}

function isValidEmail(string inputString) returns boolean {
    string:RegExp emailPattern =  re &#x60;[A-Za-z0-9\._%+-]+@[A-Za-z0-9\.-]+\.[A-Za-z]{2,}&#x60;;
    return emailPattern.isFullMatch(inputString);
}

function removeExtraWhiteSpaces(string inputString) returns string {
    string:RegExp extraSpaces = re &#x60;\s+&#x60;;
    return extraSpaces.replaceAll(inputString, &#x22; &#x22;);
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copied&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied&#x27;);window.setTimeout(() => {this.classList.remove(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copy&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy&#x27;);}, 3000);"><span class="ready"></span><span class="success"></span></button><span class="line"><span style="color:#D73A49">function</span><span style="color:#6F42C1"> standardizeValues</span><span style="color:#24292E">(</span><span style="color:#005CC5">string</span><span style="color:#E36209"> inputString</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#005CC5"> int</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#D73A49">:</span><span style="color:#24292E">RegExp yesPattern </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> re</span><span style="color:#24292E"> `y</span><span style="color:#D73A49">|</span><span style="color:#24292E">Y</span><span style="color:#D73A49">|</span><span style="color:#24292E">((y</span><span style="color:#D73A49">|</span><span style="color:#24292E">Y)(e</span><span style="color:#D73A49">|</span><span style="color:#24292E">E)(s</span><span style="color:#D73A49">|</span><span style="color:#24292E">S))`;</span></span>
<span class="line"><span style="color:#D73A49">    if</span><span style="color:#24292E"> yesPattern.</span><span style="color:#6F42C1">isFullMatch</span><span style="color:#24292E">(</span><span style="color:#E36209">inputString</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#005CC5"> 1</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#D73A49">:</span><span style="color:#24292E">RegExp noPattern </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> re</span><span style="color:#24292E"> `n</span><span style="color:#D73A49">|</span><span style="color:#24292E">N</span><span style="color:#D73A49">|</span><span style="color:#24292E">((n</span><span style="color:#D73A49">|</span><span style="color:#24292E">N)(o</span><span style="color:#D73A49">|</span><span style="color:#24292E">O))`;</span></span>
<span class="line"><span style="color:#D73A49">    if</span><span style="color:#24292E"> noPattern.</span><span style="color:#6F42C1">isFullMatch</span><span style="color:#24292E">(</span><span style="color:#E36209">inputString</span><span style="color:#24292E">) {</span></span>
<span class="line"><span style="color:#D73A49">        return</span><span style="color:#D73A49"> -</span><span style="color:#005CC5">1</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#005CC5"> 0</span><span style="color:#24292E">;</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">function</span><span style="color:#6F42C1"> isValidEmail</span><span style="color:#24292E">(</span><span style="color:#005CC5">string</span><span style="color:#E36209"> inputString</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#005CC5"> boolean</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#D73A49">:</span><span style="color:#24292E">RegExp emailPattern </span><span style="color:#D73A49">=</span><span style="color:#005CC5">  re</span><span style="color:#24292E"> `</span><span style="color:#005CC5">[A-Za-z0-9\._%+-]</span><span style="color:#D73A49">+</span><span style="color:#24292E">@</span><span style="color:#005CC5">[A-Za-z0-9\.-]</span><span style="color:#D73A49">+</span><span style="color:#005CC5">\.[A-Za-z]</span><span style="color:#D73A49">{2,}</span><span style="color:#24292E">`;</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> emailPattern.</span><span style="color:#6F42C1">isFullMatch</span><span style="color:#24292E">(</span><span style="color:#E36209">inputString</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">function</span><span style="color:#6F42C1"> removeExtraWhiteSpaces</span><span style="color:#24292E">(</span><span style="color:#005CC5">string</span><span style="color:#E36209"> inputString</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#005CC5"> string</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#D73A49">:</span><span style="color:#24292E">RegExp extraSpaces </span><span style="color:#D73A49">=</span><span style="color:#005CC5"> re</span><span style="color:#24292E"> `</span><span style="color:#D73A49">\s+</span><span style="color:#24292E">`;</span></span>
<span class="line"><span style="color:#D73A49">    return</span><span style="color:#24292E"> extraSpaces.</span><span style="color:#6F42C1">replaceAll</span><span style="color:#24292E">(</span><span style="color:#E36209">inputString</span><span style="color:#24292E">, </span><span style="color:#032F62">" "</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">}</span></span><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></div></div></div></div></div></div></div><div class="pageContentRow integration code odd row"><div class="col-12"><div class="container"><div class="row"><div class="Code_box__Pmweq col-12"><h2 id="load-from-kafka-topics" class="section"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" fill="currentColor" class="bi bi-link-45deg mdButton pe-2" viewBox="0 0 16 16"><path d="M4.715 6.542 3.343 7.914a3 3 0 1 0 4.243 4.243l1.828-1.829A3 3 0 0 0 8.586 5.5L8 6.086a1.002 1.002 0 0 0-.154.199 2 2 0 0 1 .861 3.337L6.88 11.45a2 2 0 1 1-2.83-2.83l.793-.792a4.018 4.018 0 0 1-.128-1.287z"></path><path d="M6.586 4.672A3 3 0 0 0 7.414 9.5l.775-.776a2 2 0 0 1-.896-3.346L9.12 3.55a2 2 0 1 1 2.83 2.83l-.793.792c.112.42.155.855.128 1.287l1.372-1.372a3 3 0 1 0-4.243-4.243L6.586 4.672z"></path></svg>Data loading (L)</h2></div></div><div class="Code_subsection__9izvC row"><div class="Code_box__Pmweq col-lg-5 col-md-5 col-12"><div><h3>Real-time data flow</h3><p>Ballerina&#x27;s support for various data streaming sources, such as Kafka, RabbitMQ, and NATS, facilitates the creation of real-time streaming ETL pipelines.</p><div class="Code_dVersion__ghwNY"><a href="https://github.com/ballerina-guides/etl-samples/blob/main/kafka-db-ingestion/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div></div></div><div class="Code_box__Pmweq col-lg-7 col-md-7 col-12"><div class="Code_codeSnippet__xFpp1"><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><button type="button" title="Copy" aria-label="Copy" data="final kafka:ConsumerConfiguration consumerConfiguration = {
    groupId: &#x22;lead-uuid&#x22;,
    topics: [&#x22;lead-analytics&#x22;],
    pollingInterval: 1,
    autoCommit: false
};

final Client leadsDbClient = check new;

listener kafka:Listener kafkaListener = new (kafka:DEFAULT_URL, consumerConfiguration);

isolated service on kafkaListener {
    remote function onConsumerRecord(kafka:Caller caller, LeadAnalytics[] leadsData) returns error? {
        LeadAnalyticsDataInsert[] insertData = from var lead in leadsData
            select {id: uuid:createType1AsString(), ...lead};
        _ = check leadsDbClient->/leadanalyticsdata.post(insertData);
    }
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copied&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied&#x27;);window.setTimeout(() => {this.classList.remove(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copy&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy&#x27;);}, 3000);"><span class="ready"></span><span class="success"></span></button><span class="line"><span style="color:#D73A49">final</span><span style="color:#24292E"> kafka</span><span style="color:#D73A49">:</span><span style="color:#24292E">ConsumerConfiguration consumerConfiguration </span><span style="color:#D73A49">=</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    groupId</span><span style="color:#D73A49">:</span><span style="color:#032F62"> "lead-uuid"</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    topics</span><span style="color:#D73A49">:</span><span style="color:#24292E"> [</span><span style="color:#032F62">"lead-analytics"</span><span style="color:#24292E">],</span></span>
<span class="line"><span style="color:#24292E">    pollingInterval</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> 1</span><span style="color:#24292E">,</span></span>
<span class="line"><span style="color:#24292E">    autoCommit</span><span style="color:#D73A49">:</span><span style="color:#005CC5"> false</span></span>
<span class="line"><span style="color:#24292E">};</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">final</span><span style="color:#24292E"> Client leadsDbClient </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">listener</span><span style="color:#24292E"> kafka</span><span style="color:#D73A49">:</span><span style="color:#24292E">Listener kafkaListener </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> (</span><span style="color:#E36209">kafka</span><span style="color:#D73A49">:</span><span style="color:#24292E">DEFAULT_URL, </span><span style="color:#E36209">consumerConfiguration</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">isolated</span><span style="color:#D73A49"> service</span><span style="color:#D73A49"> on</span><span style="color:#24292E"> kafkaListener {</span></span>
<span class="line"><span style="color:#D73A49">    remote</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> onConsumerRecord</span><span style="color:#24292E">(</span><span style="color:#E36209">kafka</span><span style="color:#D73A49">:</span><span style="color:#24292E">Caller caller, </span><span style="color:#E36209">LeadAnalytics</span><span style="color:#24292E">[] </span><span style="color:#E36209">leadsData</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">        LeadAnalyticsDataInsert[] insertData </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> from</span><span style="color:#005CC5"> var</span><span style="color:#24292E"> lead </span><span style="color:#D73A49">in</span><span style="color:#24292E"> leadsData</span></span>
<span class="line"><span style="color:#D73A49">            select</span><span style="color:#24292E"> {id</span><span style="color:#D73A49">:</span><span style="color:#24292E"> uuid:</span><span style="color:#6F42C1">createType1AsString</span><span style="color:#24292E">(), </span><span style="color:#D73A49">...</span><span style="color:#24292E">lead};</span></span>
<span class="line"><span style="color:#24292E">        _ </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> leadsDbClient</span><span style="color:#D73A49">->/</span><span style="color:#24292E">leadanalyticsdata.</span><span style="color:#6F42C1">post</span><span style="color:#24292E">(</span><span style="color:#E36209">insertData</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></div></div></div></div><div class="Code_subsection__9izvC row"><div class="Code_box__Pmweq col-lg-5 col-md-5 col-12"><div><h3>Loading data to a data warehouse</h3><p>Ballerina&#x27;s integration and security capabilities simplify the loading of transformed data securely into on-prem or SaaS data warehouses.</p><div class="Code_dVersion__ghwNY"><a href="https://github.com/ballerina-guides/etl-samples/blob/main/load-data-to-bigquery/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div></div></div><div class="Code_box__Pmweq col-lg-7 col-md-7 col-12"><div class="Code_codeSnippet__xFpp1"><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><button type="button" title="Copy" aria-label="Copy" data="final bigquery:Client bigQueryClient = check new ({auth: {token: bigQueryAccessToken}});

public function main() returns error? {
    SocialMediaInteraction[] interactions = check io:fileReadCsv(&#x22;./resources/interactions.csv&#x22;);
    bigquery:TabledatainsertallrequestRows[] rows = from var interaction in interactions
        select {insertId: uuid:createType1AsString(), &#x27;json: interaction};
    bigquery:TableDataInsertAllRequest payload = {rows};
    _ = check bigQueryClient->insertAllTableData(projectId, datasetId, tableId, payload);
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copied&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied&#x27;);window.setTimeout(() => {this.classList.remove(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copy&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy&#x27;);}, 3000);"><span class="ready"></span><span class="success"></span></button><span class="line"><span style="color:#D73A49">final</span><span style="color:#24292E"> bigquery</span><span style="color:#D73A49">:</span><span style="color:#24292E">Client bigQueryClient </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#D73A49"> new</span><span style="color:#24292E"> ({auth</span><span style="color:#D73A49">:</span><span style="color:#24292E"> {token: bigQueryAccessToken}});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">public</span><span style="color:#D73A49"> function</span><span style="color:#6F42C1"> main</span><span style="color:#24292E">() </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    SocialMediaInteraction[] interactions </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> io</span><span style="color:#D73A49">:</span><span style="color:#6F42C1">fileReadCsv</span><span style="color:#24292E">(</span><span style="color:#032F62">"./resources/interactions.csv"</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">    bigquery</span><span style="color:#D73A49">:</span><span style="color:#24292E">TabledatainsertallrequestRows[] rows </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> from</span><span style="color:#005CC5"> var</span><span style="color:#24292E"> interaction </span><span style="color:#D73A49">in</span><span style="color:#24292E"> interactions</span></span>
<span class="line"><span style="color:#D73A49">        select</span><span style="color:#24292E"> {insertId</span><span style="color:#D73A49">:</span><span style="color:#24292E"> uuid:</span><span style="color:#6F42C1">createType1AsString</span><span style="color:#24292E">(), 'json</span><span style="color:#D73A49">:</span><span style="color:#24292E"> interaction};</span></span>
<span class="line"><span style="color:#24292E">    bigquery</span><span style="color:#D73A49">:</span><span style="color:#24292E">TableDataInsertAllRequest payload </span><span style="color:#D73A49">=</span><span style="color:#24292E"> {rows};</span></span>
<span class="line"><span style="color:#24292E">    _ </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> bigQueryClient</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">insertAllTableData</span><span style="color:#24292E">(</span><span style="color:#E36209">projectId</span><span style="color:#24292E">, </span><span style="color:#E36209">datasetId</span><span style="color:#24292E">, </span><span style="color:#E36209">tableId</span><span style="color:#24292E">, </span><span style="color:#E36209">payload</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#24292E">}</span></span><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></div></div></div></div><div class="Code_subsection__9izvC row"><div class="Code_box__Pmweq col-lg-5 col-md-5 col-12"><div><h3>Manual data inspection</h3><p>Ballerina can connect with Google Sheets or Excel to load data samples, intermediate data, or processed data for manual inspection.</p><div class="Code_dVersion__ghwNY"><a href="https://github.com/ballerina-guides/etl-samples/blob/main/load-data-to-gsheet/main.bal" class="Code_cDownload__pNdoe" target="_blank" rel="noreferrer">View code on GitHub</a></div></div></div><div class="Code_box__Pmweq col-lg-7 col-md-7 col-12"><div class="Code_codeSnippet__xFpp1"><div class="highlight"><pre class="shiki github-light" style="background-color:#fff;color:#24292e" tabindex="0"><code><button type="button" title="Copy" aria-label="Copy" data="function loadToGoogleSheet(string sheetName, string workSheetName, 
    SalesSummary[] salesSummary) returns error? {
    sheets:Spreadsheet spreadsheet = check spreadsheetClient->createSpreadsheet(sheetName);
    string spreadSheetId = spreadsheet.spreadsheetId;

    check spreadsheetClient->renameSheet(spreadSheetId, &#x22;Sheet1&#x22;, workSheetName);

    _ = check spreadsheetClient
            ->appendValue(spreadSheetId, [&#x22;Product&#x22;, &#x22;Sales&#x22;], {sheetName: workSheetName});
    foreach var {product, sales} in salesSummary {
        _ = check spreadsheetClient
            ->appendValue(spreadSheetId, [product, sales], {sheetName: workSheetName});
    }
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copied&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copied&#x27;);window.setTimeout(() => {this.classList.remove(&#x27;rehype-pretty-copied&#x27;);this.setAttribute(&#x27;title&#x27;, &#x27;Copy&#x27;);this.setAttribute(&#x27;aria-label&#x27;, &#x27;Copy&#x27;);}, 3000);"><span class="ready"></span><span class="success"></span></button><span class="line"><span style="color:#D73A49">function</span><span style="color:#6F42C1"> loadToGoogleSheet</span><span style="color:#24292E">(</span><span style="color:#005CC5">string</span><span style="color:#E36209"> sheetName</span><span style="color:#24292E">, </span><span style="color:#005CC5">string</span><span style="color:#E36209"> workSheetName</span><span style="color:#24292E">, </span></span>
<span class="line"><span style="color:#E36209">    SalesSummary</span><span style="color:#24292E">[] </span><span style="color:#E36209">salesSummary</span><span style="color:#24292E">) </span><span style="color:#D73A49">returns</span><span style="color:#D73A49"> error?</span><span style="color:#24292E"> {</span></span>
<span class="line"><span style="color:#24292E">    sheets</span><span style="color:#D73A49">:</span><span style="color:#24292E">Spreadsheet spreadsheet </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> spreadsheetClient</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">createSpreadsheet</span><span style="color:#24292E">(</span><span style="color:#E36209">sheetName</span><span style="color:#24292E">);</span></span>
<span class="line"><span style="color:#005CC5">    string</span><span style="color:#24292E"> spreadSheetId </span><span style="color:#D73A49">=</span><span style="color:#24292E"> spreadsheet.spreadsheetId;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#D73A49">    check</span><span style="color:#24292E"> spreadsheetClient</span><span style="color:#D73A49">-></span><span style="color:#6F42C1">renameSheet</span><span style="color:#24292E">(</span><span style="color:#E36209">spreadSheetId</span><span style="color:#24292E">, </span><span style="color:#032F62">"Sheet1"</span><span style="color:#24292E">, </span><span style="color:#E36209">workSheetName</span><span style="color:#24292E">);</span></span>
<span class="line"></span>
<span class="line"><span style="color:#24292E">    _ </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> spreadsheetClient</span></span>
<span class="line"><span style="color:#D73A49">            -></span><span style="color:#6F42C1">appendValue</span><span style="color:#24292E">(</span><span style="color:#E36209">spreadSheetId</span><span style="color:#24292E">, [</span><span style="color:#032F62">"Product"</span><span style="color:#24292E">, </span><span style="color:#032F62">"Sales"</span><span style="color:#24292E">], {sheetName</span><span style="color:#D73A49">:</span><span style="color:#24292E"> workSheetName});</span></span>
<span class="line"><span style="color:#D73A49">    foreach </span><span style="color:#005CC5">var</span><span style="color:#24292E"> {product, sales} </span><span style="color:#D73A49">in</span><span style="color:#24292E"> salesSummary {</span></span>
<span class="line"><span style="color:#24292E">        _ </span><span style="color:#D73A49">=</span><span style="color:#D73A49"> check</span><span style="color:#24292E"> spreadsheetClient</span></span>
<span class="line"><span style="color:#D73A49">            -></span><span style="color:#6F42C1">appendValue</span><span style="color:#24292E">(</span><span style="color:#E36209">spreadSheetId</span><span style="color:#24292E">, [product, sales], {sheetName</span><span style="color:#D73A49">:</span><span style="color:#24292E"> workSheetName});</span></span>
<span class="line"><span style="color:#24292E">    }</span></span>
<span class="line"><span style="color:#24292E">}</span></span><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></div></div></div></div></div></div></div></div></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"samples":{"clean1":{"frontmatter":{"title":"","description":"","url":"","image":""},"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cbutton type=\"button\" title=\"Copy\" aria-label=\"Copy\" data=\"type SalesOrder record {|\n    string itemId;\n    string customerId;\n    string itemName;\n    int quantity;\n    int date;\n|};\n\nfunction removeDuplicates(SalesOrder[] orders) returns SalesOrder[] {\n    return from var {itemId, customerId, itemName, quantity, date} in orders\n        group by itemId, customerId, itemName\n        select {\n            itemId,\n            customerId,\n            itemName,\n            quantity: [quantity][0],\n            date: [date][0]\n        };\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copied\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copied\u0026#x27;);window.setTimeout(() =\u003e {this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copy\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copy\u0026#x27;);}, 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003etype\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e SalesOrder\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e record\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e itemId;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customerId;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e itemName;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    int\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e quantity;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    int\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e date;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e removeDuplicates\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eSalesOrder\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e[] \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eorders\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e SalesOrder[] {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e from\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e var\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {itemId, customerId, itemName, quantity, date} \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e orders\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        group\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e by\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e itemId, customerId, itemName\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        select\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            itemId,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            customerId,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            itemName,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            quantity\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [quantity][\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            date\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [date][\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e"},"clean2":{"frontmatter":{"title":"","description":"","url":"","image":""},"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cbutton type=\"button\" title=\"Copy\" aria-label=\"Copy\" data=\"public type Customer record {|\n    string name;\n    string city;\n    string phone;\n|};\n\nfunction findDuplicates(Customer[] customers) returns [Customer[], Customer[]] {\n    Customer[] duplicates = [];\n    Customer[] uniqueCustomers = [customers[0]];\n    foreach int customerIdx in 1 ... customers.length() - 1 {\n        foreach Customer uniqueCustomer in uniqueCustomers {\n            Customer customer = customers[customerIdx];\n            if getEditDistance(customer.name, uniqueCustomer.name) \u003c 3 \u0026#x26;\u0026#x26;\n                getEditDistance(customer.city, uniqueCustomer.city) \u003c 2 \u0026#x26;\u0026#x26;\n                getEditDistance(customer.phone, uniqueCustomer.phone) \u003c 4 {\n                duplicates.push(customer);\n            } else {\n                uniqueCustomers.push(customer);\n            }\n        }\n    }\n    return [uniqueCustomers, duplicates];\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copied\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copied\u0026#x27;);window.setTimeout(() =\u003e {this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copy\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copy\u0026#x27;);}, 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003epublic\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e type\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e Customer\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e record\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e name;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e city;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e phone;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e findDuplicates\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eCustomer\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e[] \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003ecustomers\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [Customer[], Customer[]] {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    Customer[] duplicates \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    Customer[] uniqueCustomers \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [customers[\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e]];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    foreach \u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003eint\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customerIdx \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 1\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e ...\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customers.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003elength\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e() \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 1\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        foreach \u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eCustomer uniqueCustomer \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e uniqueCustomers {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            Customer customer \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customers[customerIdx];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e            if\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e getEditDistance\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(customer.name, uniqueCustomer.name) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 3\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e \u0026#x26;\u0026#x26;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6F42C1\"\u003e                getEditDistance\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(customer.city, uniqueCustomer.city) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 2\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e \u0026#x26;\u0026#x26;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6F42C1\"\u003e                getEditDistance\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(customer.phone, uniqueCustomer.phone) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 4\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                duplicates.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003epush\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003ecustomer\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            } \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003eelse\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                uniqueCustomers.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003epush\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003ecustomer\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [uniqueCustomers, duplicates];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e"},"data-enrichment-magic":{"frontmatter":{"title":"Data enrichment magic","description":"Ballerina streamlines data enrichment, simplifying the journey from data extraction from databases or APIs to adding depth and context to your insights.","url":"https://github.com/ballerina-guides/etl-samples/blob/main/enrich-data/main.bal","image":""},"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cbutton type=\"button\" title=\"Copy\" aria-label=\"Copy\" data=\"final http:Client geocodingClient = check new (\u0026#x22;https://maps.googleapis.com\u0026#x22;);\n\nisolated service /api/v1 on new http:Listener(8080) {\n    resource function post customerWithGeoCode(Customer customer) returns GeoTaggedCustomer|error {\n        GeocodeResponse response = check geocodingClient-\u003e\n            /maps/api/geocode/\u0026#x27;json(address = customer.address, key = geocodingAPIKey);\n        if response.status == \u0026#x22;OK\u0026#x22; {\n            return {\n                ...customer,\n                latitude: response.results[0].geometry.location.lat,\n                longitude: response.results[0].geometry.location.lng\n            };\n        }\n        return error(\u0026#x22;Error while getting the location information.\u0026#x22;);\n    }\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copied\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copied\u0026#x27;);window.setTimeout(() =\u003e {this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copy\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copy\u0026#x27;);}, 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efinal\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e http\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eClient geocodingClient \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"https://maps.googleapis.com\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eisolated\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e service\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e /api/v1\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e on\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e http:Listener(\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e8080\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    resource\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e post\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e customerWithGeoCode\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eCustomer\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003e customer\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e GeoTaggedCustomer\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|error\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        GeocodeResponse response \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e geocodingClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e            /\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003emaps\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eapi\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003egeocode\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e'json\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eaddress\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customer.address, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003ekey\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e =\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e geocodingAPIKey);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e response.status \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e==\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"OK\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e            return\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e                ...\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003ecustomer,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                latitude\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e response.results[\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e].geometry.location.lat,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                longitude\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e response.results[\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e].geometry.location.lng\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"Error while getting the location information.\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e"},"drive-data-interactions-with-models":{"frontmatter":{"title":"Drive data interactions with models","description":"Ballerina's `persist` feature seamlessly connects to databases, retrieves data, and kickstarts your ETL process.","url":"https://github.com/ballerina-guides/etl-samples/blob/main/extract-data-from-database/main.bal","image":""},"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cbutton type=\"button\" title=\"Copy\" aria-label=\"Copy\" data=\"function getOrderData() returns error? {\n    stream\u003cOrderData, persist:Error?\u003e orders = dbClient-\u003e/orderdata();\n    check from var orderData in orders\n        do {\n            io:println(orderData);\n        };\n}\n\nfunction getCustomerData() returns error? {\n    stream\u003cCustomerData, persist:Error?\u003e customers = dbClient-\u003e/customers();\n    check from var customerData in customers\n        do {\n            io:println(customerData);\n        };\n}\n\nfunction getOrderWithCustomer(string orderId) returns error? {\n    OrderWithCustomer orderwithCustomer = check dbClient-\u003e/orderdata/[orderId];\n    io:println(orderwithCustomer);\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copied\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copied\u0026#x27;);window.setTimeout(() =\u003e {this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copy\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copy\u0026#x27;);}, 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e getOrderData\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e() \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    stream\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eOrderData, persist\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eError?\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e orders \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e dbClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e/\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eorderdata\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e from\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e var\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e orderData \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e orders\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        do\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            io\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eprintln\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eorderData\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e getCustomerData\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e() \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    stream\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eCustomerData, persist\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eError?\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customers \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e dbClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e/\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003ecustomers\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e from\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e var\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customerData \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e customers\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        do\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            io\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eprintln\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003ecustomerData\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e getOrderWithCustomer\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003e orderId\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    OrderWithCustomer orderwithCustomer \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e dbClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eorderdata\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e[orderId];\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    io\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eprintln\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eorderwithCustomer\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e"},"eleminating-redundency-for-cleaner-data":{"frontmatter":{"title":"Eliminating redundancy for cleaner data","description":"Ballerina simplifies duplicate removal through Ballerina queries and other intuitive constructs.","url":"","image":""},"code":""},"extract-data-from-github":{"frontmatter":{"title":"Unleash data from APIs","description":"Ballerina offers a wide range of built-in connectors, including HTTP and GraphQL clients, making it easy to interact with APIs for efficient data extraction in your ETL pipeline.","url":"https://github.com/ballerina-guides/etl-samples/blob/main/extract-data-from-github/main.bal","image":""},"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cbutton type=\"button\" title=\"Copy\" aria-label=\"Copy\" data=\"configurable string githubAccessToken = ?;\nconfigurable string repoOwner = \u0026#x22;ballerina-platform\u0026#x22;;\nconfigurable string repoName = \u0026#x22;ballerina-lang\u0026#x22;;\n\nfinal github:Client githubClient = check new ({\n    auth: {\n        token: githubAccessToken\n    }\n});\n\npublic function main() returns error? {\n    github:IssueFilters filters = {\n        labels: [\u0026#x22;Type/NewFeature\u0026#x22;, \u0026#x22;Priority/High\u0026#x22;],\n        states: [github:ISSUE_OPEN]\n    };\n    stream\u003cgithub:Issue, github:Error?\u003e openFeatures\n            = check githubClient-\u003egetIssues(repoOwner, repoName, filters);\n    check from var feature in openFeatures\n        do {\n            io:println(feature.title);\n        };\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copied\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copied\u0026#x27;);window.setTimeout(() =\u003e {this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copy\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copy\u0026#x27;);}, 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e githubAccessToken \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e ?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e repoOwner \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"ballerina-platform\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e repoName \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"ballerina-lang\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efinal\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e github\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eClient githubClient \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ({\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    auth\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        token\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e githubAccessToken\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e});\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003epublic\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e main\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e() \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    github\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eIssueFilters filters \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        labels\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"Type/NewFeature\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"Priority/High\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        states\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003egithub\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e:ISSUE_OPEN]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    stream\u0026#x3C;\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003egithub\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eIssue, github\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eError?\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e openFeatures\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e            =\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e githubClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003egetIssues\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003erepoOwner\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003erepoName\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003efilters\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e from\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e var\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e feature \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e openFeatures\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        do\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            io\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eprintln\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(feature.title);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e"},"load-data-to-data-warehouse":{"frontmatter":{"title":"Loading data to a data warehouse","description":"Ballerina's integration and security capabilities simplify the loading of transformed data securely into on-prem or SaaS data warehouses.","url":"https://github.com/ballerina-guides/etl-samples/blob/main/load-data-to-bigquery/main.bal","image":""},"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cbutton type=\"button\" title=\"Copy\" aria-label=\"Copy\" data=\"final bigquery:Client bigQueryClient = check new ({auth: {token: bigQueryAccessToken}});\n\npublic function main() returns error? {\n    SocialMediaInteraction[] interactions = check io:fileReadCsv(\u0026#x22;./resources/interactions.csv\u0026#x22;);\n    bigquery:TabledatainsertallrequestRows[] rows = from var interaction in interactions\n        select {insertId: uuid:createType1AsString(), \u0026#x27;json: interaction};\n    bigquery:TableDataInsertAllRequest payload = {rows};\n    _ = check bigQueryClient-\u003einsertAllTableData(projectId, datasetId, tableId, payload);\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copied\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copied\u0026#x27;);window.setTimeout(() =\u003e {this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copy\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copy\u0026#x27;);}, 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efinal\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e bigquery\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eClient bigQueryClient \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ({auth\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {token: bigQueryAccessToken}});\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003epublic\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e main\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e() \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    SocialMediaInteraction[] interactions \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e io\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003efileReadCsv\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"./resources/interactions.csv\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    bigquery\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eTabledatainsertallrequestRows[] rows \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e from\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e var\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e interaction \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e interactions\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        select\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {insertId\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e uuid:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003ecreateType1AsString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(), 'json\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e interaction};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    bigquery\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eTableDataInsertAllRequest payload \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {rows};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    _ \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e bigQueryClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003einsertAllTableData\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eprojectId\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003edatasetId\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003etableId\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003epayload\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e"},"load-data-to-google-sheets":{"frontmatter":{"title":"Manual data inspection","description":"Ballerina can connect with Google Sheets or Excel to load data samples, intermediate data, or processed data for manual inspection.","url":"https://github.com/ballerina-guides/etl-samples/blob/main/load-data-to-gsheet/main.bal","image":""},"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cbutton type=\"button\" title=\"Copy\" aria-label=\"Copy\" data=\"function loadToGoogleSheet(string sheetName, string workSheetName, \n    SalesSummary[] salesSummary) returns error? {\n    sheets:Spreadsheet spreadsheet = check spreadsheetClient-\u003ecreateSpreadsheet(sheetName);\n    string spreadSheetId = spreadsheet.spreadsheetId;\n\n    check spreadsheetClient-\u003erenameSheet(spreadSheetId, \u0026#x22;Sheet1\u0026#x22;, workSheetName);\n\n    _ = check spreadsheetClient\n            -\u003eappendValue(spreadSheetId, [\u0026#x22;Product\u0026#x22;, \u0026#x22;Sales\u0026#x22;], {sheetName: workSheetName});\n    foreach var {product, sales} in salesSummary {\n        _ = check spreadsheetClient\n            -\u003eappendValue(spreadSheetId, [product, sales], {sheetName: workSheetName});\n    }\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copied\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copied\u0026#x27;);window.setTimeout(() =\u003e {this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copy\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copy\u0026#x27;);}, 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e loadToGoogleSheet\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003e sheetName\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003e workSheetName\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E36209\"\u003e    SalesSummary\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e[] \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003esalesSummary\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    sheets\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eSpreadsheet spreadsheet \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e spreadsheetClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003ecreateSpreadsheet\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003esheetName\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e spreadSheetId \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e spreadsheet.spreadsheetId;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e spreadsheetClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003erenameSheet\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003espreadSheetId\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"Sheet1\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eworkSheetName\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    _ \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e spreadsheetClient\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e            -\u003e\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eappendValue\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003espreadSheetId\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, [\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"Product\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"Sales\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e], {sheetName\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e workSheetName});\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    foreach \u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003evar\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {product, sales} \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e salesSummary {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        _ \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e spreadsheetClient\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e            -\u003e\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eappendValue\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003espreadSheetId\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, [product, sales], {sheetName\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e workSheetName});\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e"},"load-from-kafka-topics":{"frontmatter":{"title":"Real-time data flow","description":"Ballerina's support for various data streaming sources, such as Kafka, RabbitMQ, and NATS, facilitates the creation of real-time streaming ETL pipelines.","url":"https://github.com/ballerina-guides/etl-samples/blob/main/kafka-db-ingestion/main.bal","image":""},"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cbutton type=\"button\" title=\"Copy\" aria-label=\"Copy\" data=\"final kafka:ConsumerConfiguration consumerConfiguration = {\n    groupId: \u0026#x22;lead-uuid\u0026#x22;,\n    topics: [\u0026#x22;lead-analytics\u0026#x22;],\n    pollingInterval: 1,\n    autoCommit: false\n};\n\nfinal Client leadsDbClient = check new;\n\nlistener kafka:Listener kafkaListener = new (kafka:DEFAULT_URL, consumerConfiguration);\n\nisolated service on kafkaListener {\n    remote function onConsumerRecord(kafka:Caller caller, LeadAnalytics[] leadsData) returns error? {\n        LeadAnalyticsDataInsert[] insertData = from var lead in leadsData\n            select {id: uuid:createType1AsString(), ...lead};\n        _ = check leadsDbClient-\u003e/leadanalyticsdata.post(insertData);\n    }\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copied\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copied\u0026#x27;);window.setTimeout(() =\u003e {this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copy\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copy\u0026#x27;);}, 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efinal\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e kafka\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eConsumerConfiguration consumerConfiguration \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    groupId\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"lead-uuid\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    topics\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"lead-analytics\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e],\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    pollingInterval\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 1\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    autoCommit\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e false\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efinal\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e Client leadsDbClient \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003elistener\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e kafka\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eListener kafkaListener \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003ekafka\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eDEFAULT_URL, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003econsumerConfiguration\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eisolated\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e service\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e on\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e kafkaListener {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    remote\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e onConsumerRecord\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003ekafka\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eCaller caller, \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eLeadAnalytics\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e[] \u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eleadsData\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        LeadAnalyticsDataInsert[] insertData \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e from\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e var\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e lead \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ein\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e leadsData\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e            select\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {id\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e uuid:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003ecreateType1AsString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(), \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003elead};\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        _ \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e leadsDbClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eleadanalyticsdata.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003epost\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003einsertData\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e"},"make-data-extraction-smarter":{"frontmatter":{"title":"Make data extraction smarter","description":"Ballerina AI integrations can extract information from unstructured data, unlocking vast amounts of information captured in emails, documents, comments, etc. in the extraction process.","url":"https://github.com/ballerina-guides/etl-samples/blob/main/extract-information-from-unstructured-data/main.bal","image":""},"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cbutton type=\"button\" title=\"Copy\" aria-label=\"Copy\" data=\"final chat:Client openAiChat = check new ({auth: {token: openAIKey}});\n\nisolated service /api/reviews on new http:Listener(8080) {\n    resource function post summary(SummaryRequest summaryRequest) returns error? {\n        chat:CreateChatCompletionRequest request = {\n            model: \u0026#x22;gpt-3.5-turbo\u0026#x22;,\n            messages: [\n                {\n                    role: \u0026#x22;user\u0026#x22;,\n                    content: string \u0026#x60;\n                        Extract the following details in JSON from the reviews given.\n                            {\n                                good_points: string,\n                                bad_points: string,\n                                improvement_points: string\n                            }\n                        The fields should contain points extracted from all reviews\n                        Here are the reviews:\n                        ${string:\u0026#x27;join(\u0026#x22;,\u0026#x22;, ...summaryRequest.reviews)}\n                    \u0026#x60;\n                }\n            ]\n        };\n        chat:CreateChatCompletionResponse summary = check openAiChat-\u003e/chat/completions.post(request);\n        if summary.choices.length() \u003e 0 {\n            string content = check summary.choices[0].message?.content.ensureType();\n            io:println(content);\n        }\n    }\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copied\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copied\u0026#x27;);window.setTimeout(() =\u003e {this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copy\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copy\u0026#x27;);}, 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efinal\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e chat\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eClient openAiChat \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e ({auth\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {token: openAIKey}});\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003eisolated\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e service\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e /api/reviews\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e on\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e http:Listener(\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e8080\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    resource\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e post\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e summary\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003eSummaryRequest\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003e summaryRequest\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        chat\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eCreateChatCompletionRequest request \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            model\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"gpt-3.5-turbo\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            messages\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6F42C1\"\u003e                    role\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"user\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6F42C1\"\u003e                    content\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e `\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                        Extract the following details in JSON from the reviews given.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                            {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6F42C1\"\u003e                                good_points\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6F42C1\"\u003e                                bad_points\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6F42C1\"\u003e                                improvement_points\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                            }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                        The fields should contain points extracted from all reviews\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                        Here are the \u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003ereviews\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e:\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                        ${\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e'join\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\",\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003esummaryRequest.reviews)}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                    `\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            ]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        };\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        chat\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eCreateChatCompletionResponse summary \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e openAiChat\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003echat\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003ecompletions.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003epost\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003erequest\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        if\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e summary.choices.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003elength\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e() \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e\u003e\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 0\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e            string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e content \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e summary.choices[\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e].message?.content.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eensureType\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e();\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            io\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eprintln\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003econtent\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e"},"precision-cleaning-with-regex":{"frontmatter":{"title":"Precision cleaning with regular expressions","description":"Ballerina's regex support empowers data cleansing and standardization, enhancing data quality and consistency.","url":"https://github.com/ballerina-guides/etl-samples/blob/main/clean-and-standardize-data/main.bal","image":""},"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cbutton type=\"button\" title=\"Copy\" aria-label=\"Copy\" data=\"function standardizeValues(string inputString) returns int {\n    string:RegExp yesPattern = re \u0026#x60;y|Y|((y|Y)(e|E)(s|S))\u0026#x60;;\n    if yesPattern.isFullMatch(inputString) {\n        return 1;\n    }\n    string:RegExp noPattern = re \u0026#x60;n|N|((n|N)(o|O))\u0026#x60;;\n    if noPattern.isFullMatch(inputString) {\n        return -1;\n    }\n    return 0;\n}\n\nfunction isValidEmail(string inputString) returns boolean {\n    string:RegExp emailPattern =  re \u0026#x60;[A-Za-z0-9\\._%+-]+@[A-Za-z0-9\\.-]+\\.[A-Za-z]{2,}\u0026#x60;;\n    return emailPattern.isFullMatch(inputString);\n}\n\nfunction removeExtraWhiteSpaces(string inputString) returns string {\n    string:RegExp extraSpaces = re \u0026#x60;\\s+\u0026#x60;;\n    return extraSpaces.replaceAll(inputString, \u0026#x22; \u0026#x22;);\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copied\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copied\u0026#x27;);window.setTimeout(() =\u003e {this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copy\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copy\u0026#x27;);}, 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e standardizeValues\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003e inputString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e int\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eRegExp yesPattern \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e re\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e `y\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eY\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e((y\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eY)(e\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eE)(s\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eS))`;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e yesPattern.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eisFullMatch\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003einputString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 1\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eRegExp noPattern \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e re\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e `n\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eN\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e((n\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eN)(o\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e|\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eO))`;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    if\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e noPattern.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eisFullMatch\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003einputString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e        return\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e -\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e1\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e 0\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e isValidEmail\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003e inputString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e boolean\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eRegExp emailPattern \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e  re\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e `\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e[A-Za-z0-9\\._%+-]\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e@\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e[A-Za-z0-9\\.-]\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e+\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e\\.[A-Za-z]\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e{2,}\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e`;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e emailPattern.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eisFullMatch\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003einputString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efunction\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e removeExtraWhiteSpaces\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003e inputString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eRegExp extraSpaces \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e re\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e `\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e\\s+\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e`;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003e    return\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e extraSpaces.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003ereplaceAll\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003einputString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, \u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\" \"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e"},"refining-data-excellence":{"frontmatter":{"title":"Refining data excellence","description":"Ballerina's seamless integration with AI models enhances error correction, ensuring data integrity and precision during transformation.","url":"https://github.com/ballerina-guides/etl-samples/blob/main/refine-data-using-ai/main.bal","image":""},"code":"\u003cpre class=\"shiki github-light\" style=\"background-color:#fff;color:#24292e\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cbutton type=\"button\" title=\"Copy\" aria-label=\"Copy\" data=\"configurable string openAIToken = ?;\nfinal http:Client openAIClient = check new (\u0026#x22;https://api.openai.com\u0026#x22;, {auth: {token: openAIToken}});\n\npublic function main(string filePath) returns error? {\n    string inputString = check io:fileReadString(filePath);\n\n    OpenAiChatResponse response = check openAIClient-\u003e/v1/chat/completions.post(\n        {\n            model: \u0026#x22;gpt-3.5-turbo\u0026#x22;,\n            messages: [\n                {\n                    role: \u0026#x22;user\u0026#x22;,\n                    content: \u0026#x22;Fix grammar and spelling mistakes.\u0026#x22;\n                },\n                {\n                    role: \u0026#x22;user\u0026#x22;,\n                    content: inputString\n                }\n            ]\n        }\n    );\n\n    io:println(string \u0026#x60;Corrected: ${response.choices[0].message.content}\u0026#x60;);\n}\" class=\"rehype-pretty-copy\" onclick=\"navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copied\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copied\u0026#x27;);window.setTimeout(() =\u003e {this.classList.remove(\u0026#x27;rehype-pretty-copied\u0026#x27;);this.setAttribute(\u0026#x27;title\u0026#x27;, \u0026#x27;Copy\u0026#x27;);this.setAttribute(\u0026#x27;aria-label\u0026#x27;, \u0026#x27;Copy\u0026#x27;);}, 3000);\"\u003e\u003cspan class=\"ready\"\u003e\u003c/span\u003e\u003cspan class=\"success\"\u003e\u003c/span\u003e\u003c/button\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003econfigurable\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e openAIToken \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e ?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e;\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003efinal\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e http\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eClient openAIClient \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e new\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"https://api.openai.com\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e, {auth\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {token: openAIToken}});\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#D73A49\"\u003epublic\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e function\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003e main\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003e filePath\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e) \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003ereturns\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e error?\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#005CC5\"\u003e    string\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e inputString \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e io\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003efileReadString\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E36209\"\u003efilePath\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    OpenAiChatResponse response \u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e=\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e check\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e openAIClient\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e-\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003ev1\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003echat\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003ecompletions.\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003epost\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            model\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e \"gpt-3.5-turbo\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            messages\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e [\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6F42C1\"\u003e                    role\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"user\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6F42C1\"\u003e                    content\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"Fix grammar and spelling mistakes.\"\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                },\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6F42C1\"\u003e                    role\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e: \u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e\"user\"\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#6F42C1\"\u003e                    content\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e: inputString\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e                }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e            ]\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e        }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    );\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e    io\u003c/span\u003e\u003cspan style=\"color:#D73A49\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#6F42C1\"\u003eprintln\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e `Corrected: ${\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003eresponse\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003echoices\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e[\u003c/span\u003e\u003cspan style=\"color:#005CC5\"\u003e0\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e].\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003emessage\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003econtent\u003c/span\u003e\u003cspan style=\"color:#032F62\"\u003e}`\u003c/span\u003e\u003cspan style=\"color:#24292E\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#24292E\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003cstyle\u003e:root {--copy-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 448 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg' style='float: right;'%3E%3Ctitle%3ECopy%3C/title%3E%3Cpath d='M433.941 65.941l-51.882-51.882A48 48 0 0 0 348.118 0H176c-26.51 0-48 21.49-48 48v48H48c-26.51 0-48 21.49-48 48v320c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48v-48h80c26.51 0 48-21.49 48-48V99.882a48 48 0 0 0-14.059-33.941zM266 464H54a6 6 0 0 1-6-6V150a6 6 0 0 1 6-6h74v224c0 26.51 21.49 48 48 48h96v42a6 6 0 0 1-6 6zm128-96H182a6 6 0 0 1-6-6V54a6 6 0 0 1 6-6h106v88c0 13.255 10.745 24 24 24h88v202a6 6 0 0 1-6 6zm6-256h-64V48h9.632c1.591 0 3.117.632 4.243 1.757l48.368 48.368a6 6 0 0 1 1.757 4.243V112z'%3E%3C/path%3E%3C/svg%3E\");--success-icon: url(\"data:image/svg+xml,%3Csvg stroke='currentColor' fill='currentColor' stroke-width='0' viewBox='0 0 512 512' height='1em' width='1em' xmlns='http://www.w3.org/2000/svg'%3E%3Ctitle%3ECopied%3C/title%3E%3Cpath d='M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z'%3E%3C/path%3E%3C/svg%3E\");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {background-color: transparent;border: none;right: 1px;padding: 0;width: 16px;height: 16px;display: flex;margin-top: -20px;margin-right: 8px;position: absolute;backdrop-filter: blur(3px);\u0026 span {width: 100%;aspect-ratio: 1 / 1;}\u0026 .ready {background-image: var(--copy-icon);}\u0026 .success {display: none; background-image: var(--success-icon);}}.Code_codeSnippet__ayQ3y button.rehype-pretty-copy {margin-top: -10px;}\u0026.rehype-pretty-copied {\u0026 .success {display: block;} \u0026 .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;\u0026 .ready { display: none; }\u0026 .success { display: block; }}\u003c/style\u003e\u003c/code\u003e\u003c/pre\u003e"},"reshaping-data-with-data-mapper":{"frontmatter":{"title":"Reshaping data with data mapper","description":"Comprehensive data mapping support facilitates the transformation of source data into any schema expected by target systems.","url":"https://github.com/ballerina-guides/etl-samples/blob/main/data-mapper/main.bal","image":"images/usecases/etl-data-mapping.gif"},"code":""}}},"__N_SSG":true},"page":"/use-cases/etl","query":{},"buildId":"wABIY1zECRpgDqtNoqHax","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>